<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 R Function Mannual | MNet Manual</title>
  <meta name="description" content="MNet: a metabolic network-centered tool for interpreting metabolomic and transcriptomic data" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 R Function Mannual | MNet Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="MNet: a metabolic network-centered tool for interpreting metabolomic and transcriptomic data" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 R Function Mannual | MNet Manual" />
  
  <meta name="twitter:description" content="MNet: a metabolic network-centered tool for interpreting metabolomic and transcriptomic data" />
  



<meta name="date" content="2025-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="web-server-manual.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MNet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> OVERVIEW</a></li>
<li class="chapter" data-level="2" data-path="web-server-manual.html"><a href="web-server-manual.html"><i class="fa fa-check"></i><b>2</b> Web Server Manual</a>
<ul>
<li class="chapter" data-level="2.1" data-path="web-server-manual.html"><a href="web-server-manual.html#metabolic-subnetwork-analyser"><i class="fa fa-check"></i><b>2.1</b> Metabolic Subnetwork Analyser</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="web-server-manual.html"><a href="web-server-manual.html#snetlyser"><i class="fa fa-check"></i><b>2.1.1</b> sNETlyser</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="web-server-manual.html"><a href="web-server-manual.html#extended-pathway-analyses"><i class="fa fa-check"></i><b>2.2</b> Extended Pathway Analyses</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="web-server-manual.html"><a href="web-server-manual.html#epealyser"><i class="fa fa-check"></i><b>2.2.1</b> ePEAlyser</a></li>
<li class="chapter" data-level="2.2.2" data-path="web-server-manual.html"><a href="web-server-manual.html#epdalyser"><i class="fa fa-check"></i><b>2.2.2</b> ePDAlyser</a></li>
<li class="chapter" data-level="2.2.3" data-path="web-server-manual.html"><a href="web-server-manual.html#esealyser"><i class="fa fa-check"></i><b>2.2.3</b> eSEAlyser</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="web-server-manual.html"><a href="web-server-manual.html#construction-of-knowledgebase-dbmnet"><i class="fa fa-check"></i><b>2.3</b> Construction of Knowledgebase dbMNet</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="web-server-manual.html"><a href="web-server-manual.html#dbkegg"><i class="fa fa-check"></i><b>2.3.1</b> dbKEGG</a></li>
<li class="chapter" data-level="2.3.2" data-path="web-server-manual.html"><a href="web-server-manual.html#dbnet"><i class="fa fa-check"></i><b>2.3.2</b> dbNet</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="web-server-manual.html"><a href="web-server-manual.html#deployment"><i class="fa fa-check"></i><b>2.4</b> Deployment</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="web-server-manual.html"><a href="web-server-manual.html#installing-r-4.4.1-for-ubuntu-20"><i class="fa fa-check"></i><b>2.4.1</b> Installing R 4.4.1 for Ubuntu 20</a></li>
<li class="chapter" data-level="2.4.2" data-path="web-server-manual.html"><a href="web-server-manual.html#installing-r-packages"><i class="fa fa-check"></i><b>2.4.2</b> Installing R Packages</a></li>
<li class="chapter" data-level="2.4.3" data-path="web-server-manual.html"><a href="web-server-manual.html#installing-shiny-sever"><i class="fa fa-check"></i><b>2.4.3</b> Installing shiny-sever</a></li>
<li class="chapter" data-level="2.4.4" data-path="web-server-manual.html"><a href="web-server-manual.html#shiny-app-server-and-logs"><i class="fa fa-check"></i><b>2.4.4</b> Shiny App Server and Logs</a></li>
<li class="chapter" data-level="2.4.5" data-path="web-server-manual.html"><a href="web-server-manual.html#firewall-firewalld-or-ufw"><i class="fa fa-check"></i><b>2.4.5</b> Firewall: firewalld or ufw</a></li>
<li class="chapter" data-level="2.4.6" data-path="web-server-manual.html"><a href="web-server-manual.html#apache2-config"><i class="fa fa-check"></i><b>2.4.6</b> Apache2 Config</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-function-mannual.html"><a href="r-function-mannual.html"><i class="fa fa-check"></i><b>3</b> R Function Mannual</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#get-started"><i class="fa fa-check"></i><b>3.1</b> Get Started</a></li>
<li class="chapter" data-level="3.2" data-path="r-function-mannual.html"><a href="r-function-mannual.html#performance-evaluation-for-pathway-enrichment-analysis"><i class="fa fa-check"></i><b>3.2</b> Performance evaluation for pathway enrichment analysis</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#compare-mnet-with-tidymass"><i class="fa fa-check"></i><b>3.2.1</b> Compare MNet with TidyMass</a></li>
<li class="chapter" data-level="3.2.2" data-path="r-function-mannual.html"><a href="r-function-mannual.html#compare-mnet-with-clusterprofiler"><i class="fa fa-check"></i><b>3.2.2</b> Compare MNet with clusterProfiler</a></li>
<li class="chapter" data-level="3.2.3" data-path="r-function-mannual.html"><a href="r-function-mannual.html#compare-mnet-with-paintomics"><i class="fa fa-check"></i><b>3.2.3</b> Compare MNet with PaintOmics</a></li>
<li class="chapter" data-level="3.2.4" data-path="r-function-mannual.html"><a href="r-function-mannual.html#barplot"><i class="fa fa-check"></i><b>3.2.4</b> Barplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-function-mannual.html"><a href="r-function-mannual.html#performance-evaluation-for-gsea"><i class="fa fa-check"></i><b>3.3</b> Performance evaluation for GSEA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#mnet"><i class="fa fa-check"></i><b>3.3.1</b> MNet</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-function-mannual.html"><a href="r-function-mannual.html#multigsea"><i class="fa fa-check"></i><b>3.3.2</b> multiGSEA</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-function-mannual.html"><a href="r-function-mannual.html#comparison-between-mnet-and-multigsea"><i class="fa fa-check"></i><b>3.3.3</b> Comparison between MNet and multiGSEA</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-function-mannual.html"><a href="r-function-mannual.html#apply-to-acute-myeloid-leukemia"><i class="fa fa-check"></i><b>3.4</b> Apply to acute myeloid leukemia</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#input-data"><i class="fa fa-check"></i><b>3.4.1</b> Input data</a></li>
<li class="chapter" data-level="3.4.2" data-path="r-function-mannual.html"><a href="r-function-mannual.html#snetlyser-1"><i class="fa fa-check"></i><b>3.4.2</b> sNETlyser</a></li>
<li class="chapter" data-level="3.4.3" data-path="r-function-mannual.html"><a href="r-function-mannual.html#extended-pathway-analysers"><i class="fa fa-check"></i><b>3.4.3</b> Extended Pathway Analysers</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r-function-mannual.html"><a href="r-function-mannual.html#apply-to-triple-negative-breast-cancer"><i class="fa fa-check"></i><b>3.5</b> Apply to triple-negative breast cancer</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#snetlyser-2"><i class="fa fa-check"></i><b>3.5.1</b> sNETlyser</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-function-mannual.html"><a href="r-function-mannual.html#extended-pathway-analyses-1"><i class="fa fa-check"></i><b>3.5.2</b> Extended Pathway Analyses</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-function-mannual.html"><a href="r-function-mannual.html#apply-to-spatial-metabolomics"><i class="fa fa-check"></i><b>3.6</b> Apply to spatial metabolomics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#pea"><i class="fa fa-check"></i><b>3.6.1</b> PEA</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="r-function-mannual.html"><a href="r-function-mannual.html#need-help"><i class="fa fa-check"></i><b>3.7</b> Need help?</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="r-function-mannual.html"><a href="r-function-mannual.html#frequently-asked-questions"><i class="fa fa-check"></i><b>3.7.1</b> Frequently Asked Questions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MNet Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-function-mannual" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> R Function Mannual<a href="r-function-mannual.html#r-function-mannual" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="get-started" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Get Started<a href="r-function-mannual.html#get-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<strong>R Installation</strong>
</blockquote>
<p><a href="http://www.r-project.org">R</a> is a language and environment for statistical computing and graphics. We assume R (version 4.0.0 or higher) has been installed in your local machine. The latest version can be installed following instructions below for different platforms (Windows, Mac, and Linux).</p>
<ul>
<li>
<p>Quick link for Windows: <a href="https://cran.r-project.org/bin/windows/base/">Download R for Windows</a>.</p>
<li>
<p>Quick link for Mac: <a href="https://cran.r-project.org/bin/macosx/big-sur-arm64/base/">Download R for Mac OS X 11</a>.</p>
<li>
<p>Below are shell command lines in Terminal (for Linux):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="r-function-mannual.html#cb35-1" tabindex="-1"></a><span class="co">#Ensure you have the conda:</span></span>
<span id="cb35-2"><a href="r-function-mannual.html#cb35-2" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge r-base</span></code></pre></div>
</ul>
<blockquote>
<strong>MNet Installation</strong>
</blockquote>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="r-function-mannual.html#cb36-1" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(BiocManager)){</span>
<span id="cb36-2"><a href="r-function-mannual.html#cb36-2" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb36-3"><a href="r-function-mannual.html#cb36-3" tabindex="-1"></a>}</span>
<span id="cb36-4"><a href="r-function-mannual.html#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="r-function-mannual.html#cb36-5" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(remotes)) {</span>
<span id="cb36-6"><a href="r-function-mannual.html#cb36-6" tabindex="-1"></a>  BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;remotes&quot;</span>, <span class="at">dependencies=</span>T)</span>
<span id="cb36-7"><a href="r-function-mannual.html#cb36-7" tabindex="-1"></a>}</span>
<span id="cb36-8"><a href="r-function-mannual.html#cb36-8" tabindex="-1"></a></span>
<span id="cb36-9"><a href="r-function-mannual.html#cb36-9" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(devtools)) {</span>
<span id="cb36-10"><a href="r-function-mannual.html#cb36-10" tabindex="-1"></a>  BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;devtools&quot;</span>, <span class="at">dependencies=</span>T)</span>
<span id="cb36-11"><a href="r-function-mannual.html#cb36-11" tabindex="-1"></a>}</span>
<span id="cb36-12"><a href="r-function-mannual.html#cb36-12" tabindex="-1"></a></span>
<span id="cb36-13"><a href="r-function-mannual.html#cb36-13" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;hfang-bristol/dnet&quot;</span>, <span class="at">dependencies=</span>T)</span>
<span id="cb36-14"><a href="r-function-mannual.html#cb36-14" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;tuantuangui/MNet&quot;</span>, <span class="at">dependencies=</span>T)</span>
<span id="cb36-15"><a href="r-function-mannual.html#cb36-15" tabindex="-1"></a></span>
<span id="cb36-16"><a href="r-function-mannual.html#cb36-16" tabindex="-1"></a><span class="do">## Check the package ‘MNet’ successfully installed</span></span>
<span id="cb36-17"><a href="r-function-mannual.html#cb36-17" tabindex="-1"></a><span class="fu">library</span>(<span class="at">help=</span>MNet)</span></code></pre></div>
</div>
<div id="performance-evaluation-for-pathway-enrichment-analysis" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Performance evaluation for pathway enrichment analysis<a href="r-function-mannual.html#performance-evaluation-for-pathway-enrichment-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="compare-mnet-with-tidymass" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Compare MNet with TidyMass<a href="r-function-mannual.html#compare-mnet-with-tidymass" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="analyze-data" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Analyze data<a href="r-function-mannual.html#analyze-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analyzing metabolites data using MNet and TidyMass and using different method parameters.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="r-function-mannual.html#cb37-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-2"><a href="r-function-mannual.html#cb37-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb37-3"><a href="r-function-mannual.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="r-function-mannual.html#cb37-4" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb37-5"><a href="r-function-mannual.html#cb37-5" tabindex="-1"></a></span>
<span id="cb37-6"><a href="r-function-mannual.html#cb37-6" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb37-7"><a href="r-function-mannual.html#cb37-7" tabindex="-1"></a><span class="do">### Filter the increase differential genes and metabolites</span></span>
<span id="cb37-8"><a href="r-function-mannual.html#cb37-8" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="r-function-mannual.html#cb37-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="r-function-mannual.html#cb37-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb37-11"><a href="r-function-mannual.html#cb37-11" tabindex="-1"></a></span>
<span id="cb37-12"><a href="r-function-mannual.html#cb37-12" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-13"><a href="r-function-mannual.html#cb37-13" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb37-14"><a href="r-function-mannual.html#cb37-14" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-15"><a href="r-function-mannual.html#cb37-15" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb37-16"><a href="r-function-mannual.html#cb37-16" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;hypergeo_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb37-17"><a href="r-function-mannual.html#cb37-17" tabindex="-1"></a><span class="fu">write.table</span>(result_meta<span class="sc">$</span>out,<span class="st">&quot;result/ORA/MNet_pathway-hypergeo.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb37-18"><a href="r-function-mannual.html#cb37-18" tabindex="-1"></a></span>
<span id="cb37-19"><a href="r-function-mannual.html#cb37-19" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-20"><a href="r-function-mannual.html#cb37-20" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb37-21"><a href="r-function-mannual.html#cb37-21" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-22"><a href="r-function-mannual.html#cb37-22" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb37-23"><a href="r-function-mannual.html#cb37-23" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;fisher—_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb37-24"><a href="r-function-mannual.html#cb37-24" tabindex="-1"></a><span class="fu">write.table</span>(result_meta<span class="sc">$</span>out,<span class="st">&quot;result/ORA/MNet_pathway-fisher.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb37-25"><a href="r-function-mannual.html#cb37-25" tabindex="-1"></a></span>
<span id="cb37-26"><a href="r-function-mannual.html#cb37-26" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-27"><a href="r-function-mannual.html#cb37-27" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb37-28"><a href="r-function-mannual.html#cb37-28" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-29"><a href="r-function-mannual.html#cb37-29" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb37-30"><a href="r-function-mannual.html#cb37-30" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;binomial_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb37-31"><a href="r-function-mannual.html#cb37-31" tabindex="-1"></a><span class="fu">write.table</span>(result_meta<span class="sc">$</span>out,<span class="st">&quot;result/ORA/MNet_pathway-binomial.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb37-32"><a href="r-function-mannual.html#cb37-32" tabindex="-1"></a></span>
<span id="cb37-33"><a href="r-function-mannual.html#cb37-33" tabindex="-1"></a><span class="fu">library</span>(tidymass)</span>
<span id="cb37-34"><a href="r-function-mannual.html#cb37-34" tabindex="-1"></a></span>
<span id="cb37-35"><a href="r-function-mannual.html#cb37-35" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;kegg_hsa_pathway&quot;</span>, <span class="at">package =</span> <span class="st">&quot;metpath&quot;</span>)</span>
<span id="cb37-36"><a href="r-function-mannual.html#cb37-36" tabindex="-1"></a>pathway_database <span class="ot">=</span> kegg_hsa_pathway</span>
<span id="cb37-37"><a href="r-function-mannual.html#cb37-37" tabindex="-1"></a></span>
<span id="cb37-38"><a href="r-function-mannual.html#cb37-38" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-39"><a href="r-function-mannual.html#cb37-39" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">enrich_kegg</span>(<span class="at">query_id =</span> diff_meta<span class="sc">$</span>name,</span>
<span id="cb37-40"><a href="r-function-mannual.html#cb37-40" tabindex="-1"></a>                      <span class="at">query_type =</span> <span class="st">&quot;compound&quot;</span>,</span>
<span id="cb37-41"><a href="r-function-mannual.html#cb37-41" tabindex="-1"></a>                      <span class="at">id_type =</span> <span class="st">&quot;KEGG&quot;</span>,<span class="at">method =</span> <span class="st">&quot;hypergeometric&quot;</span>,</span>
<span id="cb37-42"><a href="r-function-mannual.html#cb37-42" tabindex="-1"></a>                      <span class="at">pathway_database =</span> pathway_database,</span>
<span id="cb37-43"><a href="r-function-mannual.html#cb37-43" tabindex="-1"></a>                      <span class="at">p_cutoff =</span> <span class="fl">1.1</span>,</span>
<span id="cb37-44"><a href="r-function-mannual.html#cb37-44" tabindex="-1"></a>                      <span class="at">p_adjust_method =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb37-45"><a href="r-function-mannual.html#cb37-45" tabindex="-1"></a>                      <span class="at">threads =</span> <span class="dv">10</span>)</span>
<span id="cb37-46"><a href="r-function-mannual.html#cb37-46" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-47"><a href="r-function-mannual.html#cb37-47" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb37-48"><a href="r-function-mannual.html#cb37-48" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Tidymass-hypergeometric_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb37-49"><a href="r-function-mannual.html#cb37-49" tabindex="-1"></a><span class="fu">write.table</span>(result<span class="sc">@</span>result,<span class="st">&quot;result/ORA/TidyMass_pathway-hypergeometric.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb37-50"><a href="r-function-mannual.html#cb37-50" tabindex="-1"></a></span>
<span id="cb37-51"><a href="r-function-mannual.html#cb37-51" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-52"><a href="r-function-mannual.html#cb37-52" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">enrich_kegg</span>(<span class="at">query_id =</span> diff_meta<span class="sc">$</span>name,</span>
<span id="cb37-53"><a href="r-function-mannual.html#cb37-53" tabindex="-1"></a>                      <span class="at">query_type =</span> <span class="st">&quot;compound&quot;</span>,</span>
<span id="cb37-54"><a href="r-function-mannual.html#cb37-54" tabindex="-1"></a>                      <span class="at">id_type =</span> <span class="st">&quot;KEGG&quot;</span>,<span class="at">method =</span> <span class="st">&quot;fisher&quot;</span>,</span>
<span id="cb37-55"><a href="r-function-mannual.html#cb37-55" tabindex="-1"></a>                      <span class="at">pathway_database =</span> pathway_database,</span>
<span id="cb37-56"><a href="r-function-mannual.html#cb37-56" tabindex="-1"></a>                      <span class="at">p_cutoff =</span> <span class="fl">1.1</span>,</span>
<span id="cb37-57"><a href="r-function-mannual.html#cb37-57" tabindex="-1"></a>                      <span class="at">p_adjust_method =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb37-58"><a href="r-function-mannual.html#cb37-58" tabindex="-1"></a>                      <span class="at">threads =</span> <span class="dv">10</span>)</span>
<span id="cb37-59"><a href="r-function-mannual.html#cb37-59" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb37-60"><a href="r-function-mannual.html#cb37-60" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb37-61"><a href="r-function-mannual.html#cb37-61" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Tidymass-fisher_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb37-62"><a href="r-function-mannual.html#cb37-62" tabindex="-1"></a><span class="fu">write.table</span>(result<span class="sc">@</span>result,<span class="st">&quot;result/ORA/TidyMass_pathway-fisher.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="set-different-cutoffs" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Set different cutoffs<a href="r-function-mannual.html#set-different-cutoffs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare the stability of the results of different methods under different cutoff values.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="r-function-mannual.html#cb38-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-2"><a href="r-function-mannual.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="r-function-mannual.html#cb38-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="r-function-mannual.html#cb38-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-5"><a href="r-function-mannual.html#cb38-5" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="r-function-mannual.html#cb38-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-7"><a href="r-function-mannual.html#cb38-7" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="r-function-mannual.html#cb38-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb38-9"><a href="r-function-mannual.html#cb38-9" tabindex="-1"></a></span>
<span id="cb38-10"><a href="r-function-mannual.html#cb38-10" tabindex="-1"></a>pathway_tidymass_hypergeometric <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-hypergeometric.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="r-function-mannual.html#cb38-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="r-function-mannual.html#cb38-12" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="r-function-mannual.html#cb38-13" tabindex="-1"></a>  <span class="fu">filter</span>(mapped_number <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb38-14"><a href="r-function-mannual.html#cb38-14" tabindex="-1"></a></span>
<span id="cb38-15"><a href="r-function-mannual.html#cb38-15" tabindex="-1"></a>pathway_tidymass_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-16"><a href="r-function-mannual.html#cb38-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-17"><a href="r-function-mannual.html#cb38-17" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="r-function-mannual.html#cb38-18" tabindex="-1"></a>  <span class="fu">filter</span>(mapped_number <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb38-19"><a href="r-function-mannual.html#cb38-19" tabindex="-1"></a></span>
<span id="cb38-20"><a href="r-function-mannual.html#cb38-20" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="sc">-</span><span class="fl">0.005</span>)</span>
<span id="cb38-21"><a href="r-function-mannual.html#cb38-21" tabindex="-1"></a></span>
<span id="cb38-22"><a href="r-function-mannual.html#cb38-22" tabindex="-1"></a>result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb38-23"><a href="r-function-mannual.html#cb38-23" tabindex="-1"></a>result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb38-24"><a href="r-function-mannual.html#cb38-24" tabindex="-1"></a>result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb38-25"><a href="r-function-mannual.html#cb38-25" tabindex="-1"></a></span>
<span id="cb38-26"><a href="r-function-mannual.html#cb38-26" tabindex="-1"></a>result_tidymass_hypergeometric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb38-27"><a href="r-function-mannual.html#cb38-27" tabindex="-1"></a>result_tidymass_fisher <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb38-28"><a href="r-function-mannual.html#cb38-28" tabindex="-1"></a></span>
<span id="cb38-29"><a href="r-function-mannual.html#cb38-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n) {</span>
<span id="cb38-30"><a href="r-function-mannual.html#cb38-30" tabindex="-1"></a>  <span class="do">## hypergeo</span></span>
<span id="cb38-31"><a href="r-function-mannual.html#cb38-31" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_hypergeo <span class="sc">%&gt;%</span></span>
<span id="cb38-32"><a href="r-function-mannual.html#cb38-32" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb38-33"><a href="r-function-mannual.html#cb38-33" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb38-34"><a href="r-function-mannual.html#cb38-34" tabindex="-1"></a>  result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo,result_mnet_temp)</span>
<span id="cb38-35"><a href="r-function-mannual.html#cb38-35" tabindex="-1"></a></span>
<span id="cb38-36"><a href="r-function-mannual.html#cb38-36" tabindex="-1"></a>  <span class="do">## fisher</span></span>
<span id="cb38-37"><a href="r-function-mannual.html#cb38-37" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_fisher <span class="sc">%&gt;%</span></span>
<span id="cb38-38"><a href="r-function-mannual.html#cb38-38" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb38-39"><a href="r-function-mannual.html#cb38-39" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb38-40"><a href="r-function-mannual.html#cb38-40" tabindex="-1"></a>  result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_fisher,result_mnet_temp)</span>
<span id="cb38-41"><a href="r-function-mannual.html#cb38-41" tabindex="-1"></a></span>
<span id="cb38-42"><a href="r-function-mannual.html#cb38-42" tabindex="-1"></a>  <span class="do">## binomial</span></span>
<span id="cb38-43"><a href="r-function-mannual.html#cb38-43" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_binomial <span class="sc">%&gt;%</span></span>
<span id="cb38-44"><a href="r-function-mannual.html#cb38-44" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb38-45"><a href="r-function-mannual.html#cb38-45" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb38-46"><a href="r-function-mannual.html#cb38-46" tabindex="-1"></a>  result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_binomial,result_mnet_temp)</span>
<span id="cb38-47"><a href="r-function-mannual.html#cb38-47" tabindex="-1"></a></span>
<span id="cb38-48"><a href="r-function-mannual.html#cb38-48" tabindex="-1"></a>  <span class="do">## hypergeometric</span></span>
<span id="cb38-49"><a href="r-function-mannual.html#cb38-49" tabindex="-1"></a>  pathway_tidymass_filter <span class="ot">&lt;-</span> pathway_tidymass_hypergeometric <span class="sc">%&gt;%</span></span>
<span id="cb38-50"><a href="r-function-mannual.html#cb38-50" tabindex="-1"></a>    <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> i)</span>
<span id="cb38-51"><a href="r-function-mannual.html#cb38-51" tabindex="-1"></a>  result_tidymass_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_tidymass_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb38-52"><a href="r-function-mannual.html#cb38-52" tabindex="-1"></a>  result_tidymass_hypergeometric <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_tidymass_hypergeometric,result_tidymass_temp)</span>
<span id="cb38-53"><a href="r-function-mannual.html#cb38-53" tabindex="-1"></a></span>
<span id="cb38-54"><a href="r-function-mannual.html#cb38-54" tabindex="-1"></a>  <span class="do">## fisher</span></span>
<span id="cb38-55"><a href="r-function-mannual.html#cb38-55" tabindex="-1"></a>  pathway_tidymass_filter <span class="ot">&lt;-</span> pathway_tidymass_fisher <span class="sc">%&gt;%</span></span>
<span id="cb38-56"><a href="r-function-mannual.html#cb38-56" tabindex="-1"></a>    <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> i)</span>
<span id="cb38-57"><a href="r-function-mannual.html#cb38-57" tabindex="-1"></a>  result_tidymass_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_tidymass_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb38-58"><a href="r-function-mannual.html#cb38-58" tabindex="-1"></a>  result_tidymass_fisher <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_tidymass_fisher,result_tidymass_temp)</span>
<span id="cb38-59"><a href="r-function-mannual.html#cb38-59" tabindex="-1"></a>}</span>
<span id="cb38-60"><a href="r-function-mannual.html#cb38-60" tabindex="-1"></a></span>
<span id="cb38-61"><a href="r-function-mannual.html#cb38-61" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>),</span>
<span id="cb38-62"><a href="r-function-mannual.html#cb38-62" tabindex="-1"></a>                result_mnet_fisher <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>),</span>
<span id="cb38-63"><a href="r-function-mannual.html#cb38-63" tabindex="-1"></a>                result_mnet_binomial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>),</span>
<span id="cb38-64"><a href="r-function-mannual.html#cb38-64" tabindex="-1"></a>                result_tidymass_hypergeometric <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;tidymass_hypergeometric&quot;</span>),</span>
<span id="cb38-65"><a href="r-function-mannual.html#cb38-65" tabindex="-1"></a>                result_tidymass_fisher <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;tidymass_fisher&quot;</span>))</span>
<span id="cb38-66"><a href="r-function-mannual.html#cb38-66" tabindex="-1"></a></span>
<span id="cb38-67"><a href="r-function-mannual.html#cb38-67" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(cutoff,n))<span class="sc">+</span></span>
<span id="cb38-68"><a href="r-function-mannual.html#cb38-68" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;gray&quot;</span>,<span class="at">size=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb38-69"><a href="r-function-mannual.html#cb38-69" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color=</span>type))<span class="sc">+</span></span>
<span id="cb38-70"><a href="r-function-mannual.html#cb38-70" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="fl">0.01</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb38-71"><a href="r-function-mannual.html#cb38-71" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;#37AB78&quot;</span>,<span class="st">&quot;#589FF3&quot;</span>))<span class="sc">+</span></span>
<span id="cb38-72"><a href="r-function-mannual.html#cb38-72" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb38-73"><a href="r-function-mannual.html#cb38-73" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-74"><a href="r-function-mannual.html#cb38-74" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/Tidymass-cutoff.pdf&quot;</span>,p,<span class="at">width=</span><span class="fl">6.5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/tidymass-cutoff.png" width="374" style="display: block; margin: auto;" /></p>
</div>
<div id="venn-plot" class="section level4 hasAnchor" number="3.2.1.3">
<h4><span class="header-section-number">3.2.1.3</span> Venn plot<a href="r-function-mannual.html#venn-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifying the agreement of different methods using Venn diagrams.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="r-function-mannual.html#cb39-1" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb39-2"><a href="r-function-mannual.html#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="r-function-mannual.html#cb39-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="r-function-mannual.html#cb39-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="r-function-mannual.html#cb39-5" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb39-6"><a href="r-function-mannual.html#cb39-6" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="r-function-mannual.html#cb39-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="r-function-mannual.html#cb39-8" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb39-9"><a href="r-function-mannual.html#cb39-9" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="r-function-mannual.html#cb39-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="r-function-mannual.html#cb39-11" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb39-12"><a href="r-function-mannual.html#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="r-function-mannual.html#cb39-13" tabindex="-1"></a>pathway_tidymass_hypergeometric <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-hypergeometric.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="r-function-mannual.html#cb39-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="r-function-mannual.html#cb39-15" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="r-function-mannual.html#cb39-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb39-17"><a href="r-function-mannual.html#cb39-17" tabindex="-1"></a>pathway_tidymass_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="r-function-mannual.html#cb39-18" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="r-function-mannual.html#cb39-19" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb39-20"><a href="r-function-mannual.html#cb39-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb39-21"><a href="r-function-mannual.html#cb39-21" tabindex="-1"></a></span>
<span id="cb39-22"><a href="r-function-mannual.html#cb39-22" tabindex="-1"></a>venn.plot <span class="ot">&lt;-</span> <span class="fu">venn.diagram</span>(</span>
<span id="cb39-23"><a href="r-function-mannual.html#cb39-23" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb39-24"><a href="r-function-mannual.html#cb39-24" tabindex="-1"></a>    <span class="at">MNet_hypergeo =</span> pathway_mnet_hypergeo<span class="sc">$</span>name,</span>
<span id="cb39-25"><a href="r-function-mannual.html#cb39-25" tabindex="-1"></a>    <span class="at">MNet_fisher =</span> pathway_mnet_fisher<span class="sc">$</span>name,</span>
<span id="cb39-26"><a href="r-function-mannual.html#cb39-26" tabindex="-1"></a>    <span class="at">MNet_binomial =</span> pathway_mnet_binomial<span class="sc">$</span>name,</span>
<span id="cb39-27"><a href="r-function-mannual.html#cb39-27" tabindex="-1"></a>    <span class="at">tidymass_hypergeometric =</span> pathway_tidymass_hypergeometric<span class="sc">$</span>pathway_name,</span>
<span id="cb39-28"><a href="r-function-mannual.html#cb39-28" tabindex="-1"></a>    <span class="at">tidymass_fisher =</span> pathway_tidymass_fisher<span class="sc">$</span>pathway_name</span>
<span id="cb39-29"><a href="r-function-mannual.html#cb39-29" tabindex="-1"></a>  ),</span>
<span id="cb39-30"><a href="r-function-mannual.html#cb39-30" tabindex="-1"></a>  <span class="at">filename =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-31"><a href="r-function-mannual.html#cb39-31" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;#589FF3&quot;</span>,<span class="st">&quot;#37AB78&quot;</span>),</span>
<span id="cb39-32"><a href="r-function-mannual.html#cb39-32" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.9</span>)</span>
<span id="cb39-33"><a href="r-function-mannual.html#cb39-33" tabindex="-1"></a></span>
<span id="cb39-34"><a href="r-function-mannual.html#cb39-34" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/ORA/MNet-TidyMass-venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">7</span>,<span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb39-35"><a href="r-function-mannual.html#cb39-35" tabindex="-1"></a><span class="fu">grid.draw</span>(venn.plot)</span>
<span id="cb39-36"><a href="r-function-mannual.html#cb39-36" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figure/tidymass-venn.png" width="345" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="compare-mnet-with-clusterprofiler" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Compare MNet with clusterProfiler<a href="r-function-mannual.html#compare-mnet-with-clusterprofiler" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="analyze-data-1" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Analyze data<a href="r-function-mannual.html#analyze-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analyzing metabolite-related genes data using MNet and clusterProfiler and using different method parameters.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="r-function-mannual.html#cb40-1" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span>
<span id="cb40-2"><a href="r-function-mannual.html#cb40-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-3"><a href="r-function-mannual.html#cb40-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb40-4"><a href="r-function-mannual.html#cb40-4" tabindex="-1"></a><span class="fu">library</span>(KEGG.db)</span>
<span id="cb40-5"><a href="r-function-mannual.html#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="r-function-mannual.html#cb40-6" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb40-7"><a href="r-function-mannual.html#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="r-function-mannual.html#cb40-8" tabindex="-1"></a>gene_filter <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="r-function-mannual.html#cb40-9" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="r-function-mannual.html#cb40-10" tabindex="-1"></a>  <span class="fu">pull</span>(name) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb40-11"><a href="r-function-mannual.html#cb40-11" tabindex="-1"></a></span>
<span id="cb40-12"><a href="r-function-mannual.html#cb40-12" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb40-13"><a href="r-function-mannual.html#cb40-13" tabindex="-1"></a><span class="do">### Filter the increase differential genes and metabolites</span></span>
<span id="cb40-14"><a href="r-function-mannual.html#cb40-14" tabindex="-1"></a>diff_gene_all <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="r-function-mannual.html#cb40-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="r-function-mannual.html#cb40-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb40-17"><a href="r-function-mannual.html#cb40-17" tabindex="-1"></a></span>
<span id="cb40-18"><a href="r-function-mannual.html#cb40-18" tabindex="-1"></a>gene.data <span class="ot">&lt;-</span> clusterProfiler<span class="sc">::</span><span class="fu">bitr</span>(diff_gene_all<span class="sc">$</span>name,<span class="at">fromType =</span> <span class="st">&quot;SYMBOL&quot;</span>,<span class="at">toType =</span><span class="st">&quot;ENTREZID&quot;</span>,<span class="at">OrgDb=</span><span class="st">&#39;org.Hs.eg.db&#39;</span>)</span>
<span id="cb40-19"><a href="r-function-mannual.html#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="r-function-mannual.html#cb40-20" tabindex="-1"></a>diff_gene_clusterprofiler <span class="ot">&lt;-</span> diff_gene_all <span class="sc">%&gt;%</span></span>
<span id="cb40-21"><a href="r-function-mannual.html#cb40-21" tabindex="-1"></a>  <span class="fu">inner_join</span>(gene.data,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;SYMBOL&quot;</span>))</span>
<span id="cb40-22"><a href="r-function-mannual.html#cb40-22" tabindex="-1"></a></span>
<span id="cb40-23"><a href="r-function-mannual.html#cb40-23" tabindex="-1"></a>kegg_F <span class="ot">&lt;-</span> <span class="fu">enrichKEGG</span>(</span>
<span id="cb40-24"><a href="r-function-mannual.html#cb40-24" tabindex="-1"></a>  <span class="at">gene =</span> diff_gene_clusterprofiler<span class="sc">$</span>ENTREZID,</span>
<span id="cb40-25"><a href="r-function-mannual.html#cb40-25" tabindex="-1"></a>  <span class="at">keyType =</span> <span class="st">&#39;kegg&#39;</span>,  </span>
<span id="cb40-26"><a href="r-function-mannual.html#cb40-26" tabindex="-1"></a>  <span class="at">organism =</span> <span class="st">&#39;hsa&#39;</span>,</span>
<span id="cb40-27"><a href="r-function-mannual.html#cb40-27" tabindex="-1"></a>  <span class="at">minGSSize =</span> <span class="dv">1</span>,</span>
<span id="cb40-28"><a href="r-function-mannual.html#cb40-28" tabindex="-1"></a>  <span class="at">pAdjustMethod =</span> <span class="st">&#39;BH&#39;</span>,  </span>
<span id="cb40-29"><a href="r-function-mannual.html#cb40-29" tabindex="-1"></a>  <span class="at">pvalueCutoff =</span> <span class="fl">1.1</span>,  </span>
<span id="cb40-30"><a href="r-function-mannual.html#cb40-30" tabindex="-1"></a>  <span class="at">use_internal_data =</span> F)</span>
<span id="cb40-31"><a href="r-function-mannual.html#cb40-31" tabindex="-1"></a></span>
<span id="cb40-32"><a href="r-function-mannual.html#cb40-32" tabindex="-1"></a><span class="fu">write.table</span>(kegg_F<span class="sc">@</span>result,<span class="st">&quot;result/ORA/clusterprofiler-gene-F.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb40-33"><a href="r-function-mannual.html#cb40-33" tabindex="-1"></a></span>
<span id="cb40-34"><a href="r-function-mannual.html#cb40-34" tabindex="-1"></a>kegg_T <span class="ot">&lt;-</span> <span class="fu">enrichKEGG</span>(</span>
<span id="cb40-35"><a href="r-function-mannual.html#cb40-35" tabindex="-1"></a>  <span class="at">gene =</span> diff_gene_clusterprofiler<span class="sc">$</span>ENTREZID,  </span>
<span id="cb40-36"><a href="r-function-mannual.html#cb40-36" tabindex="-1"></a>  <span class="at">keyType =</span> <span class="st">&#39;kegg&#39;</span>,  </span>
<span id="cb40-37"><a href="r-function-mannual.html#cb40-37" tabindex="-1"></a>  <span class="at">organism =</span> <span class="st">&#39;hsa&#39;</span>,</span>
<span id="cb40-38"><a href="r-function-mannual.html#cb40-38" tabindex="-1"></a>  <span class="at">minGSSize =</span> <span class="dv">1</span>,</span>
<span id="cb40-39"><a href="r-function-mannual.html#cb40-39" tabindex="-1"></a>  <span class="at">pAdjustMethod =</span> <span class="st">&#39;BH&#39;</span>,  </span>
<span id="cb40-40"><a href="r-function-mannual.html#cb40-40" tabindex="-1"></a>  <span class="at">pvalueCutoff =</span> <span class="fl">1.1</span>,  </span>
<span id="cb40-41"><a href="r-function-mannual.html#cb40-41" tabindex="-1"></a>  <span class="at">use_internal_data =</span> T)</span>
<span id="cb40-42"><a href="r-function-mannual.html#cb40-42" tabindex="-1"></a></span>
<span id="cb40-43"><a href="r-function-mannual.html#cb40-43" tabindex="-1"></a><span class="fu">write.table</span>(kegg_T<span class="sc">@</span>result,<span class="st">&quot;result/ORA/clusterprofiler-gene-T.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb40-44"><a href="r-function-mannual.html#cb40-44" tabindex="-1"></a></span>
<span id="cb40-45"><a href="r-function-mannual.html#cb40-45" tabindex="-1"></a>diff_gene_mnet <span class="ot">&lt;-</span> diff_gene_all <span class="sc">%&gt;%</span></span>
<span id="cb40-46"><a href="r-function-mannual.html#cb40-46" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> gene_filter)</span>
<span id="cb40-47"><a href="r-function-mannual.html#cb40-47" tabindex="-1"></a></span>
<span id="cb40-48"><a href="r-function-mannual.html#cb40-48" tabindex="-1"></a>gene_MNet_result_hypergeo <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb40-49"><a href="r-function-mannual.html#cb40-49" tabindex="-1"></a><span class="fu">write.table</span>(gene_MNet_result_hypergeo<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-gene_hypergeo.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb40-50"><a href="r-function-mannual.html#cb40-50" tabindex="-1"></a></span>
<span id="cb40-51"><a href="r-function-mannual.html#cb40-51" tabindex="-1"></a>gene_MNet_result_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb40-52"><a href="r-function-mannual.html#cb40-52" tabindex="-1"></a><span class="fu">write.table</span>(gene_MNet_result_fisher<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-gene_fisher.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb40-53"><a href="r-function-mannual.html#cb40-53" tabindex="-1"></a></span>
<span id="cb40-54"><a href="r-function-mannual.html#cb40-54" tabindex="-1"></a>gene_MNet_result_binomial <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb40-55"><a href="r-function-mannual.html#cb40-55" tabindex="-1"></a><span class="fu">write.table</span>(gene_MNet_result_binomial<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-gene_binomial.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="set-different-cutoffs-1" class="section level4 hasAnchor" number="3.2.2.2">
<h4><span class="header-section-number">3.2.2.2</span> Set different cutoffs<a href="r-function-mannual.html#set-different-cutoffs-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare the stability of the results of different methods under different cutoff values.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="r-function-mannual.html#cb41-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-2"><a href="r-function-mannual.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="r-function-mannual.html#cb41-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="r-function-mannual.html#cb41-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-5"><a href="r-function-mannual.html#cb41-5" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="r-function-mannual.html#cb41-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-7"><a href="r-function-mannual.html#cb41-7" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="r-function-mannual.html#cb41-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb41-9"><a href="r-function-mannual.html#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="r-function-mannual.html#cb41-10" tabindex="-1"></a>pathway_clusterprofiler_F <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/clusterprofiler-gene-F.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="r-function-mannual.html#cb41-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="r-function-mannual.html#cb41-12" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayid)</span>
<span id="cb41-13"><a href="r-function-mannual.html#cb41-13" tabindex="-1"></a>pathway_clusterprofiler_T <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/clusterprofiler-gene-T.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="r-function-mannual.html#cb41-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="r-function-mannual.html#cb41-15" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayid)</span>
<span id="cb41-16"><a href="r-function-mannual.html#cb41-16" tabindex="-1"></a></span>
<span id="cb41-17"><a href="r-function-mannual.html#cb41-17" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="sc">-</span><span class="fl">0.005</span>)</span>
<span id="cb41-18"><a href="r-function-mannual.html#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="r-function-mannual.html#cb41-19" tabindex="-1"></a>result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-20"><a href="r-function-mannual.html#cb41-20" tabindex="-1"></a>result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-21"><a href="r-function-mannual.html#cb41-21" tabindex="-1"></a>result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-22"><a href="r-function-mannual.html#cb41-22" tabindex="-1"></a></span>
<span id="cb41-23"><a href="r-function-mannual.html#cb41-23" tabindex="-1"></a>result_clusterprofiler_T <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-24"><a href="r-function-mannual.html#cb41-24" tabindex="-1"></a>result_clusterprofiler_F <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb41-25"><a href="r-function-mannual.html#cb41-25" tabindex="-1"></a></span>
<span id="cb41-26"><a href="r-function-mannual.html#cb41-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n) {</span>
<span id="cb41-27"><a href="r-function-mannual.html#cb41-27" tabindex="-1"></a>  <span class="do">## hypergeo</span></span>
<span id="cb41-28"><a href="r-function-mannual.html#cb41-28" tabindex="-1"></a>  pathway_mnet_hypergeo_filter <span class="ot">&lt;-</span> pathway_mnet_hypergeo <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="r-function-mannual.html#cb41-29" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb41-30"><a href="r-function-mannual.html#cb41-30" tabindex="-1"></a>  result_mnet_hypergeo_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_hypergeo_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb41-31"><a href="r-function-mannual.html#cb41-31" tabindex="-1"></a>  result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo,result_mnet_hypergeo_temp)</span>
<span id="cb41-32"><a href="r-function-mannual.html#cb41-32" tabindex="-1"></a></span>
<span id="cb41-33"><a href="r-function-mannual.html#cb41-33" tabindex="-1"></a>  <span class="do">## fisher</span></span>
<span id="cb41-34"><a href="r-function-mannual.html#cb41-34" tabindex="-1"></a>  pathway_mnet_fisher_filter <span class="ot">&lt;-</span> pathway_mnet_fisher <span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="r-function-mannual.html#cb41-35" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb41-36"><a href="r-function-mannual.html#cb41-36" tabindex="-1"></a>  result_mnet_fisher_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_fisher_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb41-37"><a href="r-function-mannual.html#cb41-37" tabindex="-1"></a>  result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_fisher,result_mnet_fisher_temp)</span>
<span id="cb41-38"><a href="r-function-mannual.html#cb41-38" tabindex="-1"></a></span>
<span id="cb41-39"><a href="r-function-mannual.html#cb41-39" tabindex="-1"></a>  <span class="do">## binomial</span></span>
<span id="cb41-40"><a href="r-function-mannual.html#cb41-40" tabindex="-1"></a>  pathway_mnet_binomial_filter <span class="ot">&lt;-</span> pathway_mnet_binomial <span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="r-function-mannual.html#cb41-41" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb41-42"><a href="r-function-mannual.html#cb41-42" tabindex="-1"></a>  result_mnet_binomial_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_binomial_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb41-43"><a href="r-function-mannual.html#cb41-43" tabindex="-1"></a>  result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_binomial,result_mnet_binomial_temp)</span>
<span id="cb41-44"><a href="r-function-mannual.html#cb41-44" tabindex="-1"></a></span>
<span id="cb41-45"><a href="r-function-mannual.html#cb41-45" tabindex="-1"></a>  <span class="co"># clusterProfiler-T</span></span>
<span id="cb41-46"><a href="r-function-mannual.html#cb41-46" tabindex="-1"></a>  pathway_clusterprofiler_T_filter <span class="ot">&lt;-</span> pathway_clusterprofiler_T <span class="sc">%&gt;%</span></span>
<span id="cb41-47"><a href="r-function-mannual.html#cb41-47" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb41-48"><a href="r-function-mannual.html#cb41-48" tabindex="-1"></a>  result_clusterprofiler_T_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_clusterprofiler_T_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb41-49"><a href="r-function-mannual.html#cb41-49" tabindex="-1"></a>  result_clusterprofiler_T <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_clusterprofiler_T,result_clusterprofiler_T_temp)</span>
<span id="cb41-50"><a href="r-function-mannual.html#cb41-50" tabindex="-1"></a></span>
<span id="cb41-51"><a href="r-function-mannual.html#cb41-51" tabindex="-1"></a>  <span class="co"># clusterProfiler-F</span></span>
<span id="cb41-52"><a href="r-function-mannual.html#cb41-52" tabindex="-1"></a>  pathway_clusterprofiler_F_filter <span class="ot">&lt;-</span> pathway_clusterprofiler_F <span class="sc">%&gt;%</span></span>
<span id="cb41-53"><a href="r-function-mannual.html#cb41-53" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb41-54"><a href="r-function-mannual.html#cb41-54" tabindex="-1"></a>  result_clusterprofiler_F_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_clusterprofiler_F_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb41-55"><a href="r-function-mannual.html#cb41-55" tabindex="-1"></a>  result_clusterprofiler_F <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_clusterprofiler_F,result_clusterprofiler_F_temp)</span>
<span id="cb41-56"><a href="r-function-mannual.html#cb41-56" tabindex="-1"></a>}</span>
<span id="cb41-57"><a href="r-function-mannual.html#cb41-57" tabindex="-1"></a></span>
<span id="cb41-58"><a href="r-function-mannual.html#cb41-58" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>),</span>
<span id="cb41-59"><a href="r-function-mannual.html#cb41-59" tabindex="-1"></a>                result_mnet_fisher <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>),</span>
<span id="cb41-60"><a href="r-function-mannual.html#cb41-60" tabindex="-1"></a>                result_mnet_binomial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>),</span>
<span id="cb41-61"><a href="r-function-mannual.html#cb41-61" tabindex="-1"></a>                result_clusterprofiler_F <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;clusterprofiler_F&quot;</span>))</span>
<span id="cb41-62"><a href="r-function-mannual.html#cb41-62" tabindex="-1"></a></span>
<span id="cb41-63"><a href="r-function-mannual.html#cb41-63" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(cutoff,n))<span class="sc">+</span></span>
<span id="cb41-64"><a href="r-function-mannual.html#cb41-64" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;gray&quot;</span>,<span class="at">size=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb41-65"><a href="r-function-mannual.html#cb41-65" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color=</span>type))<span class="sc">+</span></span>
<span id="cb41-66"><a href="r-function-mannual.html#cb41-66" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="fl">0.01</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-67"><a href="r-function-mannual.html#cb41-67" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;MNet_hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,</span>
<span id="cb41-68"><a href="r-function-mannual.html#cb41-68" tabindex="-1"></a>                              <span class="st">&quot;MNet_fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,</span>
<span id="cb41-69"><a href="r-function-mannual.html#cb41-69" tabindex="-1"></a>                              <span class="st">&quot;MNet_binomial&quot;</span><span class="ot">=</span><span class="st">&quot;#F3B169&quot;</span>,</span>
<span id="cb41-70"><a href="r-function-mannual.html#cb41-70" tabindex="-1"></a>                              <span class="st">&quot;clusterprofiler_F&quot;</span><span class="ot">=</span><span class="st">&quot;#AA66EB&quot;</span>))<span class="sc">+</span></span>
<span id="cb41-71"><a href="r-function-mannual.html#cb41-71" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb41-72"><a href="r-function-mannual.html#cb41-72" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb41-73"><a href="r-function-mannual.html#cb41-73" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/clusterprofiler-cutoff.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/cluster-cutoff.png" width="349" style="display: block; margin: auto;" /></p>
</div>
<div id="venn-plot-1" class="section level4 hasAnchor" number="3.2.2.3">
<h4><span class="header-section-number">3.2.2.3</span> Venn plot<a href="r-function-mannual.html#venn-plot-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifying the agreement of different methods using Venn diagrams.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="r-function-mannual.html#cb42-1" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb42-2"><a href="r-function-mannual.html#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="r-function-mannual.html#cb42-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="r-function-mannual.html#cb42-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="r-function-mannual.html#cb42-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="r-function-mannual.html#cb42-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="r-function-mannual.html#cb42-7" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb42-8"><a href="r-function-mannual.html#cb42-8" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="r-function-mannual.html#cb42-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="r-function-mannual.html#cb42-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="r-function-mannual.html#cb42-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="r-function-mannual.html#cb42-12" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb42-13"><a href="r-function-mannual.html#cb42-13" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="r-function-mannual.html#cb42-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-15"><a href="r-function-mannual.html#cb42-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="r-function-mannual.html#cb42-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="r-function-mannual.html#cb42-17" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb42-18"><a href="r-function-mannual.html#cb42-18" tabindex="-1"></a></span>
<span id="cb42-19"><a href="r-function-mannual.html#cb42-19" tabindex="-1"></a>pathway_clusterprofiler <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/clusterprofiler-gene-F.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="r-function-mannual.html#cb42-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="r-function-mannual.html#cb42-21" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayid) <span class="sc">%&gt;%</span></span>
<span id="cb42-22"><a href="r-function-mannual.html#cb42-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Description,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb42-23"><a href="r-function-mannual.html#cb42-23" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Description&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-24"><a href="r-function-mannual.html#cb42-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;clusterprofiler&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb42-25"><a href="r-function-mannual.html#cb42-25" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb42-26"><a href="r-function-mannual.html#cb42-26" tabindex="-1"></a></span>
<span id="cb42-27"><a href="r-function-mannual.html#cb42-27" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">mnet_hypergeo=</span>pathway_mnet_hypergeo<span class="sc">$</span>name,</span>
<span id="cb42-28"><a href="r-function-mannual.html#cb42-28" tabindex="-1"></a>                     <span class="at">mnet_fisher=</span>pathway_mnet_fisher<span class="sc">$</span>name,</span>
<span id="cb42-29"><a href="r-function-mannual.html#cb42-29" tabindex="-1"></a>                     <span class="at">mnet_binomial=</span>pathway_mnet_binomial<span class="sc">$</span>name,</span>
<span id="cb42-30"><a href="r-function-mannual.html#cb42-30" tabindex="-1"></a>                     <span class="at">clusterprofiler=</span>pathway_clusterprofiler<span class="sc">$</span>name),</span>
<span id="cb42-31"><a href="r-function-mannual.html#cb42-31" tabindex="-1"></a>                <span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;#AA66EB&quot;</span>),<span class="at">alpha =</span><span class="fl">0.9</span>)</span>
<span id="cb42-32"><a href="r-function-mannual.html#cb42-32" tabindex="-1"></a></span>
<span id="cb42-33"><a href="r-function-mannual.html#cb42-33" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/ORA/clusterprofiler-venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb42-34"><a href="r-function-mannual.html#cb42-34" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb42-35"><a href="r-function-mannual.html#cb42-35" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figure/cluster-venn.png" width="394" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="compare-mnet-with-paintomics" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Compare MNet with PaintOmics<a href="r-function-mannual.html#compare-mnet-with-paintomics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="analyze-data-2" class="section level4 hasAnchor" number="3.2.3.1">
<h4><span class="header-section-number">3.2.3.1</span> Analyze data<a href="r-function-mannual.html#analyze-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analyzing metabolites and metabolite-related genes data using MNet and PaintOmics and using different method parameters.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="r-function-mannual.html#cb43-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-2"><a href="r-function-mannual.html#cb43-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb43-3"><a href="r-function-mannual.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="r-function-mannual.html#cb43-4" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb43-5"><a href="r-function-mannual.html#cb43-5" tabindex="-1"></a></span>
<span id="cb43-6"><a href="r-function-mannual.html#cb43-6" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb43-7"><a href="r-function-mannual.html#cb43-7" tabindex="-1"></a><span class="do">### Filter the increase differential genes and metabolites</span></span>
<span id="cb43-8"><a href="r-function-mannual.html#cb43-8" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="r-function-mannual.html#cb43-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="r-function-mannual.html#cb43-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb43-11"><a href="r-function-mannual.html#cb43-11" tabindex="-1"></a></span>
<span id="cb43-12"><a href="r-function-mannual.html#cb43-12" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb43-13"><a href="r-function-mannual.html#cb43-13" tabindex="-1"></a></span>
<span id="cb43-14"><a href="r-function-mannual.html#cb43-14" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb43-15"><a href="r-function-mannual.html#cb43-15" tabindex="-1"></a><span class="do">## Filter the increase differential genes and metabolites</span></span>
<span id="cb43-16"><a href="r-function-mannual.html#cb43-16" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="r-function-mannual.html#cb43-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-18"><a href="r-function-mannual.html#cb43-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb43-19"><a href="r-function-mannual.html#cb43-19" tabindex="-1"></a></span>
<span id="cb43-20"><a href="r-function-mannual.html#cb43-20" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_meta,diff_gene) <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="r-function-mannual.html#cb43-21" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name)</span>
<span id="cb43-22"><a href="r-function-mannual.html#cb43-22" tabindex="-1"></a></span>
<span id="cb43-23"><a href="r-function-mannual.html#cb43-23" tabindex="-1"></a>result_pathway_hypergeo <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb43-24"><a href="r-function-mannual.html#cb43-24" tabindex="-1"></a><span class="fu">write.table</span>(result_pathway_hypergeo<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-Extended-hypergeo.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb43-25"><a href="r-function-mannual.html#cb43-25" tabindex="-1"></a></span>
<span id="cb43-26"><a href="r-function-mannual.html#cb43-26" tabindex="-1"></a>result_pathway_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb43-27"><a href="r-function-mannual.html#cb43-27" tabindex="-1"></a><span class="fu">write.table</span>(result_pathway_fisher<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-Extended-fisher.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb43-28"><a href="r-function-mannual.html#cb43-28" tabindex="-1"></a></span>
<span id="cb43-29"><a href="r-function-mannual.html#cb43-29" tabindex="-1"></a>result_pathway_binomial <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb43-30"><a href="r-function-mannual.html#cb43-30" tabindex="-1"></a><span class="fu">write.table</span>(result_pathway_binomial<span class="sc">$</span>output,<span class="st">&quot;result/ORA/MNet-Extended-binomial.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="set-different-cutoffs-2" class="section level4 hasAnchor" number="3.2.3.2">
<h4><span class="header-section-number">3.2.3.2</span> Set different cutoffs<a href="r-function-mannual.html#set-different-cutoffs-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare the stability of the results of different methods under different cutoff values.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="r-function-mannual.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-2"><a href="r-function-mannual.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="r-function-mannual.html#cb44-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="r-function-mannual.html#cb44-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb44-5"><a href="r-function-mannual.html#cb44-5" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="r-function-mannual.html#cb44-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb44-7"><a href="r-function-mannual.html#cb44-7" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="r-function-mannual.html#cb44-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb44-9"><a href="r-function-mannual.html#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="r-function-mannual.html#cb44-10" tabindex="-1"></a>pathway_paintomics <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/PaintOmics.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="r-function-mannual.html#cb44-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="r-function-mannual.html#cb44-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>V7) <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="r-function-mannual.html#cb44-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Pathway name</span><span class="st">`</span> <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname)</span>
<span id="cb44-14"><a href="r-function-mannual.html#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="r-function-mannual.html#cb44-15" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="sc">-</span><span class="fl">0.005</span>)</span>
<span id="cb44-16"><a href="r-function-mannual.html#cb44-16" tabindex="-1"></a></span>
<span id="cb44-17"><a href="r-function-mannual.html#cb44-17" tabindex="-1"></a>result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb44-18"><a href="r-function-mannual.html#cb44-18" tabindex="-1"></a>result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb44-19"><a href="r-function-mannual.html#cb44-19" tabindex="-1"></a>result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb44-20"><a href="r-function-mannual.html#cb44-20" tabindex="-1"></a></span>
<span id="cb44-21"><a href="r-function-mannual.html#cb44-21" tabindex="-1"></a>result_paintomics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb44-22"><a href="r-function-mannual.html#cb44-22" tabindex="-1"></a></span>
<span id="cb44-23"><a href="r-function-mannual.html#cb44-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n) {</span>
<span id="cb44-24"><a href="r-function-mannual.html#cb44-24" tabindex="-1"></a>  <span class="do">## hypergeo</span></span>
<span id="cb44-25"><a href="r-function-mannual.html#cb44-25" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_hypergeo <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="r-function-mannual.html#cb44-26" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb44-27"><a href="r-function-mannual.html#cb44-27" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb44-28"><a href="r-function-mannual.html#cb44-28" tabindex="-1"></a>  result_mnet_hypergeo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo,result_mnet_temp)</span>
<span id="cb44-29"><a href="r-function-mannual.html#cb44-29" tabindex="-1"></a></span>
<span id="cb44-30"><a href="r-function-mannual.html#cb44-30" tabindex="-1"></a>  <span class="do">## fisher</span></span>
<span id="cb44-31"><a href="r-function-mannual.html#cb44-31" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_fisher <span class="sc">%&gt;%</span></span>
<span id="cb44-32"><a href="r-function-mannual.html#cb44-32" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb44-33"><a href="r-function-mannual.html#cb44-33" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb44-34"><a href="r-function-mannual.html#cb44-34" tabindex="-1"></a>  result_mnet_fisher <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_fisher,result_mnet_temp)</span>
<span id="cb44-35"><a href="r-function-mannual.html#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="r-function-mannual.html#cb44-36" tabindex="-1"></a>  <span class="do">## binomial</span></span>
<span id="cb44-37"><a href="r-function-mannual.html#cb44-37" tabindex="-1"></a>  pathway_mnet_filter <span class="ot">&lt;-</span> pathway_mnet_binomial <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="r-function-mannual.html#cb44-38" tabindex="-1"></a>    <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> i)</span>
<span id="cb44-39"><a href="r-function-mannual.html#cb44-39" tabindex="-1"></a>  result_mnet_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_mnet_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb44-40"><a href="r-function-mannual.html#cb44-40" tabindex="-1"></a>  result_mnet_binomial <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_binomial,result_mnet_temp)</span>
<span id="cb44-41"><a href="r-function-mannual.html#cb44-41" tabindex="-1"></a></span>
<span id="cb44-42"><a href="r-function-mannual.html#cb44-42" tabindex="-1"></a>  <span class="do">## hypergeometric</span></span>
<span id="cb44-43"><a href="r-function-mannual.html#cb44-43" tabindex="-1"></a>  pathway_paintomics_filter <span class="ot">&lt;-</span> pathway_paintomics <span class="sc">%&gt;%</span></span>
<span id="cb44-44"><a href="r-function-mannual.html#cb44-44" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="st">`</span><span class="at">Combined pValue(Fisher)</span><span class="st">`</span> <span class="sc">&lt;</span> i)</span>
<span id="cb44-45"><a href="r-function-mannual.html#cb44-45" tabindex="-1"></a>  result_paintomics_temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n=</span><span class="fu">nrow</span>(pathway_paintomics_filter),<span class="at">cutoff=</span>i)</span>
<span id="cb44-46"><a href="r-function-mannual.html#cb44-46" tabindex="-1"></a>  result_paintomics <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_paintomics,result_paintomics_temp)</span>
<span id="cb44-47"><a href="r-function-mannual.html#cb44-47" tabindex="-1"></a>}</span>
<span id="cb44-48"><a href="r-function-mannual.html#cb44-48" tabindex="-1"></a></span>
<span id="cb44-49"><a href="r-function-mannual.html#cb44-49" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_mnet_hypergeo <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>),</span>
<span id="cb44-50"><a href="r-function-mannual.html#cb44-50" tabindex="-1"></a>                result_mnet_fisher <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>),</span>
<span id="cb44-51"><a href="r-function-mannual.html#cb44-51" tabindex="-1"></a>                result_mnet_binomial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>),</span>
<span id="cb44-52"><a href="r-function-mannual.html#cb44-52" tabindex="-1"></a>                result_paintomics <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;paintomics&quot;</span>))</span>
<span id="cb44-53"><a href="r-function-mannual.html#cb44-53" tabindex="-1"></a></span>
<span id="cb44-54"><a href="r-function-mannual.html#cb44-54" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(cutoff,n))<span class="sc">+</span></span>
<span id="cb44-55"><a href="r-function-mannual.html#cb44-55" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;gray&quot;</span>,<span class="at">size=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb44-56"><a href="r-function-mannual.html#cb44-56" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color=</span>type))<span class="sc">+</span></span>
<span id="cb44-57"><a href="r-function-mannual.html#cb44-57" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="fl">0.01</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-58"><a href="r-function-mannual.html#cb44-58" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;#008080&quot;</span>))<span class="sc">+</span></span>
<span id="cb44-59"><a href="r-function-mannual.html#cb44-59" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb44-60"><a href="r-function-mannual.html#cb44-60" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb44-61"><a href="r-function-mannual.html#cb44-61" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/PaintOmics-cutoff.pdf&quot;</span>,p,<span class="at">width=</span><span class="fl">6.5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/paintomics-cutoff.png" width="349" style="display: block; margin: auto;" /></p>
</div>
<div id="venn-plot-2" class="section level4 hasAnchor" number="3.2.3.3">
<h4><span class="header-section-number">3.2.3.3</span> Venn plot<a href="r-function-mannual.html#venn-plot-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifying the agreement of different methods using Venn diagrams.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="r-function-mannual.html#cb45-1" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb45-2"><a href="r-function-mannual.html#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="r-function-mannual.html#cb45-3" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="r-function-mannual.html#cb45-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="r-function-mannual.html#cb45-5" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb45-6"><a href="r-function-mannual.html#cb45-6" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="r-function-mannual.html#cb45-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="r-function-mannual.html#cb45-8" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb45-9"><a href="r-function-mannual.html#cb45-9" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="r-function-mannual.html#cb45-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-11"><a href="r-function-mannual.html#cb45-11" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb45-12"><a href="r-function-mannual.html#cb45-12" tabindex="-1"></a></span>
<span id="cb45-13"><a href="r-function-mannual.html#cb45-13" tabindex="-1"></a><span class="do">## Running metabolite pathway analysis at PaintOmics4 website</span></span>
<span id="cb45-14"><a href="r-function-mannual.html#cb45-14" tabindex="-1"></a>pathway_paintomics <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/PaintOmics.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="r-function-mannual.html#cb45-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="r-function-mannual.html#cb45-16" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Pathway name</span><span class="st">`</span> <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb45-17"><a href="r-function-mannual.html#cb45-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Combined pValue(Fisher)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb45-18"><a href="r-function-mannual.html#cb45-18" tabindex="-1"></a></span>
<span id="cb45-19"><a href="r-function-mannual.html#cb45-19" tabindex="-1"></a>venn.plot <span class="ot">&lt;-</span> <span class="fu">venn.diagram</span>(</span>
<span id="cb45-20"><a href="r-function-mannual.html#cb45-20" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb45-21"><a href="r-function-mannual.html#cb45-21" tabindex="-1"></a>    <span class="at">MNet_hypergeo =</span> pathway_mnet_hypergeo<span class="sc">$</span>name,</span>
<span id="cb45-22"><a href="r-function-mannual.html#cb45-22" tabindex="-1"></a>    <span class="at">MNet_fisher =</span> pathway_mnet_fisher<span class="sc">$</span>name,</span>
<span id="cb45-23"><a href="r-function-mannual.html#cb45-23" tabindex="-1"></a>    <span class="at">MNet_binomial =</span> pathway_mnet_binomial<span class="sc">$</span>name,</span>
<span id="cb45-24"><a href="r-function-mannual.html#cb45-24" tabindex="-1"></a>    <span class="at">PaintOmics =</span> pathway_paintomics<span class="sc">$</span><span class="st">`</span><span class="at">Pathway name</span><span class="st">`</span>),</span>
<span id="cb45-25"><a href="r-function-mannual.html#cb45-25" tabindex="-1"></a>  <span class="at">filename =</span> <span class="cn">NULL</span>,</span>
<span id="cb45-26"><a href="r-function-mannual.html#cb45-26" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;#008080&quot;</span>),</span>
<span id="cb45-27"><a href="r-function-mannual.html#cb45-27" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.9</span>)</span>
<span id="cb45-28"><a href="r-function-mannual.html#cb45-28" tabindex="-1"></a></span>
<span id="cb45-29"><a href="r-function-mannual.html#cb45-29" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/ORA/MNet-PaintOmics-venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">7</span>,<span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb45-30"><a href="r-function-mannual.html#cb45-30" tabindex="-1"></a><span class="fu">grid.draw</span>(venn.plot)</span>
<span id="cb45-31"><a href="r-function-mannual.html#cb45-31" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figure/paintomics-venn.png" width="388" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="barplot" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Barplot<a href="r-function-mannual.html#barplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mnet-vs-tidymass" class="section level4 hasAnchor" number="3.2.4.1">
<h4><span class="header-section-number">3.2.4.1</span> MNet vs TidyMass<a href="r-function-mannual.html#mnet-vs-tidymass" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The metabolites enriched pathways by MNer and TidyMass.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="r-function-mannual.html#cb46-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb46-2"><a href="r-function-mannual.html#cb46-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-3"><a href="r-function-mannual.html#cb46-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb46-4"><a href="r-function-mannual.html#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="r-function-mannual.html#cb46-5" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="r-function-mannual.html#cb46-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="r-function-mannual.html#cb46-7" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="r-function-mannual.html#cb46-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="r-function-mannual.html#cb46-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>)</span>
<span id="cb46-10"><a href="r-function-mannual.html#cb46-10" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="r-function-mannual.html#cb46-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-12"><a href="r-function-mannual.html#cb46-12" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="r-function-mannual.html#cb46-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="r-function-mannual.html#cb46-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>)</span>
<span id="cb46-15"><a href="r-function-mannual.html#cb46-15" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet_pathway-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="r-function-mannual.html#cb46-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="r-function-mannual.html#cb46-17" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)<span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="r-function-mannual.html#cb46-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="r-function-mannual.html#cb46-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>)</span>
<span id="cb46-20"><a href="r-function-mannual.html#cb46-20" tabindex="-1"></a></span>
<span id="cb46-21"><a href="r-function-mannual.html#cb46-21" tabindex="-1"></a>pathway_tidymass_hypergeometric <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-hypergeometric.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="r-function-mannual.html#cb46-22" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="r-function-mannual.html#cb46-23" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb46-24"><a href="r-function-mannual.html#cb46-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-25"><a href="r-function-mannual.html#cb46-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway_name,p_value) <span class="sc">%&gt;%</span></span>
<span id="cb46-26"><a href="r-function-mannual.html#cb46-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;pathway_name&quot;</span>,<span class="st">&quot;pvalue&quot;</span><span class="ot">=</span><span class="st">&quot;p_value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-27"><a href="r-function-mannual.html#cb46-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;TidyMass_hypergeometric&quot;</span>)</span>
<span id="cb46-28"><a href="r-function-mannual.html#cb46-28" tabindex="-1"></a>pathway_tidymass_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/TidyMass_pathway-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-29"><a href="r-function-mannual.html#cb46-29" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="r-function-mannual.html#cb46-30" tabindex="-1"></a>  <span class="fu">filter</span>(pathway_name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="r-function-mannual.html#cb46-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-32"><a href="r-function-mannual.html#cb46-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway_name,p_value) <span class="sc">%&gt;%</span></span>
<span id="cb46-33"><a href="r-function-mannual.html#cb46-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;pathway_name&quot;</span>,<span class="st">&quot;pvalue&quot;</span><span class="ot">=</span><span class="st">&quot;p_value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-34"><a href="r-function-mannual.html#cb46-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;TidyMass_fisher&quot;</span>)</span>
<span id="cb46-35"><a href="r-function-mannual.html#cb46-35" tabindex="-1"></a></span>
<span id="cb46-36"><a href="r-function-mannual.html#cb46-36" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pathway_mnet_hypergeo,pathway_mnet_fisher,pathway_mnet_binomial,</span>
<span id="cb46-37"><a href="r-function-mannual.html#cb46-37" tabindex="-1"></a>                pathway_tidymass_hypergeometric,pathway_tidymass_fisher) <span class="sc">%&gt;%</span></span>
<span id="cb46-38"><a href="r-function-mannual.html#cb46-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb46-39"><a href="r-function-mannual.html#cb46-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(type)</span>
<span id="cb46-40"><a href="r-function-mannual.html#cb46-40" tabindex="-1"></a></span>
<span id="cb46-41"><a href="r-function-mannual.html#cb46-41" tabindex="-1"></a>result<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result<span class="sc">$</span>name)))</span>
<span id="cb46-42"><a href="r-function-mannual.html#cb46-42" tabindex="-1"></a>result<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet_hypergeo&quot;</span>,<span class="st">&quot;MNet_fisher&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span>,<span class="st">&quot;TidyMass_hypergeometric&quot;</span>,<span class="st">&quot;TidyMass_fisher&quot;</span>))</span>
<span id="cb46-43"><a href="r-function-mannual.html#cb46-43" tabindex="-1"></a></span>
<span id="cb46-44"><a href="r-function-mannual.html#cb46-44" tabindex="-1"></a>p_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue))) <span class="sc">+</span></span>
<span id="cb46-45"><a href="r-function-mannual.html#cb46-45" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>type),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb46-46"><a href="r-function-mannual.html#cb46-46" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;MNet_fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;MNet_hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span><span class="ot">=</span><span class="st">&quot;#F3B169&quot;</span>,                       <span class="st">&quot;TidyMass_hypergeometric&quot;</span><span class="ot">=</span><span class="st">&quot;#589FF3&quot;</span>,<span class="st">&quot;TidyMass_fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#37AB78&quot;</span>),<span class="at">name=</span><span class="st">&quot;Method&quot;</span>)<span class="sc">+</span></span>
<span id="cb46-47"><a href="r-function-mannual.html#cb46-47" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)<span class="sc">+</span></span>
<span id="cb46-48"><a href="r-function-mannual.html#cb46-48" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb46-49"><a href="r-function-mannual.html#cb46-49" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb46-50"><a href="r-function-mannual.html#cb46-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/MNet_TidyMass_barplot.pdf&quot;</span>,p_all,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="figure/tidymass-barplot.png" width="1066" style="display: block; margin: auto;" /></p>
</div>
<div id="mnet-vs-clusterprofiler" class="section level4 hasAnchor" number="3.2.4.2">
<h4><span class="header-section-number">3.2.4.2</span> MNet vs clusterProfiler<a href="r-function-mannual.html#mnet-vs-clusterprofiler" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The genes enriched pathways by MNwt and clusterProfiler.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="r-function-mannual.html#cb47-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-2"><a href="r-function-mannual.html#cb47-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-3"><a href="r-function-mannual.html#cb47-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb47-4"><a href="r-function-mannual.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="r-function-mannual.html#cb47-5" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="r-function-mannual.html#cb47-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="r-function-mannual.html#cb47-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="r-function-mannual.html#cb47-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="r-function-mannual.html#cb47-9" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb47-10"><a href="r-function-mannual.html#cb47-10" tabindex="-1"></a></span>
<span id="cb47-11"><a href="r-function-mannual.html#cb47-11" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="r-function-mannual.html#cb47-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="r-function-mannual.html#cb47-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="r-function-mannual.html#cb47-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="r-function-mannual.html#cb47-15" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb47-16"><a href="r-function-mannual.html#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="r-function-mannual.html#cb47-17" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-gene_binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="r-function-mannual.html#cb47-18" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-19"><a href="r-function-mannual.html#cb47-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb47-20"><a href="r-function-mannual.html#cb47-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-21"><a href="r-function-mannual.html#cb47-21" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb47-22"><a href="r-function-mannual.html#cb47-22" tabindex="-1"></a></span>
<span id="cb47-23"><a href="r-function-mannual.html#cb47-23" tabindex="-1"></a>pathway_clusterprofiler <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/clusterprofiler-gene-F.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-24"><a href="r-function-mannual.html#cb47-24" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-25"><a href="r-function-mannual.html#cb47-25" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayid) <span class="sc">%&gt;%</span></span>
<span id="cb47-26"><a href="r-function-mannual.html#cb47-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Description,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb47-27"><a href="r-function-mannual.html#cb47-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Description&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-28"><a href="r-function-mannual.html#cb47-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;clusterprofiler&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-29"><a href="r-function-mannual.html#cb47-29" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb47-30"><a href="r-function-mannual.html#cb47-30" tabindex="-1"></a></span>
<span id="cb47-31"><a href="r-function-mannual.html#cb47-31" tabindex="-1"></a>pathway_all_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pathway_clusterprofiler,pathway_mnet_hypergeo,</span>
<span id="cb47-32"><a href="r-function-mannual.html#cb47-32" tabindex="-1"></a>                            pathway_mnet_fisher,pathway_mnet_binomial) <span class="sc">%&gt;%</span></span>
<span id="cb47-33"><a href="r-function-mannual.html#cb47-33" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-34"><a href="r-function-mannual.html#cb47-34" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb47-35"><a href="r-function-mannual.html#cb47-35" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(type,<span class="fu">c</span>(<span class="st">&quot;clusterprofiler&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span>,<span class="st">&quot;MNet_fisher&quot;</span>,<span class="st">&quot;MNet_hypergeo&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb47-36"><a href="r-function-mannual.html#cb47-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name,<span class="at">levels=</span><span class="fu">unique</span>(name)))</span>
<span id="cb47-37"><a href="r-function-mannual.html#cb47-37" tabindex="-1"></a></span>
<span id="cb47-38"><a href="r-function-mannual.html#cb47-38" tabindex="-1"></a>pathway_all_filter<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(pathway_all_filter<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet_hypergeo&quot;</span>,<span class="st">&quot;MNet_fisher&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span>,<span class="st">&quot;clusterprofiler&quot;</span>))</span>
<span id="cb47-39"><a href="r-function-mannual.html#cb47-39" tabindex="-1"></a></span>
<span id="cb47-40"><a href="r-function-mannual.html#cb47-40" tabindex="-1"></a>p_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pathway_all_filter,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue),<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb47-41"><a href="r-function-mannual.html#cb47-41" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb47-42"><a href="r-function-mannual.html#cb47-42" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;MNet_fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;MNet_hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span><span class="ot">=</span><span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;clusterprofiler&quot;</span><span class="ot">=</span><span class="st">&quot;#AA66EB&quot;</span>))<span class="sc">+</span></span>
<span id="cb47-43"><a href="r-function-mannual.html#cb47-43" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb47-44"><a href="r-function-mannual.html#cb47-44" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)<span class="sc">+</span></span>
<span id="cb47-45"><a href="r-function-mannual.html#cb47-45" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb47-46"><a href="r-function-mannual.html#cb47-46" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/MNet_clusterprofiler_barplot.pdf&quot;</span>,p_all,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p><img src="figure/cluster-barplot.png" width="988" style="display: block; margin: auto;" /></p>
</div>
<div id="mnet-vs-paintomics" class="section level4 hasAnchor" number="3.2.4.3">
<h4><span class="header-section-number">3.2.4.3</span> MNet vs PaintOmics<a href="r-function-mannual.html#mnet-vs-paintomics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The extended enriched pathways by MNet and PaintOmics4.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="r-function-mannual.html#cb48-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb48-2"><a href="r-function-mannual.html#cb48-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-3"><a href="r-function-mannual.html#cb48-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb48-4"><a href="r-function-mannual.html#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="r-function-mannual.html#cb48-5" tabindex="-1"></a>pathway_mnet_hypergeo <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-hypergeo.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="r-function-mannual.html#cb48-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="r-function-mannual.html#cb48-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="r-function-mannual.html#cb48-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_hypergeo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="r-function-mannual.html#cb48-9" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb48-10"><a href="r-function-mannual.html#cb48-10" tabindex="-1"></a>pathway_mnet_fisher <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-fisher.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="r-function-mannual.html#cb48-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="r-function-mannual.html#cb48-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="r-function-mannual.html#cb48-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_fisher&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="r-function-mannual.html#cb48-14" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb48-15"><a href="r-function-mannual.html#cb48-15" tabindex="-1"></a>pathway_mnet_binomial <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/MNet-Extended-binomial.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="r-function-mannual.html#cb48-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="r-function-mannual.html#cb48-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb48-18"><a href="r-function-mannual.html#cb48-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;MNet_binomial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="r-function-mannual.html#cb48-19" tabindex="-1"></a>  <span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb48-20"><a href="r-function-mannual.html#cb48-20" tabindex="-1"></a></span>
<span id="cb48-21"><a href="r-function-mannual.html#cb48-21" tabindex="-1"></a><span class="do">## Running metabolite pathway analysis at paintomics website</span></span>
<span id="cb48-22"><a href="r-function-mannual.html#cb48-22" tabindex="-1"></a>pathway_paintomics <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/ORA/PaintOmics.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-23"><a href="r-function-mannual.html#cb48-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb48-24"><a href="r-function-mannual.html#cb48-24" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Pathway name</span><span class="st">`</span> <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb48-25"><a href="r-function-mannual.html#cb48-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Pathway name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-26"><a href="r-function-mannual.html#cb48-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Combined pValue(Fisher)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-27"><a href="r-function-mannual.html#cb48-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pvalue&quot;</span><span class="ot">=</span><span class="st">&quot;Combined pValue(Fisher)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-28"><a href="r-function-mannual.html#cb48-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;PaintOmics&quot;</span>) </span>
<span id="cb48-29"><a href="r-function-mannual.html#cb48-29" tabindex="-1"></a></span>
<span id="cb48-30"><a href="r-function-mannual.html#cb48-30" tabindex="-1"></a>pathway_all_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pathway_paintomics,pathway_mnet_hypergeo,</span>
<span id="cb48-31"><a href="r-function-mannual.html#cb48-31" tabindex="-1"></a>                            pathway_mnet_fisher,pathway_mnet_binomial) <span class="sc">%&gt;%</span></span>
<span id="cb48-32"><a href="r-function-mannual.html#cb48-32" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-33"><a href="r-function-mannual.html#cb48-33" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(type,<span class="fu">c</span>(<span class="st">&quot;paintomics&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span>,<span class="st">&quot;MNet_fisher&quot;</span>,<span class="st">&quot;MNet_hypergeo&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb48-34"><a href="r-function-mannual.html#cb48-34" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb48-35"><a href="r-function-mannual.html#cb48-35" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name,<span class="at">levels=</span><span class="fu">unique</span>(name)))</span>
<span id="cb48-36"><a href="r-function-mannual.html#cb48-36" tabindex="-1"></a></span>
<span id="cb48-37"><a href="r-function-mannual.html#cb48-37" tabindex="-1"></a>pathway_all_filter<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(pathway_all_filter<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet_hypergeo&quot;</span>,<span class="st">&quot;MNet_fisher&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span>,<span class="st">&quot;paintomics&quot;</span>))</span>
<span id="cb48-38"><a href="r-function-mannual.html#cb48-38" tabindex="-1"></a></span>
<span id="cb48-39"><a href="r-function-mannual.html#cb48-39" tabindex="-1"></a>p_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pathway_all_filter,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue),<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb48-40"><a href="r-function-mannual.html#cb48-40" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-41"><a href="r-function-mannual.html#cb48-41" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;MNet_fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;MNet_hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;MNet_binomial&quot;</span><span class="ot">=</span><span class="st">&quot;#F3B169&quot;</span>,<span class="st">&quot;paintomics&quot;</span><span class="ot">=</span><span class="st">&quot;#008080&quot;</span>))<span class="sc">+</span></span>
<span id="cb48-42"><a href="r-function-mannual.html#cb48-42" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb48-43"><a href="r-function-mannual.html#cb48-43" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)<span class="sc">+</span></span>
<span id="cb48-44"><a href="r-function-mannual.html#cb48-44" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb48-45"><a href="r-function-mannual.html#cb48-45" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/ORA/MNet_extended_barplot.pdf&quot;</span>,p_all,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="figure/paintomics-barplot.png" width="1058" style="display: block; margin: auto;" /></p>
</div>
<div id="runtime" class="section level4 hasAnchor" number="3.2.4.4">
<h4><span class="header-section-number">3.2.4.4</span> Runtime<a href="r-function-mannual.html#runtime" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comparison of running time between different software.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="r-function-mannual.html#cb49-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-2"><a href="r-function-mannual.html#cb49-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb49-3"><a href="r-function-mannual.html#cb49-3" tabindex="-1"></a><span class="fu">library</span>(tidymass)</span>
<span id="cb49-4"><a href="r-function-mannual.html#cb49-4" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span>
<span id="cb49-5"><a href="r-function-mannual.html#cb49-5" tabindex="-1"></a><span class="fu">library</span>(KEGG.db)</span>
<span id="cb49-6"><a href="r-function-mannual.html#cb49-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-7"><a href="r-function-mannual.html#cb49-7" tabindex="-1"></a></span>
<span id="cb49-8"><a href="r-function-mannual.html#cb49-8" tabindex="-1"></a><span class="do">## Metabolite</span></span>
<span id="cb49-9"><a href="r-function-mannual.html#cb49-9" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb49-10"><a href="r-function-mannual.html#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="r-function-mannual.html#cb49-11" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="r-function-mannual.html#cb49-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-13"><a href="r-function-mannual.html#cb49-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb49-14"><a href="r-function-mannual.html#cb49-14" tabindex="-1"></a></span>
<span id="cb49-15"><a href="r-function-mannual.html#cb49-15" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;kegg_hsa_pathway&quot;</span>, <span class="at">package =</span> <span class="st">&quot;metpath&quot;</span>)</span>
<span id="cb49-16"><a href="r-function-mannual.html#cb49-16" tabindex="-1"></a>pathway_database <span class="ot">=</span> kegg_hsa_pathway</span>
<span id="cb49-17"><a href="r-function-mannual.html#cb49-17" tabindex="-1"></a></span>
<span id="cb49-18"><a href="r-function-mannual.html#cb49-18" tabindex="-1"></a><span class="do">### MNet-hypergeo</span></span>
<span id="cb49-19"><a href="r-function-mannual.html#cb49-19" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-20"><a href="r-function-mannual.html#cb49-20" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb49-21"><a href="r-function-mannual.html#cb49-21" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-22"><a href="r-function-mannual.html#cb49-22" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-23"><a href="r-function-mannual.html#cb49-23" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-hypergeo_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-24"><a href="r-function-mannual.html#cb49-24" tabindex="-1"></a></span>
<span id="cb49-25"><a href="r-function-mannual.html#cb49-25" tabindex="-1"></a><span class="do">### MNet-fisher</span></span>
<span id="cb49-26"><a href="r-function-mannual.html#cb49-26" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-27"><a href="r-function-mannual.html#cb49-27" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb49-28"><a href="r-function-mannual.html#cb49-28" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-29"><a href="r-function-mannual.html#cb49-29" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-30"><a href="r-function-mannual.html#cb49-30" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-fisher—_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-31"><a href="r-function-mannual.html#cb49-31" tabindex="-1"></a></span>
<span id="cb49-32"><a href="r-function-mannual.html#cb49-32" tabindex="-1"></a><span class="do">### MNet-binomial</span></span>
<span id="cb49-33"><a href="r-function-mannual.html#cb49-33" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-34"><a href="r-function-mannual.html#cb49-34" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb49-35"><a href="r-function-mannual.html#cb49-35" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-36"><a href="r-function-mannual.html#cb49-36" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-37"><a href="r-function-mannual.html#cb49-37" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-binomial_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-38"><a href="r-function-mannual.html#cb49-38" tabindex="-1"></a></span>
<span id="cb49-39"><a href="r-function-mannual.html#cb49-39" tabindex="-1"></a><span class="do">### Tidymass-hypergeometric</span></span>
<span id="cb49-40"><a href="r-function-mannual.html#cb49-40" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-41"><a href="r-function-mannual.html#cb49-41" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">enrich_kegg</span>(<span class="at">query_id =</span> diff_meta<span class="sc">$</span>name,</span>
<span id="cb49-42"><a href="r-function-mannual.html#cb49-42" tabindex="-1"></a>                      <span class="at">query_type =</span> <span class="st">&quot;compound&quot;</span>,</span>
<span id="cb49-43"><a href="r-function-mannual.html#cb49-43" tabindex="-1"></a>                      <span class="at">id_type =</span> <span class="st">&quot;KEGG&quot;</span>,<span class="at">method =</span> <span class="st">&quot;hypergeometric&quot;</span>,</span>
<span id="cb49-44"><a href="r-function-mannual.html#cb49-44" tabindex="-1"></a>                      <span class="at">pathway_database =</span> pathway_database,</span>
<span id="cb49-45"><a href="r-function-mannual.html#cb49-45" tabindex="-1"></a>                      <span class="at">p_cutoff =</span> <span class="fl">1.1</span>,</span>
<span id="cb49-46"><a href="r-function-mannual.html#cb49-46" tabindex="-1"></a>                      <span class="at">p_adjust_method =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb49-47"><a href="r-function-mannual.html#cb49-47" tabindex="-1"></a>                      <span class="at">threads =</span> <span class="dv">10</span>)</span>
<span id="cb49-48"><a href="r-function-mannual.html#cb49-48" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-49"><a href="r-function-mannual.html#cb49-49" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-50"><a href="r-function-mannual.html#cb49-50" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-Tidymass-hypergeometric_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-51"><a href="r-function-mannual.html#cb49-51" tabindex="-1"></a></span>
<span id="cb49-52"><a href="r-function-mannual.html#cb49-52" tabindex="-1"></a><span class="do">### Tidymass-fisher</span></span>
<span id="cb49-53"><a href="r-function-mannual.html#cb49-53" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-54"><a href="r-function-mannual.html#cb49-54" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">enrich_kegg</span>(<span class="at">query_id =</span> diff_meta<span class="sc">$</span>name,</span>
<span id="cb49-55"><a href="r-function-mannual.html#cb49-55" tabindex="-1"></a>                      <span class="at">query_type =</span> <span class="st">&quot;compound&quot;</span>,</span>
<span id="cb49-56"><a href="r-function-mannual.html#cb49-56" tabindex="-1"></a>                      <span class="at">id_type =</span> <span class="st">&quot;KEGG&quot;</span>,<span class="at">method =</span> <span class="st">&quot;fisher&quot;</span>,</span>
<span id="cb49-57"><a href="r-function-mannual.html#cb49-57" tabindex="-1"></a>                      <span class="at">pathway_database =</span> pathway_database,</span>
<span id="cb49-58"><a href="r-function-mannual.html#cb49-58" tabindex="-1"></a>                      <span class="at">p_cutoff =</span> <span class="fl">1.1</span>,</span>
<span id="cb49-59"><a href="r-function-mannual.html#cb49-59" tabindex="-1"></a>                      <span class="at">p_adjust_method =</span> <span class="st">&quot;BH&quot;</span>,</span>
<span id="cb49-60"><a href="r-function-mannual.html#cb49-60" tabindex="-1"></a>                      <span class="at">threads =</span> <span class="dv">10</span>)</span>
<span id="cb49-61"><a href="r-function-mannual.html#cb49-61" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-62"><a href="r-function-mannual.html#cb49-62" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-63"><a href="r-function-mannual.html#cb49-63" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-Tidymass-fisher_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-64"><a href="r-function-mannual.html#cb49-64" tabindex="-1"></a></span>
<span id="cb49-65"><a href="r-function-mannual.html#cb49-65" tabindex="-1"></a><span class="do">## Gene</span></span>
<span id="cb49-66"><a href="r-function-mannual.html#cb49-66" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb49-67"><a href="r-function-mannual.html#cb49-67" tabindex="-1"></a></span>
<span id="cb49-68"><a href="r-function-mannual.html#cb49-68" tabindex="-1"></a>gene_filter <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb49-69"><a href="r-function-mannual.html#cb49-69" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-70"><a href="r-function-mannual.html#cb49-70" tabindex="-1"></a>  <span class="fu">pull</span>(name) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb49-71"><a href="r-function-mannual.html#cb49-71" tabindex="-1"></a></span>
<span id="cb49-72"><a href="r-function-mannual.html#cb49-72" tabindex="-1"></a>diff_gene_all <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb49-73"><a href="r-function-mannual.html#cb49-73" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-74"><a href="r-function-mannual.html#cb49-74" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb49-75"><a href="r-function-mannual.html#cb49-75" tabindex="-1"></a></span>
<span id="cb49-76"><a href="r-function-mannual.html#cb49-76" tabindex="-1"></a>gene.data <span class="ot">&lt;-</span> clusterProfiler<span class="sc">::</span><span class="fu">bitr</span>(diff_gene_all<span class="sc">$</span>name,<span class="at">fromType =</span> <span class="st">&quot;SYMBOL&quot;</span>,<span class="at">toType =</span><span class="st">&quot;ENTREZID&quot;</span>,<span class="at">OrgDb=</span><span class="st">&#39;org.Hs.eg.db&#39;</span>)</span>
<span id="cb49-77"><a href="r-function-mannual.html#cb49-77" tabindex="-1"></a></span>
<span id="cb49-78"><a href="r-function-mannual.html#cb49-78" tabindex="-1"></a>diff_gene_clusterprofiler <span class="ot">&lt;-</span> diff_gene_all <span class="sc">%&gt;%</span></span>
<span id="cb49-79"><a href="r-function-mannual.html#cb49-79" tabindex="-1"></a>  <span class="fu">inner_join</span>(gene.data,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;SYMBOL&quot;</span>))</span>
<span id="cb49-80"><a href="r-function-mannual.html#cb49-80" tabindex="-1"></a></span>
<span id="cb49-81"><a href="r-function-mannual.html#cb49-81" tabindex="-1"></a>diff_gene_mnet <span class="ot">&lt;-</span> diff_gene_all <span class="sc">%&gt;%</span></span>
<span id="cb49-82"><a href="r-function-mannual.html#cb49-82" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> gene_filter)</span>
<span id="cb49-83"><a href="r-function-mannual.html#cb49-83" tabindex="-1"></a></span>
<span id="cb49-84"><a href="r-function-mannual.html#cb49-84" tabindex="-1"></a><span class="do">### MNet-hypergeo</span></span>
<span id="cb49-85"><a href="r-function-mannual.html#cb49-85" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-86"><a href="r-function-mannual.html#cb49-86" tabindex="-1"></a>gene_MNet_result_hypergeo <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb49-87"><a href="r-function-mannual.html#cb49-87" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-88"><a href="r-function-mannual.html#cb49-88" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-89"><a href="r-function-mannual.html#cb49-89" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-hypergeo_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-90"><a href="r-function-mannual.html#cb49-90" tabindex="-1"></a></span>
<span id="cb49-91"><a href="r-function-mannual.html#cb49-91" tabindex="-1"></a><span class="do">### MNet-fisher</span></span>
<span id="cb49-92"><a href="r-function-mannual.html#cb49-92" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-93"><a href="r-function-mannual.html#cb49-93" tabindex="-1"></a>gene_MNet_result_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb49-94"><a href="r-function-mannual.html#cb49-94" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-95"><a href="r-function-mannual.html#cb49-95" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-96"><a href="r-function-mannual.html#cb49-96" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-fisher_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-97"><a href="r-function-mannual.html#cb49-97" tabindex="-1"></a></span>
<span id="cb49-98"><a href="r-function-mannual.html#cb49-98" tabindex="-1"></a><span class="do">### MNet-binomial</span></span>
<span id="cb49-99"><a href="r-function-mannual.html#cb49-99" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-100"><a href="r-function-mannual.html#cb49-100" tabindex="-1"></a>gene_MNet_result_binomial <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_mnet<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb49-101"><a href="r-function-mannual.html#cb49-101" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-102"><a href="r-function-mannual.html#cb49-102" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-103"><a href="r-function-mannual.html#cb49-103" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MT-MNet-binomial_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-104"><a href="r-function-mannual.html#cb49-104" tabindex="-1"></a></span>
<span id="cb49-105"><a href="r-function-mannual.html#cb49-105" tabindex="-1"></a><span class="do">### clusterProfiler</span></span>
<span id="cb49-106"><a href="r-function-mannual.html#cb49-106" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-107"><a href="r-function-mannual.html#cb49-107" tabindex="-1"></a>kegg_F <span class="ot">&lt;-</span> <span class="fu">enrichKEGG</span>(</span>
<span id="cb49-108"><a href="r-function-mannual.html#cb49-108" tabindex="-1"></a>  <span class="at">gene =</span> diff_gene_clusterprofiler<span class="sc">$</span>ENTREZID,</span>
<span id="cb49-109"><a href="r-function-mannual.html#cb49-109" tabindex="-1"></a>  <span class="at">keyType =</span> <span class="st">&#39;kegg&#39;</span>,</span>
<span id="cb49-110"><a href="r-function-mannual.html#cb49-110" tabindex="-1"></a>  <span class="at">organism =</span> <span class="st">&#39;hsa&#39;</span>,</span>
<span id="cb49-111"><a href="r-function-mannual.html#cb49-111" tabindex="-1"></a>  <span class="at">minGSSize =</span> <span class="dv">1</span>,</span>
<span id="cb49-112"><a href="r-function-mannual.html#cb49-112" tabindex="-1"></a>  <span class="at">pAdjustMethod =</span> <span class="st">&#39;BH&#39;</span>,</span>
<span id="cb49-113"><a href="r-function-mannual.html#cb49-113" tabindex="-1"></a>  <span class="at">pvalueCutoff =</span> <span class="fl">1.1</span>,</span>
<span id="cb49-114"><a href="r-function-mannual.html#cb49-114" tabindex="-1"></a>  <span class="at">use_internal_data =</span> F)</span>
<span id="cb49-115"><a href="r-function-mannual.html#cb49-115" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-116"><a href="r-function-mannual.html#cb49-116" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-117"><a href="r-function-mannual.html#cb49-117" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MC-Clusterprofiler-F_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-118"><a href="r-function-mannual.html#cb49-118" tabindex="-1"></a></span>
<span id="cb49-119"><a href="r-function-mannual.html#cb49-119" tabindex="-1"></a><span class="do">## Extend</span></span>
<span id="cb49-120"><a href="r-function-mannual.html#cb49-120" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb49-121"><a href="r-function-mannual.html#cb49-121" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb49-122"><a href="r-function-mannual.html#cb49-122" tabindex="-1"></a><span class="do">### Filter the increase differential genes and metabolites</span></span>
<span id="cb49-123"><a href="r-function-mannual.html#cb49-123" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb49-124"><a href="r-function-mannual.html#cb49-124" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-125"><a href="r-function-mannual.html#cb49-125" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb49-126"><a href="r-function-mannual.html#cb49-126" tabindex="-1"></a></span>
<span id="cb49-127"><a href="r-function-mannual.html#cb49-127" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb49-128"><a href="r-function-mannual.html#cb49-128" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb49-129"><a href="r-function-mannual.html#cb49-129" tabindex="-1"></a><span class="do">## Filter the increase differential genes and metabolites</span></span>
<span id="cb49-130"><a href="r-function-mannual.html#cb49-130" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb49-131"><a href="r-function-mannual.html#cb49-131" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-132"><a href="r-function-mannual.html#cb49-132" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb49-133"><a href="r-function-mannual.html#cb49-133" tabindex="-1"></a></span>
<span id="cb49-134"><a href="r-function-mannual.html#cb49-134" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_meta,diff_gene) <span class="sc">%&gt;%</span></span>
<span id="cb49-135"><a href="r-function-mannual.html#cb49-135" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name)</span>
<span id="cb49-136"><a href="r-function-mannual.html#cb49-136" tabindex="-1"></a></span>
<span id="cb49-137"><a href="r-function-mannual.html#cb49-137" tabindex="-1"></a><span class="do">### MNet-hypergeo</span></span>
<span id="cb49-138"><a href="r-function-mannual.html#cb49-138" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-139"><a href="r-function-mannual.html#cb49-139" tabindex="-1"></a>result_pathway_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb49-140"><a href="r-function-mannual.html#cb49-140" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-141"><a href="r-function-mannual.html#cb49-141" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-142"><a href="r-function-mannual.html#cb49-142" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MP-MNet-hypergeo_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-143"><a href="r-function-mannual.html#cb49-143" tabindex="-1"></a></span>
<span id="cb49-144"><a href="r-function-mannual.html#cb49-144" tabindex="-1"></a><span class="do">### MNet-fisher</span></span>
<span id="cb49-145"><a href="r-function-mannual.html#cb49-145" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-146"><a href="r-function-mannual.html#cb49-146" tabindex="-1"></a>result_pathway_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;fisher&quot;</span>)</span>
<span id="cb49-147"><a href="r-function-mannual.html#cb49-147" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-148"><a href="r-function-mannual.html#cb49-148" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-149"><a href="r-function-mannual.html#cb49-149" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MP-MNet-fisher_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-150"><a href="r-function-mannual.html#cb49-150" tabindex="-1"></a></span>
<span id="cb49-151"><a href="r-function-mannual.html#cb49-151" tabindex="-1"></a><span class="do">### MNet-binomial</span></span>
<span id="cb49-152"><a href="r-function-mannual.html#cb49-152" tabindex="-1"></a>time_start <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-153"><a href="r-function-mannual.html#cb49-153" tabindex="-1"></a>result_pathway_fisher <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(result<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.1</span>,<span class="at">test=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb49-154"><a href="r-function-mannual.html#cb49-154" tabindex="-1"></a>time_end <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb49-155"><a href="r-function-mannual.html#cb49-155" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(time_end, time_start, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>)</span>
<span id="cb49-156"><a href="r-function-mannual.html#cb49-156" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;MP-MNet-binomial_code execution time:&quot;</span>, <span class="fu">round</span>(run_time, <span class="dv">2</span>), <span class="st">&quot;second&quot;</span>))</span>
<span id="cb49-157"><a href="r-function-mannual.html#cb49-157" tabindex="-1"></a></span>
<span id="cb49-158"><a href="r-function-mannual.html#cb49-158" tabindex="-1"></a><span class="do">### PaintOmics4</span></span>
<span id="cb49-159"><a href="r-function-mannual.html#cb49-159" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;MP-PaintOmics4_code execution time: 228.71 second&quot;</span>)</span>
<span id="cb49-160"><a href="r-function-mannual.html#cb49-160" tabindex="-1"></a></span>
<span id="cb49-161"><a href="r-function-mannual.html#cb49-161" tabindex="-1"></a><span class="do">## Barplot</span></span>
<span id="cb49-162"><a href="r-function-mannual.html#cb49-162" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-163"><a href="r-function-mannual.html#cb49-163" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">1.34</span>,<span class="fl">0.45</span>,<span class="fl">0.41</span>,<span class="fl">164.88</span>,<span class="fl">161.44</span>,<span class="fl">0.52</span>,<span class="fl">0.49</span>,<span class="fl">0.49</span>,<span class="fl">6.16</span>,<span class="fl">0.52</span>,<span class="fl">0.57</span>,<span class="fl">0.5</span>,<span class="fl">228.71</span>),</span>
<span id="cb49-164"><a href="r-function-mannual.html#cb49-164" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;MNet-hypergeo&quot;</span>,<span class="st">&quot;MNet-fisher&quot;</span>,<span class="st">&quot;MNet-binomial&quot;</span>,<span class="st">&quot;TidyMass-hypergeo&quot;</span>,<span class="st">&quot;TidyMass-fisher&quot;</span>,<span class="st">&quot;MNet-hypergeo&quot;</span>,<span class="st">&quot;MNet-fisher&quot;</span>,<span class="st">&quot;MNet-binomial&quot;</span>,<span class="st">&quot;Clusterprofiler&quot;</span>,<span class="st">&quot;MNet-hypergeo&quot;</span>,<span class="st">&quot;MNet-fisher&quot;</span>,<span class="st">&quot;MNet-binomial&quot;</span>,<span class="st">&quot;PaintOmics4&quot;</span>),</span>
<span id="cb49-165"><a href="r-function-mannual.html#cb49-165" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Metabolite&quot;</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">&quot;Gene&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;Extend&quot;</span>,<span class="dv">4</span>)))</span>
<span id="cb49-166"><a href="r-function-mannual.html#cb49-166" tabindex="-1"></a>dat<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Metabolite&quot;</span>,<span class="st">&quot;Gene&quot;</span>,<span class="st">&quot;Extend&quot;</span>))</span>
<span id="cb49-167"><a href="r-function-mannual.html#cb49-167" tabindex="-1"></a>dat<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>x,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;MNet-hypergeo&quot;</span>,<span class="st">&quot;MNet-fisher&quot;</span>,<span class="st">&quot;MNet-binomial&quot;</span>,<span class="st">&quot;TidyMass-hypergeo&quot;</span>,<span class="st">&quot;TidyMass-fisher&quot;</span>,<span class="st">&quot;Clusterprofiler&quot;</span>,<span class="st">&quot;PaintOmics4&quot;</span>))</span>
<span id="cb49-168"><a href="r-function-mannual.html#cb49-168" tabindex="-1"></a></span>
<span id="cb49-169"><a href="r-function-mannual.html#cb49-169" tabindex="-1"></a>corlor <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb49-170"><a href="r-function-mannual.html#cb49-170" tabindex="-1"></a>  <span class="st">&quot;MNet-fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,</span>
<span id="cb49-171"><a href="r-function-mannual.html#cb49-171" tabindex="-1"></a>  <span class="st">&quot;MNet-hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,</span>
<span id="cb49-172"><a href="r-function-mannual.html#cb49-172" tabindex="-1"></a>  <span class="st">&quot;MNet-binomial&quot;</span><span class="ot">=</span><span class="st">&quot;#F3B169&quot;</span>,</span>
<span id="cb49-173"><a href="r-function-mannual.html#cb49-173" tabindex="-1"></a>  <span class="st">&quot;TidyMass-hypergeo&quot;</span><span class="ot">=</span><span class="st">&quot;#589FF3&quot;</span>,</span>
<span id="cb49-174"><a href="r-function-mannual.html#cb49-174" tabindex="-1"></a>  <span class="st">&quot;TidyMass-fisher&quot;</span><span class="ot">=</span><span class="st">&quot;#37AB78&quot;</span>,</span>
<span id="cb49-175"><a href="r-function-mannual.html#cb49-175" tabindex="-1"></a>  <span class="st">&quot;Clusterprofiler&quot;</span><span class="ot">=</span><span class="st">&quot;#AA66EB&quot;</span>,</span>
<span id="cb49-176"><a href="r-function-mannual.html#cb49-176" tabindex="-1"></a>  <span class="st">&quot;PaintOmics4&quot;</span><span class="ot">=</span><span class="st">&quot;#008080&quot;</span>)</span>
<span id="cb49-177"><a href="r-function-mannual.html#cb49-177" tabindex="-1"></a></span>
<span id="cb49-178"><a href="r-function-mannual.html#cb49-178" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> x)) <span class="sc">+</span></span>
<span id="cb49-179"><a href="r-function-mannual.html#cb49-179" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-180"><a href="r-function-mannual.html#cb49-180" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> corlor) <span class="sc">+</span></span>
<span id="cb49-181"><a href="r-function-mannual.html#cb49-181" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-182"><a href="r-function-mannual.html#cb49-182" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group,<span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-183"><a href="r-function-mannual.html#cb49-183" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Runtime (second)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Software Name&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-184"><a href="r-function-mannual.html#cb49-184" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb49-185"><a href="r-function-mannual.html#cb49-185" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Runtime_comparison.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="figure/runtime.png" width="516" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="performance-evaluation-for-gsea" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Performance evaluation for GSEA<a href="r-function-mannual.html#performance-evaluation-for-gsea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mnet" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> MNet<a href="r-function-mannual.html#mnet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Analyzing metabolites and metabolite-related genes data using MNet and using different method parameters.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="r-function-mannual.html#cb50-1" tabindex="-1"></a><span class="fu">library</span>(multiGSEA)</span>
<span id="cb50-2"><a href="r-function-mannual.html#cb50-2" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span>
<span id="cb50-3"><a href="r-function-mannual.html#cb50-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb50-4"><a href="r-function-mannual.html#cb50-4" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb50-5"><a href="r-function-mannual.html#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="r-function-mannual.html#cb50-6" tabindex="-1"></a><span class="fu">data</span>(transcriptome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb50-7"><a href="r-function-mannual.html#cb50-7" tabindex="-1"></a><span class="fu">data</span>(metabolome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb50-8"><a href="r-function-mannual.html#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="r-function-mannual.html#cb50-9" tabindex="-1"></a>ah <span class="ot">&lt;-</span> AnnotationHub<span class="sc">::</span><span class="fu">AnnotationHub</span>()</span>
<span id="cb50-10"><a href="r-function-mannual.html#cb50-10" tabindex="-1"></a>aa <span class="ot">&lt;-</span> ah[[<span class="st">&quot;AH91792&quot;</span>]]</span>
<span id="cb50-11"><a href="r-function-mannual.html#cb50-11" tabindex="-1"></a>metabolome_1 <span class="ot">&lt;-</span> metabolome <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="r-function-mannual.html#cb50-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HMDB=</span><span class="fu">gsub</span>(<span class="st">&quot;HMDB&quot;</span>,<span class="st">&quot;HMDB00&quot;</span>,HMDB)) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="r-function-mannual.html#cb50-13" tabindex="-1"></a>  <span class="fu">left_join</span>(aa,<span class="at">by=</span><span class="st">&quot;HMDB&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="r-function-mannual.html#cb50-14" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG)) <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="r-function-mannual.html#cb50-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="r-function-mannual.html#cb50-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HMDB,logFC,pValue,KEGG,HMDB) <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="r-function-mannual.html#cb50-17" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-18"><a href="r-function-mannual.html#cb50-18" tabindex="-1"></a>  <span class="fu">filter</span>(KEGG <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb50-19"><a href="r-function-mannual.html#cb50-19" tabindex="-1"></a>  <span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb50-20"><a href="r-function-mannual.html#cb50-20" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb50-21"><a href="r-function-mannual.html#cb50-21" tabindex="-1"></a>  <span class="fu">distinct</span>(logFC,<span class="at">.keep_all =</span> T)</span>
<span id="cb50-22"><a href="r-function-mannual.html#cb50-22" tabindex="-1"></a></span>
<span id="cb50-23"><a href="r-function-mannual.html#cb50-23" tabindex="-1"></a>dat_metabolome <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>logFC</span>
<span id="cb50-24"><a href="r-function-mannual.html#cb50-24" tabindex="-1"></a><span class="fu">names</span>(dat_metabolome) <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>KEGG</span>
<span id="cb50-25"><a href="r-function-mannual.html#cb50-25" tabindex="-1"></a></span>
<span id="cb50-26"><a href="r-function-mannual.html#cb50-26" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-27"><a href="r-function-mannual.html#cb50-27" tabindex="-1"></a>result_metabolome <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(dat_metabolome,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">gseaParam=</span><span class="dv">1</span>,<span class="at">nPermSimple=</span><span class="dv">1000</span>)</span>
<span id="cb50-28"><a href="r-function-mannual.html#cb50-28" tabindex="-1"></a></span>
<span id="cb50-29"><a href="r-function-mannual.html#cb50-29" tabindex="-1"></a>transcriptome_temp <span class="ot">&lt;-</span> transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb50-30"><a href="r-function-mannual.html#cb50-30" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-31"><a href="r-function-mannual.html#cb50-31" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb50-32"><a href="r-function-mannual.html#cb50-32" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb50-33"><a href="r-function-mannual.html#cb50-33" tabindex="-1"></a>dat_transcriptome <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>logFC</span>
<span id="cb50-34"><a href="r-function-mannual.html#cb50-34" tabindex="-1"></a><span class="fu">names</span>(dat_transcriptome) <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>Symbol</span>
<span id="cb50-35"><a href="r-function-mannual.html#cb50-35" tabindex="-1"></a></span>
<span id="cb50-36"><a href="r-function-mannual.html#cb50-36" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-37"><a href="r-function-mannual.html#cb50-37" tabindex="-1"></a>result_transcriptome <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(dat_transcriptome,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">gseaParam=</span><span class="dv">1</span>,<span class="at">nPermSimple=</span><span class="dv">1000</span>)</span>
<span id="cb50-38"><a href="r-function-mannual.html#cb50-38" tabindex="-1"></a></span>
<span id="cb50-39"><a href="r-function-mannual.html#cb50-39" tabindex="-1"></a>dat_all_temp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(metabolome_1 <span class="sc">%&gt;%</span></span>
<span id="cb50-40"><a href="r-function-mannual.html#cb50-40" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">select</span>(KEGG,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb50-41"><a href="r-function-mannual.html#cb50-41" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG&quot;</span>),</span>
<span id="cb50-42"><a href="r-function-mannual.html#cb50-42" tabindex="-1"></a>                   transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb50-43"><a href="r-function-mannual.html#cb50-43" tabindex="-1"></a>                   <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-44"><a href="r-function-mannual.html#cb50-44" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">select</span>(Symbol,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb50-45"><a href="r-function-mannual.html#cb50-45" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Symbol&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-46"><a href="r-function-mannual.html#cb50-46" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb50-47"><a href="r-function-mannual.html#cb50-47" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb50-48"><a href="r-function-mannual.html#cb50-48" tabindex="-1"></a></span>
<span id="cb50-49"><a href="r-function-mannual.html#cb50-49" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>logFC</span>
<span id="cb50-50"><a href="r-function-mannual.html#cb50-50" tabindex="-1"></a><span class="fu">names</span>(dat_all) <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>name</span>
<span id="cb50-51"><a href="r-function-mannual.html#cb50-51" tabindex="-1"></a></span>
<span id="cb50-52"><a href="r-function-mannual.html#cb50-52" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-53"><a href="r-function-mannual.html#cb50-53" tabindex="-1"></a>result_extended <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(dat_all,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">gseaParam=</span><span class="dv">1</span>,<span class="at">nPermSimple=</span><span class="dv">1000</span>)</span>
<span id="cb50-54"><a href="r-function-mannual.html#cb50-54" tabindex="-1"></a></span>
<span id="cb50-55"><a href="r-function-mannual.html#cb50-55" tabindex="-1"></a><span class="fu">write.table</span>(result_metabolome,<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb50-56"><a href="r-function-mannual.html#cb50-56" tabindex="-1"></a><span class="fu">write.table</span>(result_transcriptome,<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb50-57"><a href="r-function-mannual.html#cb50-57" tabindex="-1"></a><span class="fu">write.table</span>(result_extended,<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="multigsea" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> multiGSEA<a href="r-function-mannual.html#multigsea" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Analyzing metabolites and metabolite-related genes data using multiGSEA and using different method parameters.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="r-function-mannual.html#cb51-1" tabindex="-1"></a><span class="do">## different</span></span>
<span id="cb51-2"><a href="r-function-mannual.html#cb51-2" tabindex="-1"></a><span class="fu">data</span>(transcriptome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb51-3"><a href="r-function-mannual.html#cb51-3" tabindex="-1"></a><span class="fu">data</span>(metabolome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb51-4"><a href="r-function-mannual.html#cb51-4" tabindex="-1"></a></span>
<span id="cb51-5"><a href="r-function-mannual.html#cb51-5" tabindex="-1"></a><span class="fu">head</span>(transcriptome)</span>
<span id="cb51-6"><a href="r-function-mannual.html#cb51-6" tabindex="-1"></a><span class="fu">head</span>(metabolome)</span>
<span id="cb51-7"><a href="r-function-mannual.html#cb51-7" tabindex="-1"></a></span>
<span id="cb51-8"><a href="r-function-mannual.html#cb51-8" tabindex="-1"></a>transcriptome <span class="ot">&lt;-</span> transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="r-function-mannual.html#cb51-9" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb51-10"><a href="r-function-mannual.html#cb51-10" tabindex="-1"></a></span>
<span id="cb51-11"><a href="r-function-mannual.html#cb51-11" tabindex="-1"></a>ah <span class="ot">&lt;-</span> AnnotationHub<span class="sc">::</span><span class="fu">AnnotationHub</span>()</span>
<span id="cb51-12"><a href="r-function-mannual.html#cb51-12" tabindex="-1"></a>aa <span class="ot">&lt;-</span> ah[[<span class="st">&quot;AH91792&quot;</span>]]</span>
<span id="cb51-13"><a href="r-function-mannual.html#cb51-13" tabindex="-1"></a>metabolome <span class="ot">&lt;-</span> metabolome <span class="sc">%&gt;%</span></span>
<span id="cb51-14"><a href="r-function-mannual.html#cb51-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HMDB=</span><span class="fu">gsub</span>(<span class="st">&quot;HMDB&quot;</span>,<span class="st">&quot;HMDB00&quot;</span>,HMDB)) <span class="sc">%&gt;%</span></span>
<span id="cb51-15"><a href="r-function-mannual.html#cb51-15" tabindex="-1"></a>  <span class="fu">left_join</span>(aa,<span class="at">by=</span><span class="st">&quot;HMDB&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-16"><a href="r-function-mannual.html#cb51-16" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG)) <span class="sc">%&gt;%</span></span>
<span id="cb51-17"><a href="r-function-mannual.html#cb51-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-18"><a href="r-function-mannual.html#cb51-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HMDB,logFC,pValue,KEGG,HMDB) <span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="r-function-mannual.html#cb51-19" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-20"><a href="r-function-mannual.html#cb51-20" tabindex="-1"></a>  <span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb51-21"><a href="r-function-mannual.html#cb51-21" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb51-22"><a href="r-function-mannual.html#cb51-22" tabindex="-1"></a>  <span class="fu">distinct</span>(logFC,<span class="at">.keep_all =</span> T)</span>
<span id="cb51-23"><a href="r-function-mannual.html#cb51-23" tabindex="-1"></a></span>
<span id="cb51-24"><a href="r-function-mannual.html#cb51-24" tabindex="-1"></a><span class="co"># create data structure</span></span>
<span id="cb51-25"><a href="r-function-mannual.html#cb51-25" tabindex="-1"></a>omics_data <span class="ot">&lt;-</span> <span class="fu">initOmicsDataStructure</span>(<span class="at">layer =</span> <span class="fu">c</span>(<span class="st">&quot;transcriptome&quot;</span>,<span class="st">&quot;metabolome&quot;</span>))</span>
<span id="cb51-26"><a href="r-function-mannual.html#cb51-26" tabindex="-1"></a></span>
<span id="cb51-27"><a href="r-function-mannual.html#cb51-27" tabindex="-1"></a><span class="do">## add transcriptome layer</span></span>
<span id="cb51-28"><a href="r-function-mannual.html#cb51-28" tabindex="-1"></a>omics_data<span class="sc">$</span>transcriptome <span class="ot">&lt;-</span> transcriptome<span class="sc">$</span>logFC</span>
<span id="cb51-29"><a href="r-function-mannual.html#cb51-29" tabindex="-1"></a><span class="fu">names</span>(omics_data<span class="sc">$</span>transcriptome) <span class="ot">&lt;-</span> transcriptome<span class="sc">$</span>Symbol</span>
<span id="cb51-30"><a href="r-function-mannual.html#cb51-30" tabindex="-1"></a></span>
<span id="cb51-31"><a href="r-function-mannual.html#cb51-31" tabindex="-1"></a><span class="do">## add metabolome layer</span></span>
<span id="cb51-32"><a href="r-function-mannual.html#cb51-32" tabindex="-1"></a><span class="do">## HMDB features have to be updated to the new HMDB format</span></span>
<span id="cb51-33"><a href="r-function-mannual.html#cb51-33" tabindex="-1"></a></span>
<span id="cb51-34"><a href="r-function-mannual.html#cb51-34" tabindex="-1"></a>omics_data<span class="sc">$</span>metabolome <span class="ot">&lt;-</span> metabolome<span class="sc">$</span>logFC</span>
<span id="cb51-35"><a href="r-function-mannual.html#cb51-35" tabindex="-1"></a><span class="fu">names</span>(omics_data<span class="sc">$</span>metabolome) <span class="ot">&lt;-</span> metabolome<span class="sc">$</span>KEGG</span>
<span id="cb51-36"><a href="r-function-mannual.html#cb51-36" tabindex="-1"></a></span>
<span id="cb51-37"><a href="r-function-mannual.html#cb51-37" tabindex="-1"></a>  databases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;kegg&quot;</span>)</span>
<span id="cb51-38"><a href="r-function-mannual.html#cb51-38" tabindex="-1"></a>  layers <span class="ot">&lt;-</span> <span class="fu">names</span>(omics_data)</span>
<span id="cb51-39"><a href="r-function-mannual.html#cb51-39" tabindex="-1"></a></span>
<span id="cb51-40"><a href="r-function-mannual.html#cb51-40" tabindex="-1"></a>  pathways <span class="ot">&lt;-</span> <span class="fu">getMultiOmicsFeatures</span>(</span>
<span id="cb51-41"><a href="r-function-mannual.html#cb51-41" tabindex="-1"></a>    <span class="at">dbs =</span> databases, <span class="at">layer =</span> layers,</span>
<span id="cb51-42"><a href="r-function-mannual.html#cb51-42" tabindex="-1"></a>    <span class="at">returnTranscriptome =</span> <span class="st">&quot;SYMBOL&quot;</span>,</span>
<span id="cb51-43"><a href="r-function-mannual.html#cb51-43" tabindex="-1"></a>    <span class="at">returnMetabolome =</span> <span class="st">&quot;KEGG&quot;</span>,</span>
<span id="cb51-44"><a href="r-function-mannual.html#cb51-44" tabindex="-1"></a>    <span class="at">useLocal =</span> T)</span>
<span id="cb51-45"><a href="r-function-mannual.html#cb51-45" tabindex="-1"></a></span>
<span id="cb51-46"><a href="r-function-mannual.html#cb51-46" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb51-47"><a href="r-function-mannual.html#cb51-47" tabindex="-1"></a>enrichment_scores <span class="ot">&lt;-</span> <span class="fu">multiGSEA</span>(pathways, omics_data)</span>
<span id="cb51-48"><a href="r-function-mannual.html#cb51-48" tabindex="-1"></a></span>
<span id="cb51-49"><a href="r-function-mannual.html#cb51-49" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extractPvalues</span>(</span>
<span id="cb51-50"><a href="r-function-mannual.html#cb51-50" tabindex="-1"></a>  <span class="at">enrichmentScores =</span> enrichment_scores,</span>
<span id="cb51-51"><a href="r-function-mannual.html#cb51-51" tabindex="-1"></a>  <span class="at">pathwayNames =</span> <span class="fu">names</span>(pathways[[<span class="dv">1</span>]]))</span>
<span id="cb51-52"><a href="r-function-mannual.html#cb51-52" tabindex="-1"></a></span>
<span id="cb51-53"><a href="r-function-mannual.html#cb51-53" tabindex="-1"></a>df<span class="sc">$</span>combined_pval <span class="ot">&lt;-</span> <span class="fu">combinePvalues</span>(df)</span>
<span id="cb51-54"><a href="r-function-mannual.html#cb51-54" tabindex="-1"></a>df<span class="sc">$</span>combined_padj <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(df<span class="sc">$</span>combined_pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb51-55"><a href="r-function-mannual.html#cb51-55" tabindex="-1"></a></span>
<span id="cb51-56"><a href="r-function-mannual.html#cb51-56" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="at">pathway =</span> <span class="fu">names</span>(pathways[[<span class="dv">1</span>]])), df)</span>
<span id="cb51-57"><a href="r-function-mannual.html#cb51-57" tabindex="-1"></a><span class="fu">write.table</span>(df,<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb51-58"><a href="r-function-mannual.html#cb51-58" tabindex="-1"></a></span>
<span id="cb51-59"><a href="r-function-mannual.html#cb51-59" tabindex="-1"></a><span class="do">## same</span></span>
<span id="cb51-60"><a href="r-function-mannual.html#cb51-60" tabindex="-1"></a><span class="fu">data</span>(transcriptome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb51-61"><a href="r-function-mannual.html#cb51-61" tabindex="-1"></a><span class="fu">data</span>(metabolome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb51-62"><a href="r-function-mannual.html#cb51-62" tabindex="-1"></a></span>
<span id="cb51-63"><a href="r-function-mannual.html#cb51-63" tabindex="-1"></a><span class="fu">head</span>(transcriptome)</span>
<span id="cb51-64"><a href="r-function-mannual.html#cb51-64" tabindex="-1"></a><span class="fu">head</span>(metabolome)</span>
<span id="cb51-65"><a href="r-function-mannual.html#cb51-65" tabindex="-1"></a></span>
<span id="cb51-66"><a href="r-function-mannual.html#cb51-66" tabindex="-1"></a>transcriptome <span class="ot">&lt;-</span> transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb51-67"><a href="r-function-mannual.html#cb51-67" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb51-68"><a href="r-function-mannual.html#cb51-68" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb51-69"><a href="r-function-mannual.html#cb51-69" tabindex="-1"></a></span>
<span id="cb51-70"><a href="r-function-mannual.html#cb51-70" tabindex="-1"></a>ah <span class="ot">&lt;-</span> AnnotationHub<span class="sc">::</span><span class="fu">AnnotationHub</span>()</span>
<span id="cb51-71"><a href="r-function-mannual.html#cb51-71" tabindex="-1"></a>aa <span class="ot">&lt;-</span> ah[[<span class="st">&quot;AH91792&quot;</span>]]</span>
<span id="cb51-72"><a href="r-function-mannual.html#cb51-72" tabindex="-1"></a>metabolome <span class="ot">&lt;-</span> metabolome <span class="sc">%&gt;%</span></span>
<span id="cb51-73"><a href="r-function-mannual.html#cb51-73" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HMDB=</span><span class="fu">gsub</span>(<span class="st">&quot;HMDB&quot;</span>,<span class="st">&quot;HMDB00&quot;</span>,HMDB)) <span class="sc">%&gt;%</span></span>
<span id="cb51-74"><a href="r-function-mannual.html#cb51-74" tabindex="-1"></a>  <span class="fu">left_join</span>(aa,<span class="at">by=</span><span class="st">&quot;HMDB&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-75"><a href="r-function-mannual.html#cb51-75" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG)) <span class="sc">%&gt;%</span></span>
<span id="cb51-76"><a href="r-function-mannual.html#cb51-76" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-77"><a href="r-function-mannual.html#cb51-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HMDB,logFC,pValue,KEGG,HMDB) <span class="sc">%&gt;%</span></span>
<span id="cb51-78"><a href="r-function-mannual.html#cb51-78" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-79"><a href="r-function-mannual.html#cb51-79" tabindex="-1"></a>  <span class="fu">filter</span>(KEGG <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb51-80"><a href="r-function-mannual.html#cb51-80" tabindex="-1"></a>  <span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb51-81"><a href="r-function-mannual.html#cb51-81" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb51-82"><a href="r-function-mannual.html#cb51-82" tabindex="-1"></a>  <span class="fu">distinct</span>(logFC,<span class="at">.keep_all =</span> T)</span>
<span id="cb51-83"><a href="r-function-mannual.html#cb51-83" tabindex="-1"></a></span>
<span id="cb51-84"><a href="r-function-mannual.html#cb51-84" tabindex="-1"></a><span class="co"># create data structure</span></span>
<span id="cb51-85"><a href="r-function-mannual.html#cb51-85" tabindex="-1"></a>omics_data <span class="ot">&lt;-</span> <span class="fu">initOmicsDataStructure</span>(<span class="at">layer =</span> <span class="fu">c</span>(<span class="st">&quot;transcriptome&quot;</span>,<span class="st">&quot;metabolome&quot;</span>))</span>
<span id="cb51-86"><a href="r-function-mannual.html#cb51-86" tabindex="-1"></a></span>
<span id="cb51-87"><a href="r-function-mannual.html#cb51-87" tabindex="-1"></a><span class="do">## add transcriptome layer</span></span>
<span id="cb51-88"><a href="r-function-mannual.html#cb51-88" tabindex="-1"></a>omics_data<span class="sc">$</span>transcriptome <span class="ot">&lt;-</span> transcriptome<span class="sc">$</span>logFC</span>
<span id="cb51-89"><a href="r-function-mannual.html#cb51-89" tabindex="-1"></a><span class="fu">names</span>(omics_data<span class="sc">$</span>transcriptome) <span class="ot">&lt;-</span> transcriptome<span class="sc">$</span>Symbol</span>
<span id="cb51-90"><a href="r-function-mannual.html#cb51-90" tabindex="-1"></a></span>
<span id="cb51-91"><a href="r-function-mannual.html#cb51-91" tabindex="-1"></a><span class="do">## add metabolome layer</span></span>
<span id="cb51-92"><a href="r-function-mannual.html#cb51-92" tabindex="-1"></a><span class="do">## HMDB features have to be updated to the new HMDB format</span></span>
<span id="cb51-93"><a href="r-function-mannual.html#cb51-93" tabindex="-1"></a></span>
<span id="cb51-94"><a href="r-function-mannual.html#cb51-94" tabindex="-1"></a>omics_data<span class="sc">$</span>metabolome <span class="ot">&lt;-</span> metabolome<span class="sc">$</span>logFC</span>
<span id="cb51-95"><a href="r-function-mannual.html#cb51-95" tabindex="-1"></a><span class="fu">names</span>(omics_data<span class="sc">$</span>metabolome) <span class="ot">&lt;-</span> metabolome<span class="sc">$</span>KEGG</span>
<span id="cb51-96"><a href="r-function-mannual.html#cb51-96" tabindex="-1"></a></span>
<span id="cb51-97"><a href="r-function-mannual.html#cb51-97" tabindex="-1"></a>pathways <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb51-98"><a href="r-function-mannual.html#cb51-98" tabindex="-1"></a>pathways<span class="sc">$</span>transcriptome <span class="ot">&lt;-</span> Pathways_gene</span>
<span id="cb51-99"><a href="r-function-mannual.html#cb51-99" tabindex="-1"></a>pathways<span class="sc">$</span>metabolome <span class="ot">&lt;-</span> Pathways_metabolite</span>
<span id="cb51-100"><a href="r-function-mannual.html#cb51-100" tabindex="-1"></a></span>
<span id="cb51-101"><a href="r-function-mannual.html#cb51-101" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb51-102"><a href="r-function-mannual.html#cb51-102" tabindex="-1"></a>enrichment_scores <span class="ot">&lt;-</span> <span class="fu">multiGSEA</span>(pathways, omics_data)</span>
<span id="cb51-103"><a href="r-function-mannual.html#cb51-103" tabindex="-1"></a></span>
<span id="cb51-104"><a href="r-function-mannual.html#cb51-104" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extractPvalues</span>(</span>
<span id="cb51-105"><a href="r-function-mannual.html#cb51-105" tabindex="-1"></a>  <span class="at">enrichmentScores =</span> enrichment_scores,</span>
<span id="cb51-106"><a href="r-function-mannual.html#cb51-106" tabindex="-1"></a>  <span class="at">pathwayNames =</span> <span class="fu">names</span>(pathways[[<span class="dv">1</span>]]))</span>
<span id="cb51-107"><a href="r-function-mannual.html#cb51-107" tabindex="-1"></a></span>
<span id="cb51-108"><a href="r-function-mannual.html#cb51-108" tabindex="-1"></a>df<span class="sc">$</span>combined_pval <span class="ot">&lt;-</span> <span class="fu">combinePvalues</span>(df)</span>
<span id="cb51-109"><a href="r-function-mannual.html#cb51-109" tabindex="-1"></a>df<span class="sc">$</span>combined_padj <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(df<span class="sc">$</span>combined_pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb51-110"><a href="r-function-mannual.html#cb51-110" tabindex="-1"></a></span>
<span id="cb51-111"><a href="r-function-mannual.html#cb51-111" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="at">pathway =</span> <span class="fu">names</span>(pathways[[<span class="dv">1</span>]])), df)</span>
<span id="cb51-112"><a href="r-function-mannual.html#cb51-112" tabindex="-1"></a><span class="fu">write.table</span>(df,<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="comparison-between-mnet-and-multigsea" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Comparison between MNet and multiGSEA<a href="r-function-mannual.html#comparison-between-mnet-and-multigsea" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="set-different-cutoffs-3" class="section level4 hasAnchor" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> Set different cutoffs<a href="r-function-mannual.html#set-different-cutoffs-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compare the stability of the results of different methods under different cutoff values.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="r-function-mannual.html#cb52-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="r-function-mannual.html#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="r-function-mannual.html#cb52-3" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="r-function-mannual.html#cb52-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="r-function-mannual.html#cb52-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb52-6"><a href="r-function-mannual.html#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="r-function-mannual.html#cb52-7" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="r-function-mannual.html#cb52-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="r-function-mannual.html#cb52-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb52-10"><a href="r-function-mannual.html#cb52-10" tabindex="-1"></a></span>
<span id="cb52-11"><a href="r-function-mannual.html#cb52-11" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="r-function-mannual.html#cb52-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-13"><a href="r-function-mannual.html#cb52-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb52-14"><a href="r-function-mannual.html#cb52-14" tabindex="-1"></a></span>
<span id="cb52-15"><a href="r-function-mannual.html#cb52-15" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb52-16"><a href="r-function-mannual.html#cb52-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb52-17"><a href="r-function-mannual.html#cb52-17" tabindex="-1"></a></span>
<span id="cb52-18"><a href="r-function-mannual.html#cb52-18" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-19"><a href="r-function-mannual.html#cb52-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-20"><a href="r-function-mannual.html#cb52-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb52-21"><a href="r-function-mannual.html#cb52-21" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb52-22"><a href="r-function-mannual.html#cb52-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb52-23"><a href="r-function-mannual.html#cb52-23" tabindex="-1"></a></span>
<span id="cb52-24"><a href="r-function-mannual.html#cb52-24" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb52-25"><a href="r-function-mannual.html#cb52-25" tabindex="-1"></a></span>
<span id="cb52-26"><a href="r-function-mannual.html#cb52-26" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb52-27"><a href="r-function-mannual.html#cb52-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-28"><a href="r-function-mannual.html#cb52-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-29"><a href="r-function-mannual.html#cb52-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb52-30"><a href="r-function-mannual.html#cb52-30" tabindex="-1"></a>                     <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb52-31"><a href="r-function-mannual.html#cb52-31" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb52-32"><a href="r-function-mannual.html#cb52-32" tabindex="-1"></a></span>
<span id="cb52-33"><a href="r-function-mannual.html#cb52-33" tabindex="-1"></a><span class="do">## same database</span></span>
<span id="cb52-34"><a href="r-function-mannual.html#cb52-34" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-35"><a href="r-function-mannual.html#cb52-35" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-36"><a href="r-function-mannual.html#cb52-36" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb52-37"><a href="r-function-mannual.html#cb52-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb52-38"><a href="r-function-mannual.html#cb52-38" tabindex="-1"></a></span>
<span id="cb52-39"><a href="r-function-mannual.html#cb52-39" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb52-40"><a href="r-function-mannual.html#cb52-40" tabindex="-1"></a></span>
<span id="cb52-41"><a href="r-function-mannual.html#cb52-41" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb52-42"><a href="r-function-mannual.html#cb52-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-43"><a href="r-function-mannual.html#cb52-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-44"><a href="r-function-mannual.html#cb52-44" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb52-45"><a href="r-function-mannual.html#cb52-45" tabindex="-1"></a>                     <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb52-46"><a href="r-function-mannual.html#cb52-46" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb52-47"><a href="r-function-mannual.html#cb52-47" tabindex="-1"></a></span>
<span id="cb52-48"><a href="r-function-mannual.html#cb52-48" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_same,dat_multigsea_diff)</span>
<span id="cb52-49"><a href="r-function-mannual.html#cb52-49" tabindex="-1"></a></span>
<span id="cb52-50"><a href="r-function-mannual.html#cb52-50" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="sc">-</span><span class="fl">0.005</span>)</span>
<span id="cb52-51"><a href="r-function-mannual.html#cb52-51" tabindex="-1"></a></span>
<span id="cb52-52"><a href="r-function-mannual.html#cb52-52" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb52-53"><a href="r-function-mannual.html#cb52-53" tabindex="-1"></a></span>
<span id="cb52-54"><a href="r-function-mannual.html#cb52-54" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n) {</span>
<span id="cb52-55"><a href="r-function-mannual.html#cb52-55" tabindex="-1"></a>  <span class="do">## Hypergeo</span></span>
<span id="cb52-56"><a href="r-function-mannual.html#cb52-56" tabindex="-1"></a>  result_temp <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb52-57"><a href="r-function-mannual.html#cb52-57" tabindex="-1"></a>    <span class="fu">filter</span>(pval <span class="sc">&lt;</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb52-58"><a href="r-function-mannual.html#cb52-58" tabindex="-1"></a>    <span class="fu">group_by</span>(type,software) <span class="sc">%&gt;%</span></span>
<span id="cb52-59"><a href="r-function-mannual.html#cb52-59" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-60"><a href="r-function-mannual.html#cb52-60" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-61"><a href="r-function-mannual.html#cb52-61" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">cutoff=</span>i)</span>
<span id="cb52-62"><a href="r-function-mannual.html#cb52-62" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result,result_temp)</span>
<span id="cb52-63"><a href="r-function-mannual.html#cb52-63" tabindex="-1"></a>}</span>
<span id="cb52-64"><a href="r-function-mannual.html#cb52-64" tabindex="-1"></a></span>
<span id="cb52-65"><a href="r-function-mannual.html#cb52-65" tabindex="-1"></a>result<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;extended&quot;</span>))</span>
<span id="cb52-66"><a href="r-function-mannual.html#cb52-66" tabindex="-1"></a></span>
<span id="cb52-67"><a href="r-function-mannual.html#cb52-67" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(cutoff,n))<span class="sc">+</span></span>
<span id="cb52-68"><a href="r-function-mannual.html#cb52-68" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;gray&quot;</span>,<span class="at">size=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb52-69"><a href="r-function-mannual.html#cb52-69" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color=</span>software))<span class="sc">+</span></span>
<span id="cb52-70"><a href="r-function-mannual.html#cb52-70" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="fl">0.01</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb52-71"><a href="r-function-mannual.html#cb52-71" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)<span class="sc">+</span></span>
<span id="cb52-72"><a href="r-function-mannual.html#cb52-72" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span><span class="ot">=</span><span class="st">&quot;#EF2C2B&quot;</span>,</span>
<span id="cb52-73"><a href="r-function-mannual.html#cb52-73" tabindex="-1"></a>                              <span class="st">&quot;multiGSEA-diffdatabase&quot;</span><span class="ot">=</span><span class="st">&quot;#4FBD81&quot;</span>,</span>
<span id="cb52-74"><a href="r-function-mannual.html#cb52-74" tabindex="-1"></a>                              <span class="st">&quot;multiGSEA-samedatabase&quot;</span><span class="ot">=</span><span class="st">&quot;#FFC839&quot;</span>))<span class="sc">+</span></span>
<span id="cb52-75"><a href="r-function-mannual.html#cb52-75" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()<span class="sc">+</span></span>
<span id="cb52-76"><a href="r-function-mannual.html#cb52-76" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb52-77"><a href="r-function-mannual.html#cb52-77" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/MNet-multiGSEA-cutoff.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/multiGSEA-cutoff.png" width="1096" style="display: block; margin: auto;" /></p>
</div>
<div id="venn-plot-3" class="section level4 hasAnchor" number="3.3.3.2">
<h4><span class="header-section-number">3.3.3.2</span> Venn plot<a href="r-function-mannual.html#venn-plot-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifying the agreement of different methods using Venn diagrams.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="r-function-mannual.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb53-2"><a href="r-function-mannual.html#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="r-function-mannual.html#cb53-3" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="r-function-mannual.html#cb53-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="r-function-mannual.html#cb53-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb53-6"><a href="r-function-mannual.html#cb53-6" tabindex="-1"></a></span>
<span id="cb53-7"><a href="r-function-mannual.html#cb53-7" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="r-function-mannual.html#cb53-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="r-function-mannual.html#cb53-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb53-10"><a href="r-function-mannual.html#cb53-10" tabindex="-1"></a></span>
<span id="cb53-11"><a href="r-function-mannual.html#cb53-11" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="r-function-mannual.html#cb53-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="r-function-mannual.html#cb53-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb53-14"><a href="r-function-mannual.html#cb53-14" tabindex="-1"></a></span>
<span id="cb53-15"><a href="r-function-mannual.html#cb53-15" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="r-function-mannual.html#cb53-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb53-17"><a href="r-function-mannual.html#cb53-17" tabindex="-1"></a></span>
<span id="cb53-18"><a href="r-function-mannual.html#cb53-18" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="r-function-mannual.html#cb53-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-20"><a href="r-function-mannual.html#cb53-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb53-21"><a href="r-function-mannual.html#cb53-21" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="r-function-mannual.html#cb53-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb53-23"><a href="r-function-mannual.html#cb53-23" tabindex="-1"></a></span>
<span id="cb53-24"><a href="r-function-mannual.html#cb53-24" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb53-25"><a href="r-function-mannual.html#cb53-25" tabindex="-1"></a></span>
<span id="cb53-26"><a href="r-function-mannual.html#cb53-26" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb53-27"><a href="r-function-mannual.html#cb53-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-28"><a href="r-function-mannual.html#cb53-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-29"><a href="r-function-mannual.html#cb53-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb53-30"><a href="r-function-mannual.html#cb53-30" tabindex="-1"></a>                     <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb53-31"><a href="r-function-mannual.html#cb53-31" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb53-32"><a href="r-function-mannual.html#cb53-32" tabindex="-1"></a></span>
<span id="cb53-33"><a href="r-function-mannual.html#cb53-33" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-34"><a href="r-function-mannual.html#cb53-34" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-35"><a href="r-function-mannual.html#cb53-35" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="r-function-mannual.html#cb53-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb53-37"><a href="r-function-mannual.html#cb53-37" tabindex="-1"></a></span>
<span id="cb53-38"><a href="r-function-mannual.html#cb53-38" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb53-39"><a href="r-function-mannual.html#cb53-39" tabindex="-1"></a></span>
<span id="cb53-40"><a href="r-function-mannual.html#cb53-40" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb53-41"><a href="r-function-mannual.html#cb53-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-42"><a href="r-function-mannual.html#cb53-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-43"><a href="r-function-mannual.html#cb53-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb53-44"><a href="r-function-mannual.html#cb53-44" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb53-45"><a href="r-function-mannual.html#cb53-45" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb53-46"><a href="r-function-mannual.html#cb53-46" tabindex="-1"></a></span>
<span id="cb53-47"><a href="r-function-mannual.html#cb53-47" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_diff,dat_multigsea_same)</span>
<span id="cb53-48"><a href="r-function-mannual.html#cb53-48" tabindex="-1"></a></span>
<span id="cb53-49"><a href="r-function-mannual.html#cb53-49" tabindex="-1"></a>all_filter <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb53-50"><a href="r-function-mannual.html#cb53-50" tabindex="-1"></a>  <span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb53-51"><a href="r-function-mannual.html#cb53-51" tabindex="-1"></a></span>
<span id="cb53-52"><a href="r-function-mannual.html#cb53-52" tabindex="-1"></a>all_filter_metabolite <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="r-function-mannual.html#cb53-53" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb53-54"><a href="r-function-mannual.html#cb53-54" tabindex="-1"></a></span>
<span id="cb53-55"><a href="r-function-mannual.html#cb53-55" tabindex="-1"></a>all_filter_gene <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb53-56"><a href="r-function-mannual.html#cb53-56" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb53-57"><a href="r-function-mannual.html#cb53-57" tabindex="-1"></a></span>
<span id="cb53-58"><a href="r-function-mannual.html#cb53-58" tabindex="-1"></a>all_filter_extended <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb53-59"><a href="r-function-mannual.html#cb53-59" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;extended&quot;</span>)</span>
<span id="cb53-60"><a href="r-function-mannual.html#cb53-60" tabindex="-1"></a></span>
<span id="cb53-61"><a href="r-function-mannual.html#cb53-61" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb53-62"><a href="r-function-mannual.html#cb53-62" tabindex="-1"></a>metabolite_MNet_venn <span class="ot">&lt;-</span> all_filter_metabolite <span class="sc">%&gt;%</span></span>
<span id="cb53-63"><a href="r-function-mannual.html#cb53-63" tabindex="-1"></a>  <span class="fu">filter</span>(software<span class="sc">==</span><span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-64"><a href="r-function-mannual.html#cb53-64" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-65"><a href="r-function-mannual.html#cb53-65" tabindex="-1"></a>metabolite_multigsea_same_venn <span class="ot">&lt;-</span> all_filter_metabolite <span class="sc">%&gt;%</span></span>
<span id="cb53-66"><a href="r-function-mannual.html#cb53-66" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-67"><a href="r-function-mannual.html#cb53-67" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-68"><a href="r-function-mannual.html#cb53-68" tabindex="-1"></a>metabolite_multigsea_diff_venn <span class="ot">&lt;-</span> all_filter_metabolite <span class="sc">%&gt;%</span></span>
<span id="cb53-69"><a href="r-function-mannual.html#cb53-69" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-70"><a href="r-function-mannual.html#cb53-70" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-71"><a href="r-function-mannual.html#cb53-71" tabindex="-1"></a></span>
<span id="cb53-72"><a href="r-function-mannual.html#cb53-72" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb53-73"><a href="r-function-mannual.html#cb53-73" tabindex="-1"></a>gene_MNet_venn <span class="ot">&lt;-</span> all_filter_gene <span class="sc">%&gt;%</span></span>
<span id="cb53-74"><a href="r-function-mannual.html#cb53-74" tabindex="-1"></a>  <span class="fu">filter</span>(software<span class="sc">==</span><span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-75"><a href="r-function-mannual.html#cb53-75" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-76"><a href="r-function-mannual.html#cb53-76" tabindex="-1"></a>gene_multigsea_same_venn <span class="ot">&lt;-</span> all_filter_gene <span class="sc">%&gt;%</span></span>
<span id="cb53-77"><a href="r-function-mannual.html#cb53-77" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-78"><a href="r-function-mannual.html#cb53-78" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-79"><a href="r-function-mannual.html#cb53-79" tabindex="-1"></a>gene_multigsea_diff_venn <span class="ot">&lt;-</span> all_filter_gene <span class="sc">%&gt;%</span></span>
<span id="cb53-80"><a href="r-function-mannual.html#cb53-80" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-81"><a href="r-function-mannual.html#cb53-81" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-82"><a href="r-function-mannual.html#cb53-82" tabindex="-1"></a></span>
<span id="cb53-83"><a href="r-function-mannual.html#cb53-83" tabindex="-1"></a><span class="do">## extended</span></span>
<span id="cb53-84"><a href="r-function-mannual.html#cb53-84" tabindex="-1"></a>extended_MNet_venn <span class="ot">&lt;-</span> all_filter_extended <span class="sc">%&gt;%</span></span>
<span id="cb53-85"><a href="r-function-mannual.html#cb53-85" tabindex="-1"></a>  <span class="fu">filter</span>(software<span class="sc">==</span><span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-86"><a href="r-function-mannual.html#cb53-86" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-87"><a href="r-function-mannual.html#cb53-87" tabindex="-1"></a>extended_multigsea_same_venn <span class="ot">&lt;-</span> all_filter_extended <span class="sc">%&gt;%</span></span>
<span id="cb53-88"><a href="r-function-mannual.html#cb53-88" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-89"><a href="r-function-mannual.html#cb53-89" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-90"><a href="r-function-mannual.html#cb53-90" tabindex="-1"></a>extended_multigsea_diff_venn <span class="ot">&lt;-</span> all_filter_extended <span class="sc">%&gt;%</span></span>
<span id="cb53-91"><a href="r-function-mannual.html#cb53-91" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-92"><a href="r-function-mannual.html#cb53-92" tabindex="-1"></a>  <span class="fu">pull</span>(pathway)</span>
<span id="cb53-93"><a href="r-function-mannual.html#cb53-93" tabindex="-1"></a></span>
<span id="cb53-94"><a href="r-function-mannual.html#cb53-94" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">metabolite_mnet=</span>metabolite_MNet_venn,</span>
<span id="cb53-95"><a href="r-function-mannual.html#cb53-95" tabindex="-1"></a>                     <span class="at">metabolite_multigsea_same=</span>metabolite_multigsea_same_venn,</span>
<span id="cb53-96"><a href="r-function-mannual.html#cb53-96" tabindex="-1"></a>                     <span class="at">metabolite_multigsea_diff=</span>metabolite_multigsea_diff_venn),</span>
<span id="cb53-97"><a href="r-function-mannual.html#cb53-97" tabindex="-1"></a>                <span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>),</span>
<span id="cb53-98"><a href="r-function-mannual.html#cb53-98" tabindex="-1"></a>                <span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb53-99"><a href="r-function-mannual.html#cb53-99" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_metabolite_venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb53-100"><a href="r-function-mannual.html#cb53-100" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb53-101"><a href="r-function-mannual.html#cb53-101" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-102"><a href="r-function-mannual.html#cb53-102" tabindex="-1"></a></span>
<span id="cb53-103"><a href="r-function-mannual.html#cb53-103" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">gene_mnet=</span>gene_MNet_venn,</span>
<span id="cb53-104"><a href="r-function-mannual.html#cb53-104" tabindex="-1"></a>                     <span class="at">gene_multigsea_same=</span>gene_multigsea_same_venn,</span>
<span id="cb53-105"><a href="r-function-mannual.html#cb53-105" tabindex="-1"></a>                     <span class="at">gene_multigsea_diff=</span>gene_multigsea_diff_venn),</span>
<span id="cb53-106"><a href="r-function-mannual.html#cb53-106" tabindex="-1"></a>                <span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>),</span>
<span id="cb53-107"><a href="r-function-mannual.html#cb53-107" tabindex="-1"></a>                <span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb53-108"><a href="r-function-mannual.html#cb53-108" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_gene_venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb53-109"><a href="r-function-mannual.html#cb53-109" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb53-110"><a href="r-function-mannual.html#cb53-110" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-111"><a href="r-function-mannual.html#cb53-111" tabindex="-1"></a></span>
<span id="cb53-112"><a href="r-function-mannual.html#cb53-112" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">extended_mnet=</span>extended_MNet_venn,</span>
<span id="cb53-113"><a href="r-function-mannual.html#cb53-113" tabindex="-1"></a>                     <span class="at">extended_multigsea_same=</span>extended_multigsea_same_venn,</span>
<span id="cb53-114"><a href="r-function-mannual.html#cb53-114" tabindex="-1"></a>                     <span class="at">extended_multigsea_diff=</span>extended_multigsea_diff_venn),</span>
<span id="cb53-115"><a href="r-function-mannual.html#cb53-115" tabindex="-1"></a>                <span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>),</span>
<span id="cb53-116"><a href="r-function-mannual.html#cb53-116" tabindex="-1"></a>                <span class="at">alpha=</span><span class="fl">0.9</span>)</span>
<span id="cb53-117"><a href="r-function-mannual.html#cb53-117" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_extended_venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb53-118"><a href="r-function-mannual.html#cb53-118" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb53-119"><a href="r-function-mannual.html#cb53-119" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figure/multiGSEA-venn.png" width="1086" style="display: block; margin: auto;" /></p>
</div>
<div id="barplot-1" class="section level4 hasAnchor" number="3.3.3.3">
<h4><span class="header-section-number">3.3.3.3</span> Barplot<a href="r-function-mannual.html#barplot-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The barplot shows the results of the analysis using only metabolism, only metabolite-related genes, and the combination of both data.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="r-function-mannual.html#cb54-1" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="r-function-mannual.html#cb54-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="r-function-mannual.html#cb54-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb54-4"><a href="r-function-mannual.html#cb54-4" tabindex="-1"></a></span>
<span id="cb54-5"><a href="r-function-mannual.html#cb54-5" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="r-function-mannual.html#cb54-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="r-function-mannual.html#cb54-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb54-8"><a href="r-function-mannual.html#cb54-8" tabindex="-1"></a></span>
<span id="cb54-9"><a href="r-function-mannual.html#cb54-9" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="r-function-mannual.html#cb54-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="r-function-mannual.html#cb54-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb54-12"><a href="r-function-mannual.html#cb54-12" tabindex="-1"></a></span>
<span id="cb54-13"><a href="r-function-mannual.html#cb54-13" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb54-14"><a href="r-function-mannual.html#cb54-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb54-15"><a href="r-function-mannual.html#cb54-15" tabindex="-1"></a></span>
<span id="cb54-16"><a href="r-function-mannual.html#cb54-16" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-17"><a href="r-function-mannual.html#cb54-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="r-function-mannual.html#cb54-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb54-19"><a href="r-function-mannual.html#cb54-19" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb54-20"><a href="r-function-mannual.html#cb54-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb54-21"><a href="r-function-mannual.html#cb54-21" tabindex="-1"></a></span>
<span id="cb54-22"><a href="r-function-mannual.html#cb54-22" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb54-23"><a href="r-function-mannual.html#cb54-23" tabindex="-1"></a></span>
<span id="cb54-24"><a href="r-function-mannual.html#cb54-24" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb54-25"><a href="r-function-mannual.html#cb54-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-26"><a href="r-function-mannual.html#cb54-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-27"><a href="r-function-mannual.html#cb54-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb54-28"><a href="r-function-mannual.html#cb54-28" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb54-29"><a href="r-function-mannual.html#cb54-29" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb54-30"><a href="r-function-mannual.html#cb54-30" tabindex="-1"></a></span>
<span id="cb54-31"><a href="r-function-mannual.html#cb54-31" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-32"><a href="r-function-mannual.html#cb54-32" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-33"><a href="r-function-mannual.html#cb54-33" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb54-34"><a href="r-function-mannual.html#cb54-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb54-35"><a href="r-function-mannual.html#cb54-35" tabindex="-1"></a></span>
<span id="cb54-36"><a href="r-function-mannual.html#cb54-36" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb54-37"><a href="r-function-mannual.html#cb54-37" tabindex="-1"></a></span>
<span id="cb54-38"><a href="r-function-mannual.html#cb54-38" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb54-39"><a href="r-function-mannual.html#cb54-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-40"><a href="r-function-mannual.html#cb54-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-41"><a href="r-function-mannual.html#cb54-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb54-42"><a href="r-function-mannual.html#cb54-42" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb54-43"><a href="r-function-mannual.html#cb54-43" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb54-44"><a href="r-function-mannual.html#cb54-44" tabindex="-1"></a></span>
<span id="cb54-45"><a href="r-function-mannual.html#cb54-45" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_diff,dat_multigsea_same)</span>
<span id="cb54-46"><a href="r-function-mannual.html#cb54-46" tabindex="-1"></a></span>
<span id="cb54-47"><a href="r-function-mannual.html#cb54-47" tabindex="-1"></a>all_filter <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb54-48"><a href="r-function-mannual.html#cb54-48" tabindex="-1"></a>  <span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb54-49"><a href="r-function-mannual.html#cb54-49" tabindex="-1"></a></span>
<span id="cb54-50"><a href="r-function-mannual.html#cb54-50" tabindex="-1"></a>all_filter_metabolite <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb54-51"><a href="r-function-mannual.html#cb54-51" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-52"><a href="r-function-mannual.html#cb54-52" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb54-53"><a href="r-function-mannual.html#cb54-53" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(software,<span class="fu">c</span>(<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;MNet&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-54"><a href="r-function-mannual.html#cb54-54" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">factor</span>(pathway,</span>
<span id="cb54-55"><a href="r-function-mannual.html#cb54-55" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">unique</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb54-56"><a href="r-function-mannual.html#cb54-56" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">software=</span><span class="fu">factor</span>(software,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>)))</span>
<span id="cb54-57"><a href="r-function-mannual.html#cb54-57" tabindex="-1"></a></span>
<span id="cb54-58"><a href="r-function-mannual.html#cb54-58" tabindex="-1"></a>all_filter_gene <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb54-59"><a href="r-function-mannual.html#cb54-59" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-60"><a href="r-function-mannual.html#cb54-60" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb54-61"><a href="r-function-mannual.html#cb54-61" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(software,<span class="fu">c</span>(<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;MNet&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-62"><a href="r-function-mannual.html#cb54-62" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">factor</span>(pathway,<span class="at">levels =</span> <span class="fu">unique</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb54-63"><a href="r-function-mannual.html#cb54-63" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">software=</span><span class="fu">factor</span>(software,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>)))</span>
<span id="cb54-64"><a href="r-function-mannual.html#cb54-64" tabindex="-1"></a></span>
<span id="cb54-65"><a href="r-function-mannual.html#cb54-65" tabindex="-1"></a>all_filter_extended <span class="ot">&lt;-</span> all_filter <span class="sc">%&gt;%</span></span>
<span id="cb54-66"><a href="r-function-mannual.html#cb54-66" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;extended&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-67"><a href="r-function-mannual.html#cb54-67" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb54-68"><a href="r-function-mannual.html#cb54-68" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(software,<span class="fu">c</span>(<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;MNet&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-69"><a href="r-function-mannual.html#cb54-69" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">factor</span>(pathway,<span class="at">levels =</span> <span class="fu">unique</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb54-70"><a href="r-function-mannual.html#cb54-70" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">software=</span><span class="fu">factor</span>(software,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA-samedatabase&quot;</span>,<span class="st">&quot;multiGSEA-diffdatabase&quot;</span>)))</span>
<span id="cb54-71"><a href="r-function-mannual.html#cb54-71" tabindex="-1"></a></span>
<span id="cb54-72"><a href="r-function-mannual.html#cb54-72" tabindex="-1"></a>p_metabolite <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_filter_metabolite,<span class="fu">aes</span>(pathway,<span class="sc">-</span><span class="fu">log10</span>(pval),<span class="at">fill=</span>software))<span class="sc">+</span></span>
<span id="cb54-73"><a href="r-function-mannual.html#cb54-73" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb54-74"><a href="r-function-mannual.html#cb54-74" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>))<span class="sc">+</span></span>
<span id="cb54-75"><a href="r-function-mannual.html#cb54-75" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb54-76"><a href="r-function-mannual.html#cb54-76" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> software)<span class="sc">+</span></span>
<span id="cb54-77"><a href="r-function-mannual.html#cb54-77" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb54-78"><a href="r-function-mannual.html#cb54-78" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb54-79"><a href="r-function-mannual.html#cb54-79" tabindex="-1"></a><span class="co">#p_metabolite</span></span>
<span id="cb54-80"><a href="r-function-mannual.html#cb54-80" tabindex="-1"></a></span>
<span id="cb54-81"><a href="r-function-mannual.html#cb54-81" tabindex="-1"></a>p_gene <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_filter_gene,<span class="fu">aes</span>(pathway,<span class="sc">-</span><span class="fu">log10</span>(pval),<span class="at">fill=</span>software))<span class="sc">+</span></span>
<span id="cb54-82"><a href="r-function-mannual.html#cb54-82" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb54-83"><a href="r-function-mannual.html#cb54-83" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>))<span class="sc">+</span></span>
<span id="cb54-84"><a href="r-function-mannual.html#cb54-84" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb54-85"><a href="r-function-mannual.html#cb54-85" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> software)<span class="sc">+</span></span>
<span id="cb54-86"><a href="r-function-mannual.html#cb54-86" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb54-87"><a href="r-function-mannual.html#cb54-87" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb54-88"><a href="r-function-mannual.html#cb54-88" tabindex="-1"></a><span class="co">#p_gene</span></span>
<span id="cb54-89"><a href="r-function-mannual.html#cb54-89" tabindex="-1"></a></span>
<span id="cb54-90"><a href="r-function-mannual.html#cb54-90" tabindex="-1"></a>p_extended <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_filter_extended,<span class="fu">aes</span>(pathway,<span class="sc">-</span><span class="fu">log10</span>(pval),<span class="at">fill=</span>software))<span class="sc">+</span></span>
<span id="cb54-91"><a href="r-function-mannual.html#cb54-91" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb54-92"><a href="r-function-mannual.html#cb54-92" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>))<span class="sc">+</span></span>
<span id="cb54-93"><a href="r-function-mannual.html#cb54-93" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb54-94"><a href="r-function-mannual.html#cb54-94" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> software)<span class="sc">+</span></span>
<span id="cb54-95"><a href="r-function-mannual.html#cb54-95" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb54-96"><a href="r-function-mannual.html#cb54-96" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;extended&quot;</span>)</span>
<span id="cb54-97"><a href="r-function-mannual.html#cb54-97" tabindex="-1"></a><span class="co">#p_extended</span></span>
<span id="cb54-98"><a href="r-function-mannual.html#cb54-98" tabindex="-1"></a></span>
<span id="cb54-99"><a href="r-function-mannual.html#cb54-99" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_metabolite_barplot.pdf&quot;</span>,p_metabolite,<span class="at">width=</span><span class="dv">8</span>,<span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb54-100"><a href="r-function-mannual.html#cb54-100" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_gene_barplot.pdf&quot;</span>,p_gene,<span class="at">width=</span><span class="dv">8</span>,<span class="at">height =</span> <span class="dv">2</span>)</span>
<span id="cb54-101"><a href="r-function-mannual.html#cb54-101" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_extended_barplot.pdf&quot;</span>,p_extended,<span class="at">width=</span><span class="dv">8</span>,<span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="figure/multiGSEA-barplot.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="radar-plot" class="section level4 hasAnchor" number="3.3.3.4">
<h4><span class="header-section-number">3.3.3.4</span> Radar plot<a href="r-function-mannual.html#radar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quantifying the agreement of different methods using radar diagrams.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="r-function-mannual.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb55-2"><a href="r-function-mannual.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb55-3"><a href="r-function-mannual.html#cb55-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-4"><a href="r-function-mannual.html#cb55-4" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span>
<span id="cb55-5"><a href="r-function-mannual.html#cb55-5" tabindex="-1"></a></span>
<span id="cb55-6"><a href="r-function-mannual.html#cb55-6" tabindex="-1"></a><span class="do">## Metabolite</span></span>
<span id="cb55-7"><a href="r-function-mannual.html#cb55-7" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="r-function-mannual.html#cb55-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="r-function-mannual.html#cb55-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-10"><a href="r-function-mannual.html#cb55-10" tabindex="-1"></a></span>
<span id="cb55-11"><a href="r-function-mannual.html#cb55-11" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="r-function-mannual.html#cb55-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-13"><a href="r-function-mannual.html#cb55-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-14"><a href="r-function-mannual.html#cb55-14" tabindex="-1"></a></span>
<span id="cb55-15"><a href="r-function-mannual.html#cb55-15" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-16"><a href="r-function-mannual.html#cb55-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-17"><a href="r-function-mannual.html#cb55-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-18"><a href="r-function-mannual.html#cb55-18" tabindex="-1"></a></span>
<span id="cb55-19"><a href="r-function-mannual.html#cb55-19" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb55-20"><a href="r-function-mannual.html#cb55-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb55-21"><a href="r-function-mannual.html#cb55-21" tabindex="-1"></a></span>
<span id="cb55-22"><a href="r-function-mannual.html#cb55-22" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-23"><a href="r-function-mannual.html#cb55-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-24"><a href="r-function-mannual.html#cb55-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb55-25"><a href="r-function-mannual.html#cb55-25" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-26"><a href="r-function-mannual.html#cb55-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-27"><a href="r-function-mannual.html#cb55-27" tabindex="-1"></a></span>
<span id="cb55-28"><a href="r-function-mannual.html#cb55-28" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-29"><a href="r-function-mannual.html#cb55-29" tabindex="-1"></a></span>
<span id="cb55-30"><a href="r-function-mannual.html#cb55-30" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-31"><a href="r-function-mannual.html#cb55-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-32"><a href="r-function-mannual.html#cb55-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-33"><a href="r-function-mannual.html#cb55-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-34"><a href="r-function-mannual.html#cb55-34" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-35"><a href="r-function-mannual.html#cb55-35" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-36"><a href="r-function-mannual.html#cb55-36" tabindex="-1"></a></span>
<span id="cb55-37"><a href="r-function-mannual.html#cb55-37" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-38"><a href="r-function-mannual.html#cb55-38" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-39"><a href="r-function-mannual.html#cb55-39" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-40"><a href="r-function-mannual.html#cb55-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-41"><a href="r-function-mannual.html#cb55-41" tabindex="-1"></a></span>
<span id="cb55-42"><a href="r-function-mannual.html#cb55-42" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-43"><a href="r-function-mannual.html#cb55-43" tabindex="-1"></a></span>
<span id="cb55-44"><a href="r-function-mannual.html#cb55-44" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-45"><a href="r-function-mannual.html#cb55-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-46"><a href="r-function-mannual.html#cb55-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-47"><a href="r-function-mannual.html#cb55-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-48"><a href="r-function-mannual.html#cb55-48" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-49"><a href="r-function-mannual.html#cb55-49" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-50"><a href="r-function-mannual.html#cb55-50" tabindex="-1"></a></span>
<span id="cb55-51"><a href="r-function-mannual.html#cb55-51" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_diff,dat_multigsea_same)</span>
<span id="cb55-52"><a href="r-function-mannual.html#cb55-52" tabindex="-1"></a></span>
<span id="cb55-53"><a href="r-function-mannual.html#cb55-53" tabindex="-1"></a>pathway_filter_metabolite <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-54"><a href="r-function-mannual.html#cb55-54" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-55"><a href="r-function-mannual.html#cb55-55" tabindex="-1"></a>  <span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-56"><a href="r-function-mannual.html#cb55-56" tabindex="-1"></a>  <span class="fu">pull</span>(pathway) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb55-57"><a href="r-function-mannual.html#cb55-57" tabindex="-1"></a></span>
<span id="cb55-58"><a href="r-function-mannual.html#cb55-58" tabindex="-1"></a>all_metabolite_filter <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-59"><a href="r-function-mannual.html#cb55-59" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-60"><a href="r-function-mannual.html#cb55-60" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_filter_metabolite)</span>
<span id="cb55-61"><a href="r-function-mannual.html#cb55-61" tabindex="-1"></a></span>
<span id="cb55-62"><a href="r-function-mannual.html#cb55-62" tabindex="-1"></a>all_metabolite_MNet <span class="ot">&lt;-</span> all_metabolite_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-63"><a href="r-function-mannual.html#cb55-63" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-64"><a href="r-function-mannual.html#cb55-64" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_metabolite)) <span class="sc">%&gt;%</span></span>
<span id="cb55-65"><a href="r-function-mannual.html#cb55-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-66"><a href="r-function-mannual.html#cb55-66" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-67"><a href="r-function-mannual.html#cb55-67" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-68"><a href="r-function-mannual.html#cb55-68" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;MNet&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-69"><a href="r-function-mannual.html#cb55-69" tabindex="-1"></a>all_metabolite_multiGSEA_samedatabase <span class="ot">&lt;-</span> all_metabolite_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-70"><a href="r-function-mannual.html#cb55-70" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-71"><a href="r-function-mannual.html#cb55-71" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_metabolite)) <span class="sc">%&gt;%</span></span>
<span id="cb55-72"><a href="r-function-mannual.html#cb55-72" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-73"><a href="r-function-mannual.html#cb55-73" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-74"><a href="r-function-mannual.html#cb55-74" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-75"><a href="r-function-mannual.html#cb55-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_samedatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-76"><a href="r-function-mannual.html#cb55-76" tabindex="-1"></a>all_metabolite_multiGSEA_diffdatabase <span class="ot">&lt;-</span> all_metabolite_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-77"><a href="r-function-mannual.html#cb55-77" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-78"><a href="r-function-mannual.html#cb55-78" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_metabolite)) <span class="sc">%&gt;%</span></span>
<span id="cb55-79"><a href="r-function-mannual.html#cb55-79" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-80"><a href="r-function-mannual.html#cb55-80" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-81"><a href="r-function-mannual.html#cb55-81" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-82"><a href="r-function-mannual.html#cb55-82" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_diffdatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-83"><a href="r-function-mannual.html#cb55-83" tabindex="-1"></a></span>
<span id="cb55-84"><a href="r-function-mannual.html#cb55-84" tabindex="-1"></a>d_min <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb55-85"><a href="r-function-mannual.html#cb55-85" tabindex="-1"></a>d_max <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">7</span>)</span>
<span id="cb55-86"><a href="r-function-mannual.html#cb55-86" tabindex="-1"></a></span>
<span id="cb55-87"><a href="r-function-mannual.html#cb55-87" tabindex="-1"></a>dd_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(d_max,d_min,all_metabolite_MNet,</span>
<span id="cb55-88"><a href="r-function-mannual.html#cb55-88" tabindex="-1"></a>                all_metabolite_multiGSEA_samedatabase,all_metabolite_multiGSEA_diffdatabase) <span class="sc">%&gt;%</span></span>
<span id="cb55-89"><a href="r-function-mannual.html#cb55-89" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-90"><a href="r-function-mannual.html#cb55-90" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb55-91"><a href="r-function-mannual.html#cb55-91" tabindex="-1"></a></span>
<span id="cb55-92"><a href="r-function-mannual.html#cb55-92" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">239</span>, <span class="dv">44</span>, <span class="dv">43</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-93"><a href="r-function-mannual.html#cb55-93" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">57</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-94"><a href="r-function-mannual.html#cb55-94" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">79</span>, <span class="dv">189</span>, <span class="dv">129</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb55-95"><a href="r-function-mannual.html#cb55-95" tabindex="-1"></a></span>
<span id="cb55-96"><a href="r-function-mannual.html#cb55-96" tabindex="-1"></a>colors1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>)</span>
<span id="cb55-97"><a href="r-function-mannual.html#cb55-97" tabindex="-1"></a></span>
<span id="cb55-98"><a href="r-function-mannual.html#cb55-98" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_metabolite_radar.pdf&quot;</span>,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb55-99"><a href="r-function-mannual.html#cb55-99" tabindex="-1"></a></span>
<span id="cb55-100"><a href="r-function-mannual.html#cb55-100" tabindex="-1"></a><span class="fu">radarchart</span>(</span>
<span id="cb55-101"><a href="r-function-mannual.html#cb55-101" tabindex="-1"></a>  dd_all,</span>
<span id="cb55-102"><a href="r-function-mannual.html#cb55-102" tabindex="-1"></a>  <span class="at">axistype =</span> <span class="dv">0</span>,        </span>
<span id="cb55-103"><a href="r-function-mannual.html#cb55-103" tabindex="-1"></a>  <span class="at">seg=</span><span class="dv">5</span>,</span>
<span id="cb55-104"><a href="r-function-mannual.html#cb55-104" tabindex="-1"></a>  <span class="at">pcol =</span> colors1,      </span>
<span id="cb55-105"><a href="r-function-mannual.html#cb55-105" tabindex="-1"></a>  <span class="at">pfcol =</span> colors,      </span>
<span id="cb55-106"><a href="r-function-mannual.html#cb55-106" tabindex="-1"></a>  <span class="at">plwd =</span> <span class="dv">2</span>,            </span>
<span id="cb55-107"><a href="r-function-mannual.html#cb55-107" tabindex="-1"></a>  <span class="at">plty =</span> <span class="dv">1</span>,            </span>
<span id="cb55-108"><a href="r-function-mannual.html#cb55-108" tabindex="-1"></a>  <span class="at">cglcol =</span> <span class="st">&quot;grey&quot;</span>,     </span>
<span id="cb55-109"><a href="r-function-mannual.html#cb55-109" tabindex="-1"></a>  <span class="at">cglty =</span> <span class="dv">1</span>,          </span>
<span id="cb55-110"><a href="r-function-mannual.html#cb55-110" tabindex="-1"></a>  <span class="at">cglwd =</span> <span class="fl">0.8</span>,         </span>
<span id="cb55-111"><a href="r-function-mannual.html#cb55-111" tabindex="-1"></a>  <span class="at">axislabcol =</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb55-112"><a href="r-function-mannual.html#cb55-112" tabindex="-1"></a>  <span class="at">vlcex =</span> <span class="fl">0.8</span>)</span>
<span id="cb55-113"><a href="r-function-mannual.html#cb55-113" tabindex="-1"></a></span>
<span id="cb55-114"><a href="r-function-mannual.html#cb55-114" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb55-115"><a href="r-function-mannual.html#cb55-115" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb55-116"><a href="r-function-mannual.html#cb55-116" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA_samedatabase&quot;</span>, <span class="st">&quot;multiGSEA_diffedatabase&quot;</span>),</span>
<span id="cb55-117"><a href="r-function-mannual.html#cb55-117" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb55-118"><a href="r-function-mannual.html#cb55-118" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb55-119"><a href="r-function-mannual.html#cb55-119" tabindex="-1"></a>  <span class="at">col =</span> colors1,</span>
<span id="cb55-120"><a href="r-function-mannual.html#cb55-120" tabindex="-1"></a>  <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb55-121"><a href="r-function-mannual.html#cb55-121" tabindex="-1"></a>  <span class="at">pt.cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb55-122"><a href="r-function-mannual.html#cb55-122" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb55-123"><a href="r-function-mannual.html#cb55-123" tabindex="-1"></a></span>
<span id="cb55-124"><a href="r-function-mannual.html#cb55-124" tabindex="-1"></a><span class="do">##  Gene</span></span>
<span id="cb55-125"><a href="r-function-mannual.html#cb55-125" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-126"><a href="r-function-mannual.html#cb55-126" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-127"><a href="r-function-mannual.html#cb55-127" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-128"><a href="r-function-mannual.html#cb55-128" tabindex="-1"></a></span>
<span id="cb55-129"><a href="r-function-mannual.html#cb55-129" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-130"><a href="r-function-mannual.html#cb55-130" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-131"><a href="r-function-mannual.html#cb55-131" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-132"><a href="r-function-mannual.html#cb55-132" tabindex="-1"></a></span>
<span id="cb55-133"><a href="r-function-mannual.html#cb55-133" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-134"><a href="r-function-mannual.html#cb55-134" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-135"><a href="r-function-mannual.html#cb55-135" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-136"><a href="r-function-mannual.html#cb55-136" tabindex="-1"></a></span>
<span id="cb55-137"><a href="r-function-mannual.html#cb55-137" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb55-138"><a href="r-function-mannual.html#cb55-138" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb55-139"><a href="r-function-mannual.html#cb55-139" tabindex="-1"></a></span>
<span id="cb55-140"><a href="r-function-mannual.html#cb55-140" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-141"><a href="r-function-mannual.html#cb55-141" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-142"><a href="r-function-mannual.html#cb55-142" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb55-143"><a href="r-function-mannual.html#cb55-143" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-144"><a href="r-function-mannual.html#cb55-144" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-145"><a href="r-function-mannual.html#cb55-145" tabindex="-1"></a></span>
<span id="cb55-146"><a href="r-function-mannual.html#cb55-146" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-147"><a href="r-function-mannual.html#cb55-147" tabindex="-1"></a></span>
<span id="cb55-148"><a href="r-function-mannual.html#cb55-148" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-149"><a href="r-function-mannual.html#cb55-149" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-150"><a href="r-function-mannual.html#cb55-150" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-151"><a href="r-function-mannual.html#cb55-151" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-152"><a href="r-function-mannual.html#cb55-152" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-153"><a href="r-function-mannual.html#cb55-153" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-154"><a href="r-function-mannual.html#cb55-154" tabindex="-1"></a></span>
<span id="cb55-155"><a href="r-function-mannual.html#cb55-155" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-156"><a href="r-function-mannual.html#cb55-156" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-157"><a href="r-function-mannual.html#cb55-157" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-158"><a href="r-function-mannual.html#cb55-158" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-159"><a href="r-function-mannual.html#cb55-159" tabindex="-1"></a></span>
<span id="cb55-160"><a href="r-function-mannual.html#cb55-160" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-161"><a href="r-function-mannual.html#cb55-161" tabindex="-1"></a></span>
<span id="cb55-162"><a href="r-function-mannual.html#cb55-162" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-163"><a href="r-function-mannual.html#cb55-163" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-164"><a href="r-function-mannual.html#cb55-164" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-165"><a href="r-function-mannual.html#cb55-165" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-166"><a href="r-function-mannual.html#cb55-166" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-167"><a href="r-function-mannual.html#cb55-167" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-168"><a href="r-function-mannual.html#cb55-168" tabindex="-1"></a></span>
<span id="cb55-169"><a href="r-function-mannual.html#cb55-169" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_diff,dat_multigsea_same)</span>
<span id="cb55-170"><a href="r-function-mannual.html#cb55-170" tabindex="-1"></a></span>
<span id="cb55-171"><a href="r-function-mannual.html#cb55-171" tabindex="-1"></a>pathway_filter_gene <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-172"><a href="r-function-mannual.html#cb55-172" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-173"><a href="r-function-mannual.html#cb55-173" tabindex="-1"></a>  <span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-174"><a href="r-function-mannual.html#cb55-174" tabindex="-1"></a>  <span class="fu">pull</span>(pathway) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb55-175"><a href="r-function-mannual.html#cb55-175" tabindex="-1"></a></span>
<span id="cb55-176"><a href="r-function-mannual.html#cb55-176" tabindex="-1"></a>all_gene_filter <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-177"><a href="r-function-mannual.html#cb55-177" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-178"><a href="r-function-mannual.html#cb55-178" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_filter_gene)</span>
<span id="cb55-179"><a href="r-function-mannual.html#cb55-179" tabindex="-1"></a></span>
<span id="cb55-180"><a href="r-function-mannual.html#cb55-180" tabindex="-1"></a>all_gene_MNet <span class="ot">&lt;-</span> all_gene_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-181"><a href="r-function-mannual.html#cb55-181" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-182"><a href="r-function-mannual.html#cb55-182" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_gene)) <span class="sc">%&gt;%</span></span>
<span id="cb55-183"><a href="r-function-mannual.html#cb55-183" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-184"><a href="r-function-mannual.html#cb55-184" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-185"><a href="r-function-mannual.html#cb55-185" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-186"><a href="r-function-mannual.html#cb55-186" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;MNet&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-187"><a href="r-function-mannual.html#cb55-187" tabindex="-1"></a>all_gene_multiGSEA_samedatabase <span class="ot">&lt;-</span> all_gene_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-188"><a href="r-function-mannual.html#cb55-188" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-189"><a href="r-function-mannual.html#cb55-189" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_gene)) <span class="sc">%&gt;%</span></span>
<span id="cb55-190"><a href="r-function-mannual.html#cb55-190" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-191"><a href="r-function-mannual.html#cb55-191" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-192"><a href="r-function-mannual.html#cb55-192" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-193"><a href="r-function-mannual.html#cb55-193" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_samedatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-194"><a href="r-function-mannual.html#cb55-194" tabindex="-1"></a>all_gene_multiGSEA_diffdatabase <span class="ot">&lt;-</span> all_gene_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-195"><a href="r-function-mannual.html#cb55-195" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-196"><a href="r-function-mannual.html#cb55-196" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_gene)) <span class="sc">%&gt;%</span></span>
<span id="cb55-197"><a href="r-function-mannual.html#cb55-197" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-198"><a href="r-function-mannual.html#cb55-198" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-199"><a href="r-function-mannual.html#cb55-199" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(pval),<span class="fl">0.000001</span>,pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-200"><a href="r-function-mannual.html#cb55-200" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-201"><a href="r-function-mannual.html#cb55-201" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_diffdatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-202"><a href="r-function-mannual.html#cb55-202" tabindex="-1"></a></span>
<span id="cb55-203"><a href="r-function-mannual.html#cb55-203" tabindex="-1"></a>d_min <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb55-204"><a href="r-function-mannual.html#cb55-204" tabindex="-1"></a>d_max <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb55-205"><a href="r-function-mannual.html#cb55-205" tabindex="-1"></a></span>
<span id="cb55-206"><a href="r-function-mannual.html#cb55-206" tabindex="-1"></a>dd_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(d_max,d_min,all_gene_MNet,</span>
<span id="cb55-207"><a href="r-function-mannual.html#cb55-207" tabindex="-1"></a>                all_gene_multiGSEA_samedatabase,all_gene_multiGSEA_diffdatabase) <span class="sc">%&gt;%</span></span>
<span id="cb55-208"><a href="r-function-mannual.html#cb55-208" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-209"><a href="r-function-mannual.html#cb55-209" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb55-210"><a href="r-function-mannual.html#cb55-210" tabindex="-1"></a></span>
<span id="cb55-211"><a href="r-function-mannual.html#cb55-211" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">239</span>, <span class="dv">44</span>, <span class="dv">43</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-212"><a href="r-function-mannual.html#cb55-212" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">57</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-213"><a href="r-function-mannual.html#cb55-213" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">79</span>, <span class="dv">189</span>, <span class="dv">129</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb55-214"><a href="r-function-mannual.html#cb55-214" tabindex="-1"></a></span>
<span id="cb55-215"><a href="r-function-mannual.html#cb55-215" tabindex="-1"></a>colors1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>)</span>
<span id="cb55-216"><a href="r-function-mannual.html#cb55-216" tabindex="-1"></a></span>
<span id="cb55-217"><a href="r-function-mannual.html#cb55-217" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_gene_radar.pdf&quot;</span>,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb55-218"><a href="r-function-mannual.html#cb55-218" tabindex="-1"></a></span>
<span id="cb55-219"><a href="r-function-mannual.html#cb55-219" tabindex="-1"></a><span class="fu">radarchart</span>(</span>
<span id="cb55-220"><a href="r-function-mannual.html#cb55-220" tabindex="-1"></a>  dd_all,</span>
<span id="cb55-221"><a href="r-function-mannual.html#cb55-221" tabindex="-1"></a>  <span class="at">axistype =</span> <span class="dv">0</span>,     </span>
<span id="cb55-222"><a href="r-function-mannual.html#cb55-222" tabindex="-1"></a>  <span class="at">seg=</span><span class="dv">5</span>,</span>
<span id="cb55-223"><a href="r-function-mannual.html#cb55-223" tabindex="-1"></a>  <span class="at">pcol =</span> colors1,      </span>
<span id="cb55-224"><a href="r-function-mannual.html#cb55-224" tabindex="-1"></a>  <span class="at">pfcol =</span> colors,      </span>
<span id="cb55-225"><a href="r-function-mannual.html#cb55-225" tabindex="-1"></a>  <span class="at">plwd =</span> <span class="dv">2</span>,            </span>
<span id="cb55-226"><a href="r-function-mannual.html#cb55-226" tabindex="-1"></a>  <span class="at">plty =</span> <span class="dv">1</span>,            </span>
<span id="cb55-227"><a href="r-function-mannual.html#cb55-227" tabindex="-1"></a>  <span class="at">cglcol =</span> <span class="st">&quot;grey&quot;</span>,    </span>
<span id="cb55-228"><a href="r-function-mannual.html#cb55-228" tabindex="-1"></a>  <span class="at">cglty =</span> <span class="dv">1</span>,           </span>
<span id="cb55-229"><a href="r-function-mannual.html#cb55-229" tabindex="-1"></a>  <span class="at">cglwd =</span> <span class="fl">0.8</span>,         </span>
<span id="cb55-230"><a href="r-function-mannual.html#cb55-230" tabindex="-1"></a>  <span class="at">axislabcol =</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb55-231"><a href="r-function-mannual.html#cb55-231" tabindex="-1"></a>  <span class="at">vlcex =</span> <span class="fl">0.8</span>)</span>
<span id="cb55-232"><a href="r-function-mannual.html#cb55-232" tabindex="-1"></a></span>
<span id="cb55-233"><a href="r-function-mannual.html#cb55-233" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb55-234"><a href="r-function-mannual.html#cb55-234" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb55-235"><a href="r-function-mannual.html#cb55-235" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA_samedatabase&quot;</span>, <span class="st">&quot;multiGSEA_diffedatabase&quot;</span>),</span>
<span id="cb55-236"><a href="r-function-mannual.html#cb55-236" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb55-237"><a href="r-function-mannual.html#cb55-237" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb55-238"><a href="r-function-mannual.html#cb55-238" tabindex="-1"></a>  <span class="at">col =</span> colors1,</span>
<span id="cb55-239"><a href="r-function-mannual.html#cb55-239" tabindex="-1"></a>  <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb55-240"><a href="r-function-mannual.html#cb55-240" tabindex="-1"></a>  <span class="at">pt.cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb55-241"><a href="r-function-mannual.html#cb55-241" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb55-242"><a href="r-function-mannual.html#cb55-242" tabindex="-1"></a></span>
<span id="cb55-243"><a href="r-function-mannual.html#cb55-243" tabindex="-1"></a><span class="do">##  Extended</span></span>
<span id="cb55-244"><a href="r-function-mannual.html#cb55-244" tabindex="-1"></a>dat_mnet_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_transcriptome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-245"><a href="r-function-mannual.html#cb55-245" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-246"><a href="r-function-mannual.html#cb55-246" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-247"><a href="r-function-mannual.html#cb55-247" tabindex="-1"></a></span>
<span id="cb55-248"><a href="r-function-mannual.html#cb55-248" tabindex="-1"></a>dat_mnet_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_metabolome.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-249"><a href="r-function-mannual.html#cb55-249" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-250"><a href="r-function-mannual.html#cb55-250" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-251"><a href="r-function-mannual.html#cb55-251" tabindex="-1"></a></span>
<span id="cb55-252"><a href="r-function-mannual.html#cb55-252" tabindex="-1"></a>dat_mnet_extended <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/MNet_GSEA_extended.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-253"><a href="r-function-mannual.html#cb55-253" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-254"><a href="r-function-mannual.html#cb55-254" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;extended&quot;</span>,<span class="at">software=</span><span class="st">&quot;MNet&quot;</span>)</span>
<span id="cb55-255"><a href="r-function-mannual.html#cb55-255" tabindex="-1"></a></span>
<span id="cb55-256"><a href="r-function-mannual.html#cb55-256" tabindex="-1"></a>dat_mnet_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_gene,dat_mnet_metabolite,dat_mnet_extended) <span class="sc">%&gt;%</span></span>
<span id="cb55-257"><a href="r-function-mannual.html#cb55-257" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,type,software)</span>
<span id="cb55-258"><a href="r-function-mannual.html#cb55-258" tabindex="-1"></a></span>
<span id="cb55-259"><a href="r-function-mannual.html#cb55-259" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-diff.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-260"><a href="r-function-mannual.html#cb55-260" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-261"><a href="r-function-mannual.html#cb55-261" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">substr</span>(pathway, <span class="dv">8</span>, <span class="fu">nchar</span>(pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb55-262"><a href="r-function-mannual.html#cb55-262" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-263"><a href="r-function-mannual.html#cb55-263" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-264"><a href="r-function-mannual.html#cb55-264" tabindex="-1"></a></span>
<span id="cb55-265"><a href="r-function-mannual.html#cb55-265" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-266"><a href="r-function-mannual.html#cb55-266" tabindex="-1"></a></span>
<span id="cb55-267"><a href="r-function-mannual.html#cb55-267" tabindex="-1"></a>dat_multigsea_diff <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-268"><a href="r-function-mannual.html#cb55-268" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-269"><a href="r-function-mannual.html#cb55-269" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-270"><a href="r-function-mannual.html#cb55-270" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-271"><a href="r-function-mannual.html#cb55-271" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-272"><a href="r-function-mannual.html#cb55-272" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-273"><a href="r-function-mannual.html#cb55-273" tabindex="-1"></a></span>
<span id="cb55-274"><a href="r-function-mannual.html#cb55-274" tabindex="-1"></a>dat_multigsea <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/GSEA/multiGSEA-same.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-275"><a href="r-function-mannual.html#cb55-275" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-276"><a href="r-function-mannual.html#cb55-276" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>kegg_pathwayname) <span class="sc">%&gt;%</span></span>
<span id="cb55-277"><a href="r-function-mannual.html#cb55-277" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,transcriptome_pval,metabolome_pval,combined_pval)</span>
<span id="cb55-278"><a href="r-function-mannual.html#cb55-278" tabindex="-1"></a></span>
<span id="cb55-279"><a href="r-function-mannual.html#cb55-279" tabindex="-1"></a>dat_multigsea_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat_multigsea,<span class="at">id=</span><span class="st">&quot;pathway&quot;</span>)</span>
<span id="cb55-280"><a href="r-function-mannual.html#cb55-280" tabindex="-1"></a></span>
<span id="cb55-281"><a href="r-function-mannual.html#cb55-281" tabindex="-1"></a>dat_multigsea_same <span class="ot">&lt;-</span> dat_multigsea_melt <span class="sc">%&gt;%</span></span>
<span id="cb55-282"><a href="r-function-mannual.html#cb55-282" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pval&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>,<span class="st">&quot;type&quot;</span><span class="ot">=</span><span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-283"><a href="r-function-mannual.html#cb55-283" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">software=</span><span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-284"><a href="r-function-mannual.html#cb55-284" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;transcriptome_pval&quot;</span>,<span class="st">&quot;gene&quot;</span>,</span>
<span id="cb55-285"><a href="r-function-mannual.html#cb55-285" tabindex="-1"></a>                            <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;metabolome_pval&quot;</span>,<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb55-286"><a href="r-function-mannual.html#cb55-286" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;combined_pval&quot;</span>,<span class="st">&quot;extended&quot;</span>,<span class="st">&quot;jj&quot;</span>))))</span>
<span id="cb55-287"><a href="r-function-mannual.html#cb55-287" tabindex="-1"></a></span>
<span id="cb55-288"><a href="r-function-mannual.html#cb55-288" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_mnet_all,dat_multigsea_diff,dat_multigsea_same)</span>
<span id="cb55-289"><a href="r-function-mannual.html#cb55-289" tabindex="-1"></a></span>
<span id="cb55-290"><a href="r-function-mannual.html#cb55-290" tabindex="-1"></a>pathway_filter_extended <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-291"><a href="r-function-mannual.html#cb55-291" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;extended&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-292"><a href="r-function-mannual.html#cb55-292" tabindex="-1"></a>  <span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-293"><a href="r-function-mannual.html#cb55-293" tabindex="-1"></a>  <span class="fu">pull</span>(pathway) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb55-294"><a href="r-function-mannual.html#cb55-294" tabindex="-1"></a></span>
<span id="cb55-295"><a href="r-function-mannual.html#cb55-295" tabindex="-1"></a>all_extended_filter <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb55-296"><a href="r-function-mannual.html#cb55-296" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;extended&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-297"><a href="r-function-mannual.html#cb55-297" tabindex="-1"></a>  <span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_filter_extended)</span>
<span id="cb55-298"><a href="r-function-mannual.html#cb55-298" tabindex="-1"></a></span>
<span id="cb55-299"><a href="r-function-mannual.html#cb55-299" tabindex="-1"></a>all_extended_MNet <span class="ot">&lt;-</span> all_extended_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-300"><a href="r-function-mannual.html#cb55-300" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;MNet&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-301"><a href="r-function-mannual.html#cb55-301" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_extended)) <span class="sc">%&gt;%</span></span>
<span id="cb55-302"><a href="r-function-mannual.html#cb55-302" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-303"><a href="r-function-mannual.html#cb55-303" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-304"><a href="r-function-mannual.html#cb55-304" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-305"><a href="r-function-mannual.html#cb55-305" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;MNet&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-306"><a href="r-function-mannual.html#cb55-306" tabindex="-1"></a>all_extended_multiGSEA_samedatabase <span class="ot">&lt;-</span> all_extended_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-307"><a href="r-function-mannual.html#cb55-307" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-samedatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-308"><a href="r-function-mannual.html#cb55-308" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_extended)) <span class="sc">%&gt;%</span></span>
<span id="cb55-309"><a href="r-function-mannual.html#cb55-309" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-310"><a href="r-function-mannual.html#cb55-310" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-311"><a href="r-function-mannual.html#cb55-311" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-312"><a href="r-function-mannual.html#cb55-312" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_samedatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-313"><a href="r-function-mannual.html#cb55-313" tabindex="-1"></a>all_extended_multiGSEA_diffdatabase <span class="ot">&lt;-</span> all_extended_filter <span class="sc">%&gt;%</span></span>
<span id="cb55-314"><a href="r-function-mannual.html#cb55-314" tabindex="-1"></a>  <span class="fu">filter</span>(software <span class="sc">==</span> <span class="st">&quot;multiGSEA-diffdatabase&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-315"><a href="r-function-mannual.html#cb55-315" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(pathway,pathway_filter_extended)) <span class="sc">%&gt;%</span></span>
<span id="cb55-316"><a href="r-function-mannual.html#cb55-316" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pval,pathway) <span class="sc">%&gt;%</span></span>
<span id="cb55-317"><a href="r-function-mannual.html#cb55-317" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="sc">-</span><span class="fu">log10</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-318"><a href="r-function-mannual.html#cb55-318" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pval=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(pval),<span class="fl">0.000001</span>,pval)) <span class="sc">%&gt;%</span></span>
<span id="cb55-319"><a href="r-function-mannual.html#cb55-319" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-320"><a href="r-function-mannual.html#cb55-320" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;multiGSEA_diffdatabase&quot;</span><span class="ot">=</span><span class="st">&quot;pval&quot;</span>)</span>
<span id="cb55-321"><a href="r-function-mannual.html#cb55-321" tabindex="-1"></a></span>
<span id="cb55-322"><a href="r-function-mannual.html#cb55-322" tabindex="-1"></a>d_min <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>)</span>
<span id="cb55-323"><a href="r-function-mannual.html#cb55-323" tabindex="-1"></a>d_max <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">5</span>,<span class="dv">9</span>)</span>
<span id="cb55-324"><a href="r-function-mannual.html#cb55-324" tabindex="-1"></a></span>
<span id="cb55-325"><a href="r-function-mannual.html#cb55-325" tabindex="-1"></a>dd_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(d_max,d_min,all_extended_MNet,</span>
<span id="cb55-326"><a href="r-function-mannual.html#cb55-326" tabindex="-1"></a>                all_extended_multiGSEA_samedatabase,all_extended_multiGSEA_diffdatabase) <span class="sc">%&gt;%</span></span>
<span id="cb55-327"><a href="r-function-mannual.html#cb55-327" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-328"><a href="r-function-mannual.html#cb55-328" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb55-329"><a href="r-function-mannual.html#cb55-329" tabindex="-1"></a></span>
<span id="cb55-330"><a href="r-function-mannual.html#cb55-330" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">239</span>, <span class="dv">44</span>, <span class="dv">43</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-331"><a href="r-function-mannual.html#cb55-331" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">57</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>),</span>
<span id="cb55-332"><a href="r-function-mannual.html#cb55-332" tabindex="-1"></a>            <span class="fu">rgb</span>(<span class="dv">79</span>, <span class="dv">189</span>, <span class="dv">129</span>,<span class="at">alpha=</span><span class="dv">100</span>,<span class="at">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb55-333"><a href="r-function-mannual.html#cb55-333" tabindex="-1"></a></span>
<span id="cb55-334"><a href="r-function-mannual.html#cb55-334" tabindex="-1"></a>colors1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#EF2C2B&quot;</span>,<span class="st">&quot;#FFC839&quot;</span>,<span class="st">&quot;#4FBD81&quot;</span>)</span>
<span id="cb55-335"><a href="r-function-mannual.html#cb55-335" tabindex="-1"></a></span>
<span id="cb55-336"><a href="r-function-mannual.html#cb55-336" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/GSEA/GSEA_extended_radar.pdf&quot;</span>,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb55-337"><a href="r-function-mannual.html#cb55-337" tabindex="-1"></a></span>
<span id="cb55-338"><a href="r-function-mannual.html#cb55-338" tabindex="-1"></a><span class="fu">radarchart</span>(</span>
<span id="cb55-339"><a href="r-function-mannual.html#cb55-339" tabindex="-1"></a>  dd_all,</span>
<span id="cb55-340"><a href="r-function-mannual.html#cb55-340" tabindex="-1"></a>  <span class="at">axistype =</span> <span class="dv">0</span>,        </span>
<span id="cb55-341"><a href="r-function-mannual.html#cb55-341" tabindex="-1"></a>  <span class="at">seg=</span><span class="dv">5</span>,</span>
<span id="cb55-342"><a href="r-function-mannual.html#cb55-342" tabindex="-1"></a>  <span class="at">pcol =</span> colors1,      </span>
<span id="cb55-343"><a href="r-function-mannual.html#cb55-343" tabindex="-1"></a>  <span class="at">pfcol =</span> colors,      </span>
<span id="cb55-344"><a href="r-function-mannual.html#cb55-344" tabindex="-1"></a>  <span class="at">plwd =</span> <span class="dv">2</span>,            </span>
<span id="cb55-345"><a href="r-function-mannual.html#cb55-345" tabindex="-1"></a>  <span class="at">plty =</span> <span class="dv">1</span>,            </span>
<span id="cb55-346"><a href="r-function-mannual.html#cb55-346" tabindex="-1"></a>  <span class="at">cglcol =</span> <span class="st">&quot;grey&quot;</span>,     </span>
<span id="cb55-347"><a href="r-function-mannual.html#cb55-347" tabindex="-1"></a>  <span class="at">cglty =</span> <span class="dv">1</span>,           </span>
<span id="cb55-348"><a href="r-function-mannual.html#cb55-348" tabindex="-1"></a>  <span class="at">cglwd =</span> <span class="fl">0.8</span>,         </span>
<span id="cb55-349"><a href="r-function-mannual.html#cb55-349" tabindex="-1"></a>  <span class="at">axislabcol =</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb55-350"><a href="r-function-mannual.html#cb55-350" tabindex="-1"></a>  <span class="at">vlcex =</span> <span class="fl">0.8</span>)</span>
<span id="cb55-351"><a href="r-function-mannual.html#cb55-351" tabindex="-1"></a></span>
<span id="cb55-352"><a href="r-function-mannual.html#cb55-352" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb55-353"><a href="r-function-mannual.html#cb55-353" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb55-354"><a href="r-function-mannual.html#cb55-354" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;MNet&quot;</span>,<span class="st">&quot;multiGSEA_samedatabase&quot;</span>, <span class="st">&quot;multiGSEA_diffedatabase&quot;</span>),</span>
<span id="cb55-355"><a href="r-function-mannual.html#cb55-355" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb55-356"><a href="r-function-mannual.html#cb55-356" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb55-357"><a href="r-function-mannual.html#cb55-357" tabindex="-1"></a>  <span class="at">col =</span> colors1,</span>
<span id="cb55-358"><a href="r-function-mannual.html#cb55-358" tabindex="-1"></a>  <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb55-359"><a href="r-function-mannual.html#cb55-359" tabindex="-1"></a>  <span class="at">pt.cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb55-360"><a href="r-function-mannual.html#cb55-360" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figure/multiGSEA-radar.png" width="1142" style="display: block; margin: auto;" /></p>
</div>
<div id="glycerophospholipid-metabolism" class="section level4 hasAnchor" number="3.3.3.5">
<h4><span class="header-section-number">3.3.3.5</span> Glycerophospholipid metabolism<a href="r-function-mannual.html#glycerophospholipid-metabolism" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using MNet to analyze the Glycerophospholipid metabolism pathway.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="r-function-mannual.html#cb56-1" tabindex="-1"></a><span class="fu">library</span>(multiGSEA)</span>
<span id="cb56-2"><a href="r-function-mannual.html#cb56-2" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span>
<span id="cb56-3"><a href="r-function-mannual.html#cb56-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-4"><a href="r-function-mannual.html#cb56-4" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb56-5"><a href="r-function-mannual.html#cb56-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-6"><a href="r-function-mannual.html#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="r-function-mannual.html#cb56-7" tabindex="-1"></a><span class="fu">data</span>(transcriptome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb56-8"><a href="r-function-mannual.html#cb56-8" tabindex="-1"></a><span class="fu">data</span>(metabolome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb56-9"><a href="r-function-mannual.html#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="r-function-mannual.html#cb56-10" tabindex="-1"></a>ah <span class="ot">&lt;-</span> AnnotationHub<span class="sc">::</span><span class="fu">AnnotationHub</span>()</span>
<span id="cb56-11"><a href="r-function-mannual.html#cb56-11" tabindex="-1"></a>aa <span class="ot">&lt;-</span> ah[[<span class="st">&quot;AH91792&quot;</span>]]</span>
<span id="cb56-12"><a href="r-function-mannual.html#cb56-12" tabindex="-1"></a>metabolome_1 <span class="ot">&lt;-</span> metabolome <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="r-function-mannual.html#cb56-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HMDB=</span><span class="fu">gsub</span>(<span class="st">&quot;HMDB&quot;</span>,<span class="st">&quot;HMDB00&quot;</span>,HMDB)) <span class="sc">%&gt;%</span></span>
<span id="cb56-14"><a href="r-function-mannual.html#cb56-14" tabindex="-1"></a>  <span class="fu">left_join</span>(aa,<span class="at">by=</span><span class="st">&quot;HMDB&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-15"><a href="r-function-mannual.html#cb56-15" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG)) <span class="sc">%&gt;%</span></span>
<span id="cb56-16"><a href="r-function-mannual.html#cb56-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="r-function-mannual.html#cb56-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HMDB,logFC,pValue,KEGG,HMDB) <span class="sc">%&gt;%</span></span>
<span id="cb56-18"><a href="r-function-mannual.html#cb56-18" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-19"><a href="r-function-mannual.html#cb56-19" tabindex="-1"></a>  <span class="fu">filter</span>(KEGG <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="r-function-mannual.html#cb56-20" tabindex="-1"></a>  <span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb56-21"><a href="r-function-mannual.html#cb56-21" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb56-22"><a href="r-function-mannual.html#cb56-22" tabindex="-1"></a>  <span class="fu">distinct</span>(logFC,<span class="at">.keep_all =</span> T)</span>
<span id="cb56-23"><a href="r-function-mannual.html#cb56-23" tabindex="-1"></a></span>
<span id="cb56-24"><a href="r-function-mannual.html#cb56-24" tabindex="-1"></a>dat_metabolome <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>logFC</span>
<span id="cb56-25"><a href="r-function-mannual.html#cb56-25" tabindex="-1"></a><span class="fu">names</span>(dat_metabolome) <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>KEGG</span>
<span id="cb56-26"><a href="r-function-mannual.html#cb56-26" tabindex="-1"></a></span>
<span id="cb56-27"><a href="r-function-mannual.html#cb56-27" tabindex="-1"></a>p_Glycerophospholipid_metabolite <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Glycerophospholipid metabolism&quot;</span>,dat_metabolome,<span class="at">out =</span> <span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb56-28"><a href="r-function-mannual.html#cb56-28" tabindex="-1"></a></span>
<span id="cb56-29"><a href="r-function-mannual.html#cb56-29" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb56-30"><a href="r-function-mannual.html#cb56-30" tabindex="-1"></a>transcriptome_temp <span class="ot">&lt;-</span> transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb56-31"><a href="r-function-mannual.html#cb56-31" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-32"><a href="r-function-mannual.html#cb56-32" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb56-33"><a href="r-function-mannual.html#cb56-33" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb56-34"><a href="r-function-mannual.html#cb56-34" tabindex="-1"></a>dat_transcriptome <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>logFC</span>
<span id="cb56-35"><a href="r-function-mannual.html#cb56-35" tabindex="-1"></a><span class="fu">names</span>(dat_transcriptome) <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>Symbol</span>
<span id="cb56-36"><a href="r-function-mannual.html#cb56-36" tabindex="-1"></a>p_Glycerophospholipid_gene <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Glycerophospholipid metabolism&quot;</span>,dat_transcriptome,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb56-37"><a href="r-function-mannual.html#cb56-37" tabindex="-1"></a></span>
<span id="cb56-38"><a href="r-function-mannual.html#cb56-38" tabindex="-1"></a><span class="do">## metabolite and gene</span></span>
<span id="cb56-39"><a href="r-function-mannual.html#cb56-39" tabindex="-1"></a>dat_all_temp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(metabolome_1 <span class="sc">%&gt;%</span></span>
<span id="cb56-40"><a href="r-function-mannual.html#cb56-40" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(KEGG,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb56-41"><a href="r-function-mannual.html#cb56-41" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG&quot;</span>),</span>
<span id="cb56-42"><a href="r-function-mannual.html#cb56-42" tabindex="-1"></a>                      transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb56-43"><a href="r-function-mannual.html#cb56-43" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-44"><a href="r-function-mannual.html#cb56-44" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(Symbol,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb56-45"><a href="r-function-mannual.html#cb56-45" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Symbol&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-46"><a href="r-function-mannual.html#cb56-46" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb56-47"><a href="r-function-mannual.html#cb56-47" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb56-48"><a href="r-function-mannual.html#cb56-48" tabindex="-1"></a></span>
<span id="cb56-49"><a href="r-function-mannual.html#cb56-49" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>logFC</span>
<span id="cb56-50"><a href="r-function-mannual.html#cb56-50" tabindex="-1"></a><span class="fu">names</span>(dat_all) <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>name</span>
<span id="cb56-51"><a href="r-function-mannual.html#cb56-51" tabindex="-1"></a></span>
<span id="cb56-52"><a href="r-function-mannual.html#cb56-52" tabindex="-1"></a>p_Glycerophospholipid_extended <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Glycerophospholipid metabolism&quot;</span>,dat_all,<span class="at">out =</span> <span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb56-53"><a href="r-function-mannual.html#cb56-53" tabindex="-1"></a></span>
<span id="cb56-54"><a href="r-function-mannual.html#cb56-54" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Glycerophospholipid_metabolite.pdf&quot;</span>,p_Glycerophospholipid_metabolite,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb56-55"><a href="r-function-mannual.html#cb56-55" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Glycerophospholipid_gene.pdf&quot;</span>,p_Glycerophospholipid_gene,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb56-56"><a href="r-function-mannual.html#cb56-56" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Glycerophospholipid_extended.pdf&quot;</span>,p_Glycerophospholipid_extended,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/multiGSEA-Glycerophospholipid.png" width="1164" style="display: block; margin: auto;" /></p>
</div>
<div id="propanoate-metabolism" class="section level4 hasAnchor" number="3.3.3.6">
<h4><span class="header-section-number">3.3.3.6</span> Propanoate metabolism<a href="r-function-mannual.html#propanoate-metabolism" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using MNet to analyze the Propanoate metabolism pathway.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="r-function-mannual.html#cb57-1" tabindex="-1"></a><span class="fu">data</span>(transcriptome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb57-2"><a href="r-function-mannual.html#cb57-2" tabindex="-1"></a><span class="fu">data</span>(metabolome,<span class="at">package=</span><span class="st">&quot;multiGSEA&quot;</span>)</span>
<span id="cb57-3"><a href="r-function-mannual.html#cb57-3" tabindex="-1"></a></span>
<span id="cb57-4"><a href="r-function-mannual.html#cb57-4" tabindex="-1"></a>ah <span class="ot">&lt;-</span> AnnotationHub<span class="sc">::</span><span class="fu">AnnotationHub</span>()</span>
<span id="cb57-5"><a href="r-function-mannual.html#cb57-5" tabindex="-1"></a>aa <span class="ot">&lt;-</span> ah[[<span class="st">&quot;AH91792&quot;</span>]]</span>
<span id="cb57-6"><a href="r-function-mannual.html#cb57-6" tabindex="-1"></a>metabolome_1 <span class="ot">&lt;-</span> metabolome <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="r-function-mannual.html#cb57-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HMDB=</span><span class="fu">gsub</span>(<span class="st">&quot;HMDB&quot;</span>,<span class="st">&quot;HMDB00&quot;</span>,HMDB)) <span class="sc">%&gt;%</span></span>
<span id="cb57-8"><a href="r-function-mannual.html#cb57-8" tabindex="-1"></a>  <span class="fu">left_join</span>(aa,<span class="at">by=</span><span class="st">&quot;HMDB&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-9"><a href="r-function-mannual.html#cb57-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG)) <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="r-function-mannual.html#cb57-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="r-function-mannual.html#cb57-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HMDB,logFC,pValue,KEGG,HMDB) <span class="sc">%&gt;%</span></span>
<span id="cb57-12"><a href="r-function-mannual.html#cb57-12" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-13"><a href="r-function-mannual.html#cb57-13" tabindex="-1"></a>  <span class="fu">filter</span>(KEGG <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb57-14"><a href="r-function-mannual.html#cb57-14" tabindex="-1"></a>  <span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb57-15"><a href="r-function-mannual.html#cb57-15" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb57-16"><a href="r-function-mannual.html#cb57-16" tabindex="-1"></a>  <span class="fu">distinct</span>(logFC,<span class="at">.keep_all =</span> T)</span>
<span id="cb57-17"><a href="r-function-mannual.html#cb57-17" tabindex="-1"></a></span>
<span id="cb57-18"><a href="r-function-mannual.html#cb57-18" tabindex="-1"></a>dat_metabolome <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>logFC</span>
<span id="cb57-19"><a href="r-function-mannual.html#cb57-19" tabindex="-1"></a><span class="fu">names</span>(dat_metabolome) <span class="ot">&lt;-</span> metabolome_1<span class="sc">$</span>KEGG</span>
<span id="cb57-20"><a href="r-function-mannual.html#cb57-20" tabindex="-1"></a></span>
<span id="cb57-21"><a href="r-function-mannual.html#cb57-21" tabindex="-1"></a>p_Propanoate_metabolite <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Propanoate metabolism&quot;</span>,dat_metabolome,<span class="at">out =</span> <span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb57-22"><a href="r-function-mannual.html#cb57-22" tabindex="-1"></a></span>
<span id="cb57-23"><a href="r-function-mannual.html#cb57-23" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb57-24"><a href="r-function-mannual.html#cb57-24" tabindex="-1"></a>transcriptome_temp <span class="ot">&lt;-</span> transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb57-25"><a href="r-function-mannual.html#cb57-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-26"><a href="r-function-mannual.html#cb57-26" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb57-27"><a href="r-function-mannual.html#cb57-27" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb57-28"><a href="r-function-mannual.html#cb57-28" tabindex="-1"></a>dat_transcriptome <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>logFC</span>
<span id="cb57-29"><a href="r-function-mannual.html#cb57-29" tabindex="-1"></a><span class="fu">names</span>(dat_transcriptome) <span class="ot">&lt;-</span> transcriptome_temp<span class="sc">$</span>Symbol</span>
<span id="cb57-30"><a href="r-function-mannual.html#cb57-30" tabindex="-1"></a>p_Propanoate_gene <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Propanoate metabolism&quot;</span>,dat_transcriptome,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb57-31"><a href="r-function-mannual.html#cb57-31" tabindex="-1"></a></span>
<span id="cb57-32"><a href="r-function-mannual.html#cb57-32" tabindex="-1"></a><span class="do">## metabolite and gene</span></span>
<span id="cb57-33"><a href="r-function-mannual.html#cb57-33" tabindex="-1"></a>dat_all_temp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(metabolome_1 <span class="sc">%&gt;%</span></span>
<span id="cb57-34"><a href="r-function-mannual.html#cb57-34" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(KEGG,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb57-35"><a href="r-function-mannual.html#cb57-35" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG&quot;</span>),</span>
<span id="cb57-36"><a href="r-function-mannual.html#cb57-36" tabindex="-1"></a>                      transcriptome <span class="sc">%&gt;%</span></span>
<span id="cb57-37"><a href="r-function-mannual.html#cb57-37" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-38"><a href="r-function-mannual.html#cb57-38" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">select</span>(Symbol,logFC) <span class="sc">%&gt;%</span></span>
<span id="cb57-39"><a href="r-function-mannual.html#cb57-39" tabindex="-1"></a>                        <span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Symbol&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-40"><a href="r-function-mannual.html#cb57-40" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> PathwayExtendData<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb57-41"><a href="r-function-mannual.html#cb57-41" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb57-42"><a href="r-function-mannual.html#cb57-42" tabindex="-1"></a></span>
<span id="cb57-43"><a href="r-function-mannual.html#cb57-43" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>logFC</span>
<span id="cb57-44"><a href="r-function-mannual.html#cb57-44" tabindex="-1"></a><span class="fu">names</span>(dat_all) <span class="ot">&lt;-</span> dat_all_temp<span class="sc">$</span>name</span>
<span id="cb57-45"><a href="r-function-mannual.html#cb57-45" tabindex="-1"></a></span>
<span id="cb57-46"><a href="r-function-mannual.html#cb57-46" tabindex="-1"></a>p_Propanoate_extended <span class="ot">&lt;-</span> <span class="fu">pESEA</span>(<span class="st">&quot;Propanoate metabolism&quot;</span>,dat_all,<span class="at">out =</span> <span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">1</span>,<span class="at">gseaParam =</span> <span class="dv">1</span>)</span>
<span id="cb57-47"><a href="r-function-mannual.html#cb57-47" tabindex="-1"></a></span>
<span id="cb57-48"><a href="r-function-mannual.html#cb57-48" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Propanoate_metabolite.pdf&quot;</span>,p_Propanoate_metabolite,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb57-49"><a href="r-function-mannual.html#cb57-49" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Propanoate_gene.pdf&quot;</span>,p_Propanoate_gene,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb57-50"><a href="r-function-mannual.html#cb57-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/GSEA/GSEA_Propanoate_extended.pdf&quot;</span>,p_Propanoate_extended,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/multiGSEA-Propanoate.png" width="1172" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="apply-to-acute-myeloid-leukemia" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Apply to acute myeloid leukemia<a href="r-function-mannual.html#apply-to-acute-myeloid-leukemia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Acute myeloid leukemia (AML) is a group of myeloid neoplasms characterized by high heterogeneity in clinical courses and prognosis, and most AML patients respond poorly to immunotherapies.</p>
<p>Acute monocytic leukemia (AMoL, or AML-M5) is a common subtype of AML, which is characterized by a dominance of monocytes in the bone marrow. These overproduced monocytes interfere with normal immune cell production, which can cause many health complications for the affected individual. While the clinical features distinguishing AML-M5 and other types of AML are well-defined, the exploration of disparities in metabolism and transcriptome remains relatively scarce.</p>
<p>Leveraging the data from Cancer Cell Line Encyclopedia (CCLE), MNet was employed to conduct an in-depth analysis of the discernible difference in metabolism and transcriptome between AML-M5 and other subtypes of AML.</p>
<div id="input-data" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Input data<a href="r-function-mannual.html#input-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Cancer Cell Line Encyclopedia (CCLE) serves as a valuable resource, offering comprehensive metabolomic and transcriptomic data for cancer cell lines, and includes every type of AML. Leveraging the data from CCLE, MNet was employed to conduct an in-depth analysis of the discernible difference in metabolism and transcriptome between AML-M5 and other subtypes of AML.</p>
<p>The differentially expressed metabolic genes (DEMG) and metabolites (DM) between AML-M5 and other subtypes of AML were selected by P values &lt; 0.1. There are 360 DEMGs in 1,548 metabolic genes and 43 DMs in 225 metabolites.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="r-function-mannual.html#cb58-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-2"><a href="r-function-mannual.html#cb58-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb58-3"><a href="r-function-mannual.html#cb58-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-4"><a href="r-function-mannual.html#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="r-function-mannual.html#cb58-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-6"><a href="r-function-mannual.html#cb58-6" tabindex="-1"></a><span class="co">#  Step 1: Input transcriptome data for mllima analysis</span></span>
<span id="cb58-7"><a href="r-function-mannual.html#cb58-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-8"><a href="r-function-mannual.html#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="r-function-mannual.html#cb58-9" tabindex="-1"></a>gene_1 <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="r-function-mannual.html#cb58-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb58-11"><a href="r-function-mannual.html#cb58-11" tabindex="-1"></a>gene_id <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/gene.id.v38.txt&quot;</span>,<span class="at">header=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="r-function-mannual.html#cb58-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="r-function-mannual.html#cb58-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V2<span class="sc">==</span><span class="st">&quot;protein_coding&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="r-function-mannual.html#cb58-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V3 <span class="sc">%in%</span> gene_1<span class="sc">$</span>name)</span>
<span id="cb58-15"><a href="r-function-mannual.html#cb58-15" tabindex="-1"></a></span>
<span id="cb58-16"><a href="r-function-mannual.html#cb58-16" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/AML_sample.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-17"><a href="r-function-mannual.html#cb58-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-18"><a href="r-function-mannual.html#cb58-18" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/CCLE_RNAseq_genes_rpkm_20180929.gct&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-19"><a href="r-function-mannual.html#cb58-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-20"><a href="r-function-mannual.html#cb58-20" tabindex="-1"></a></span>
<span id="cb58-21"><a href="r-function-mannual.html#cb58-21" tabindex="-1"></a>coding_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/gene.id.v38.txt&quot;</span>,<span class="at">header=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb58-22"><a href="r-function-mannual.html#cb58-22" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="r-function-mannual.html#cb58-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V2 <span class="sc">==</span> <span class="st">&quot;protein_coding&quot;</span>)</span>
<span id="cb58-24"><a href="r-function-mannual.html#cb58-24" tabindex="-1"></a>sample_overlap_info <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CCLE_ID=</span><span class="fu">intersect</span>(sample<span class="sc">$</span>CCLE_ID,<span class="fu">colnames</span>(dat))) <span class="sc">%&gt;%</span></span>
<span id="cb58-25"><a href="r-function-mannual.html#cb58-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample,<span class="at">by=</span><span class="st">&quot;CCLE_ID&quot;</span>)</span>
<span id="cb58-26"><a href="r-function-mannual.html#cb58-26" tabindex="-1"></a></span>
<span id="cb58-27"><a href="r-function-mannual.html#cb58-27" tabindex="-1"></a>dat_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb58-28"><a href="r-function-mannual.html#cb58-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Name) <span class="sc">%&gt;%</span></span>
<span id="cb58-29"><a href="r-function-mannual.html#cb58-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Description <span class="sc">%in%</span> gene_id<span class="sc">$</span>V3) <span class="sc">%&gt;%</span></span>
<span id="cb58-30"><a href="r-function-mannual.html#cb58-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Description,<span class="fu">all_of</span>(sample_overlap_info<span class="sc">$</span>CCLE_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb58-31"><a href="r-function-mannual.html#cb58-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(Description,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb58-32"><a href="r-function-mannual.html#cb58-32" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Description&quot;</span>)</span>
<span id="cb58-33"><a href="r-function-mannual.html#cb58-33" tabindex="-1"></a></span>
<span id="cb58-34"><a href="r-function-mannual.html#cb58-34" tabindex="-1"></a><span class="fu">write.table</span>(dat_filter,<span class="st">&quot;result/AML_coding_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb58-35"><a href="r-function-mannual.html#cb58-35" tabindex="-1"></a></span>
<span id="cb58-36"><a href="r-function-mannual.html#cb58-36" tabindex="-1"></a>group <span class="ot">&lt;-</span> sample_overlap_info<span class="sc">$</span>Hist_Subtype2</span>
<span id="cb58-37"><a href="r-function-mannual.html#cb58-37" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;M5&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb58-38"><a href="r-function-mannual.html#cb58-38" tabindex="-1"></a>group[group <span class="sc">!=</span> <span class="st">&quot;tumor&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb58-39"><a href="r-function-mannual.html#cb58-39" tabindex="-1"></a><span class="fu">table</span>(group)</span>
<span id="cb58-40"><a href="r-function-mannual.html#cb58-40" tabindex="-1"></a></span>
<span id="cb58-41"><a href="r-function-mannual.html#cb58-41" tabindex="-1"></a>gene_all <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(<span class="fu">log2</span>(dat_filter<span class="sc">+</span><span class="dv">1</span>),group)</span>
<span id="cb58-42"><a href="r-function-mannual.html#cb58-42" tabindex="-1"></a><span class="fu">write.table</span>(gene_all,<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb58-43"><a href="r-function-mannual.html#cb58-43" tabindex="-1"></a></span>
<span id="cb58-44"><a href="r-function-mannual.html#cb58-44" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-45"><a href="r-function-mannual.html#cb58-45" tabindex="-1"></a><span class="co">#  Step 2: Input metabolome data for mllima analysis and convert metabolite names to KEGG IDs.</span></span>
<span id="cb58-46"><a href="r-function-mannual.html#cb58-46" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-47"><a href="r-function-mannual.html#cb58-47" tabindex="-1"></a></span>
<span id="cb58-48"><a href="r-function-mannual.html#cb58-48" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/AML_sample.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-49"><a href="r-function-mannual.html#cb58-49" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-50"><a href="r-function-mannual.html#cb58-50" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/CCLE_metabolomics_20190502.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-51"><a href="r-function-mannual.html#cb58-51" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-52"><a href="r-function-mannual.html#cb58-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(CCLE_ID <span class="sc">%in%</span> sample<span class="sc">$</span>CCLE_ID) <span class="sc">%&gt;%</span></span>
<span id="cb58-53"><a href="r-function-mannual.html#cb58-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>DepMap_ID) <span class="sc">%&gt;%</span></span>
<span id="cb58-54"><a href="r-function-mannual.html#cb58-54" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;CCLE_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-55"><a href="r-function-mannual.html#cb58-55" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-56"><a href="r-function-mannual.html#cb58-56" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-57"><a href="r-function-mannual.html#cb58-57" tabindex="-1"></a></span>
<span id="cb58-58"><a href="r-function-mannual.html#cb58-58" tabindex="-1"></a>sample_overlap_info <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CCLE_ID=</span><span class="fu">intersect</span>(sample<span class="sc">$</span>CCLE_ID,<span class="fu">colnames</span>(dat))) <span class="sc">%&gt;%</span></span>
<span id="cb58-59"><a href="r-function-mannual.html#cb58-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample,<span class="at">by=</span><span class="st">&quot;CCLE_ID&quot;</span>)</span>
<span id="cb58-60"><a href="r-function-mannual.html#cb58-60" tabindex="-1"></a></span>
<span id="cb58-61"><a href="r-function-mannual.html#cb58-61" tabindex="-1"></a>dat_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb58-62"><a href="r-function-mannual.html#cb58-62" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_overlap_info<span class="sc">$</span>CCLE_ID)</span>
<span id="cb58-63"><a href="r-function-mannual.html#cb58-63" tabindex="-1"></a>group <span class="ot">&lt;-</span> sample_overlap_info<span class="sc">$</span>Hist_Subtype2</span>
<span id="cb58-64"><a href="r-function-mannual.html#cb58-64" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;M5&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb58-65"><a href="r-function-mannual.html#cb58-65" tabindex="-1"></a>group[group <span class="sc">!=</span> <span class="st">&quot;tumor&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb58-66"><a href="r-function-mannual.html#cb58-66" tabindex="-1"></a><span class="fu">table</span>(group)</span>
<span id="cb58-67"><a href="r-function-mannual.html#cb58-67" tabindex="-1"></a></span>
<span id="cb58-68"><a href="r-function-mannual.html#cb58-68" tabindex="-1"></a>metabolite_all <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(dat_filter,group)</span>
<span id="cb58-69"><a href="r-function-mannual.html#cb58-69" tabindex="-1"></a><span class="fu">write.table</span>(metabolite_all,<span class="st">&quot;result/AML_metabolite_all_M5vsOther.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb58-70"><a href="r-function-mannual.html#cb58-70" tabindex="-1"></a></span>
<span id="cb58-71"><a href="r-function-mannual.html#cb58-71" tabindex="-1"></a>kid <span class="ot">&lt;-</span> <span class="fu">name2keggid</span>(metabolite_all<span class="sc">$</span>name)</span>
<span id="cb58-72"><a href="r-function-mannual.html#cb58-72" tabindex="-1"></a>metabolite_kid <span class="ot">&lt;-</span> metabolite_all <span class="sc">%&gt;%</span></span>
<span id="cb58-73"><a href="r-function-mannual.html#cb58-73" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-74"><a href="r-function-mannual.html#cb58-74" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb58-75"><a href="r-function-mannual.html#cb58-75" tabindex="-1"></a><span class="fu">write.table</span>(metabolite_kid,<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="snetlyser-1" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> sNETlyser<a href="r-function-mannual.html#snetlyser-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conducted metabolism-related subnetwork analysis based on metabolomic and transcriptomic data by comparing AML-M5 with other subtypes of AML. Upon examining the metabolites and genes within the subnetwork, glutamate emerged as an important metabolite in AML-M5, aligning with the differential analysis and pathway enrichment findings and indicating glutamate best explains the biological processes while comparing with the other AML subtypes.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="r-function-mannual.html#cb59-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-2"><a href="r-function-mannual.html#cb59-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb59-3"><a href="r-function-mannual.html#cb59-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-4"><a href="r-function-mannual.html#cb59-4" tabindex="-1"></a></span>
<span id="cb59-5"><a href="r-function-mannual.html#cb59-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb59-6"><a href="r-function-mannual.html#cb59-6" tabindex="-1"></a><span class="co">#  Step 1: Load mlimma analysis data and set parameters</span></span>
<span id="cb59-7"><a href="r-function-mannual.html#cb59-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb59-8"><a href="r-function-mannual.html#cb59-8" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="r-function-mannual.html#cb59-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb59-10"><a href="r-function-mannual.html#cb59-10" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-11"><a href="r-function-mannual.html#cb59-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="r-function-mannual.html#cb59-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="r-function-mannual.html#cb59-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-14"><a href="r-function-mannual.html#cb59-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="r-function-mannual.html#cb59-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb59-16"><a href="r-function-mannual.html#cb59-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb59-17"><a href="r-function-mannual.html#cb59-17" tabindex="-1"></a></span>
<span id="cb59-18"><a href="r-function-mannual.html#cb59-18" tabindex="-1"></a><span class="fu">names</span>(diff_meta)[<span class="dv">4</span>]  <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb59-19"><a href="r-function-mannual.html#cb59-19" tabindex="-1"></a><span class="fu">names</span>(diff_gene)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb59-20"><a href="r-function-mannual.html#cb59-20" tabindex="-1"></a></span>
<span id="cb59-21"><a href="r-function-mannual.html#cb59-21" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb59-22"><a href="r-function-mannual.html#cb59-22" tabindex="-1"></a><span class="co">#  Step 2: Conducted metabolism-related subnetwork analysis</span></span>
<span id="cb59-23"><a href="r-function-mannual.html#cb59-23" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb59-24"><a href="r-function-mannual.html#cb59-24" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/AML_pdent.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb59-25"><a href="r-function-mannual.html#cb59-25" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sNETlyser</span>(diff_meta,diff_gene,<span class="at">nsize=</span><span class="dv">80</span>)</span>
<span id="cb59-26"><a href="r-function-mannual.html#cb59-26" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb59-27"><a href="r-function-mannual.html#cb59-27" tabindex="-1"></a></span>
<span id="cb59-28"><a href="r-function-mannual.html#cb59-28" tabindex="-1"></a>node <span class="ot">&lt;-</span> a<span class="sc">$</span>node_result</span>
<span id="cb59-29"><a href="r-function-mannual.html#cb59-29" tabindex="-1"></a><span class="fu">write.table</span>(node,<span class="st">&quot;result/AML-pdnet_node.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb59-30"><a href="r-function-mannual.html#cb59-30" tabindex="-1"></a></span>
<span id="cb59-31"><a href="r-function-mannual.html#cb59-31" tabindex="-1"></a>edge <span class="ot">&lt;-</span> a<span class="sc">$</span>edge_result</span>
<span id="cb59-32"><a href="r-function-mannual.html#cb59-32" tabindex="-1"></a><span class="fu">write.table</span>(edge,<span class="st">&quot;result/AML-pdnet_edge.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb59-33"><a href="r-function-mannual.html#cb59-33" tabindex="-1"></a></span>
<span id="cb59-34"><a href="r-function-mannual.html#cb59-34" tabindex="-1"></a>metabolite <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb59-35"><a href="r-function-mannual.html#cb59-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb59-36"><a href="r-function-mannual.html#cb59-36" tabindex="-1"></a></span>
<span id="cb59-37"><a href="r-function-mannual.html#cb59-37" tabindex="-1"></a>gene <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb59-38"><a href="r-function-mannual.html#cb59-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb59-39"><a href="r-function-mannual.html#cb59-39" tabindex="-1"></a></span>
<span id="cb59-40"><a href="r-function-mannual.html#cb59-40" tabindex="-1"></a>result_metabolite <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(metabolite<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb59-41"><a href="r-function-mannual.html#cb59-41" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(gene<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb59-42"><a href="r-function-mannual.html#cb59-42" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(<span class="fu">c</span>(gene<span class="sc">$</span>name,metabolite<span class="sc">$</span>name),<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb59-43"><a href="r-function-mannual.html#cb59-43" tabindex="-1"></a></span>
<span id="cb59-44"><a href="r-function-mannual.html#cb59-44" tabindex="-1"></a><span class="fu">write.table</span>(result_metabolite<span class="sc">$</span>output,<span class="st">&quot;result/AML-pdnet_metabolite_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb59-45"><a href="r-function-mannual.html#cb59-45" tabindex="-1"></a><span class="fu">write.table</span>(result_gene<span class="sc">$</span>output,<span class="st">&quot;result/AML-pdnet_gene_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb59-46"><a href="r-function-mannual.html#cb59-46" tabindex="-1"></a><span class="fu">write.table</span>(result_all<span class="sc">$</span>output,<span class="st">&quot;result/AML-pdnet_all_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb59-47"><a href="r-function-mannual.html#cb59-47" tabindex="-1"></a></span>
<span id="cb59-48"><a href="r-function-mannual.html#cb59-48" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb59-49"><a href="r-function-mannual.html#cb59-49" tabindex="-1"></a>  </span>
<span id="cb59-50"><a href="r-function-mannual.html#cb59-50" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb59-51"><a href="r-function-mannual.html#cb59-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb59-52"><a href="r-function-mannual.html#cb59-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-53"><a href="r-function-mannual.html#cb59-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-54"><a href="r-function-mannual.html#cb59-54" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb59-55"><a href="r-function-mannual.html#cb59-55" tabindex="-1"></a></span>
<span id="cb59-56"><a href="r-function-mannual.html#cb59-56" tabindex="-1"></a></span>
<span id="cb59-57"><a href="r-function-mannual.html#cb59-57" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_metabolite<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>),</span>
<span id="cb59-58"><a href="r-function-mannual.html#cb59-58" tabindex="-1"></a>                    result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>),</span>
<span id="cb59-59"><a href="r-function-mannual.html#cb59-59" tabindex="-1"></a>                    result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-60"><a href="r-function-mannual.html#cb59-60" tabindex="-1"></a> <span class="co"># dplyr::filter(nOverlap &gt; 1) %&gt;%</span></span>
<span id="cb59-61"><a href="r-function-mannual.html#cb59-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-62"><a href="r-function-mannual.html#cb59-62" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway_type <span class="sc">!=</span> <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-63"><a href="r-function-mannual.html#cb59-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Fructose and mannose metabolism&quot;</span>,<span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb59-64"><a href="r-function-mannual.html#cb59-64" tabindex="-1"></a>                            <span class="st">&quot;Galactose metabolism&quot;</span>,<span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,<span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-65"><a href="r-function-mannual.html#cb59-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue)</span>
<span id="cb59-66"><a href="r-function-mannual.html#cb59-66" tabindex="-1"></a></span>
<span id="cb59-67"><a href="r-function-mannual.html#cb59-67" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result<span class="sc">$</span>pathway_type)</span>
<span id="cb59-68"><a href="r-function-mannual.html#cb59-68" tabindex="-1"></a></span>
<span id="cb59-69"><a href="r-function-mannual.html#cb59-69" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb59-70"><a href="r-function-mannual.html#cb59-70" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,<span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb59-71"><a href="r-function-mannual.html#cb59-71" tabindex="-1"></a>                                     <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,<span class="st">&quot;Metabolism of other amino acids&quot;</span>,</span>
<span id="cb59-72"><a href="r-function-mannual.html#cb59-72" tabindex="-1"></a>                                     <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-73"><a href="r-function-mannual.html#cb59-73" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb59-74"><a href="r-function-mannual.html#cb59-74" tabindex="-1"></a></span>
<span id="cb59-75"><a href="r-function-mannual.html#cb59-75" tabindex="-1"></a></span>
<span id="cb59-76"><a href="r-function-mannual.html#cb59-76" tabindex="-1"></a>result<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result<span class="sc">$</span>name)))</span>
<span id="cb59-77"><a href="r-function-mannual.html#cb59-77" tabindex="-1"></a>result<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb59-78"><a href="r-function-mannual.html#cb59-78" tabindex="-1"></a>result<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))</span>
<span id="cb59-79"><a href="r-function-mannual.html#cb59-79" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb59-80"><a href="r-function-mannual.html#cb59-80" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb59-81"><a href="r-function-mannual.html#cb59-81" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb59-82"><a href="r-function-mannual.html#cb59-82" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb59-83"><a href="r-function-mannual.html#cb59-83" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb59-84"><a href="r-function-mannual.html#cb59-84" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb59-85"><a href="r-function-mannual.html#cb59-85" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-86"><a href="r-function-mannual.html#cb59-86" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb59-87"><a href="r-function-mannual.html#cb59-87" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb59-88"><a href="r-function-mannual.html#cb59-88" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-pdnet_epe.pdf&quot;</span>,p1,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb59-89"><a href="r-function-mannual.html#cb59-89" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figure/AML_pdent.png" width="70%" style="display: block; margin: auto;" /></p>
<center>
<strong>sNETlyser analysis of AML:</strong> Visualization of the identified optimal subnetwork that best explains the biological processes comparing AML-M5 and other subtypes of AML. The colors represent the logFC (logarithm of fold change) of genes, with red and green indicating different expression levels, while yellow and blue represent the logFC of metabolites, indicating varying levels.
<center>
</div>
<div id="extended-pathway-analysers" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Extended Pathway Analysers<a href="r-function-mannual.html#extended-pathway-analysers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conducted comprehensive pathway analyses based on genes, metabolites, and genes with metabolites.</p>
<div id="epealyser-1" class="section level4 hasAnchor" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> ePEAlyser<a href="r-function-mannual.html#epealyser-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The results of metabolite-based and gene-based pathway enrichment analysis (M-based PEA and G-based PEA) identified a smaller set of overlapping entities than those uncovered by extended pathway enrichment analysis (ePEA) in every pathway. Notably, ePEA uncovered a broader and more statistically significant set of biological pathways, as indicated by more significant P values.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="r-function-mannual.html#cb60-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb60-2"><a href="r-function-mannual.html#cb60-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-3"><a href="r-function-mannual.html#cb60-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-4"><a href="r-function-mannual.html#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="r-function-mannual.html#cb60-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb60-6"><a href="r-function-mannual.html#cb60-6" tabindex="-1"></a><span class="co">#  Step 1: Load mlimma analysis data and conduct PathwayAnalysis</span></span>
<span id="cb60-7"><a href="r-function-mannual.html#cb60-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb60-8"><a href="r-function-mannual.html#cb60-8" tabindex="-1"></a></span>
<span id="cb60-9"><a href="r-function-mannual.html#cb60-9" tabindex="-1"></a>gene_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="r-function-mannual.html#cb60-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb60-11"><a href="r-function-mannual.html#cb60-11" tabindex="-1"></a>metabolite_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="r-function-mannual.html#cb60-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="r-function-mannual.html#cb60-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="r-function-mannual.html#cb60-14" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-15"><a href="r-function-mannual.html#cb60-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb60-16"><a href="r-function-mannual.html#cb60-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb60-17"><a href="r-function-mannual.html#cb60-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb60-18"><a href="r-function-mannual.html#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="r-function-mannual.html#cb60-19" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gene_all,metabolite_all)</span>
<span id="cb60-20"><a href="r-function-mannual.html#cb60-20" tabindex="-1"></a></span>
<span id="cb60-21"><a href="r-function-mannual.html#cb60-21" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> gene_all <span class="sc">%&gt;%</span></span>
<span id="cb60-22"><a href="r-function-mannual.html#cb60-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb60-23"><a href="r-function-mannual.html#cb60-23" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> metabolite_all <span class="sc">%&gt;%</span></span>
<span id="cb60-24"><a href="r-function-mannual.html#cb60-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb60-25"><a href="r-function-mannual.html#cb60-25" tabindex="-1"></a>diff_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene,diff_meta)</span>
<span id="cb60-26"><a href="r-function-mannual.html#cb60-26" tabindex="-1"></a></span>
<span id="cb60-27"><a href="r-function-mannual.html#cb60-27" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb60-28"><a href="r-function-mannual.html#cb60-28" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb60-29"><a href="r-function-mannual.html#cb60-29" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_all<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb60-30"><a href="r-function-mannual.html#cb60-30" tabindex="-1"></a></span>
<span id="cb60-31"><a href="r-function-mannual.html#cb60-31" tabindex="-1"></a>pathway_overlap <span class="ot">&lt;-</span> <span class="fu">intersect</span>(result_gene<span class="sc">$</span>output<span class="sc">$</span>name,result_meta<span class="sc">$</span>output<span class="sc">$</span>name)</span>
<span id="cb60-32"><a href="r-function-mannual.html#cb60-32" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene<span class="sc">$</span>output,result_meta<span class="sc">$</span>output,result_all<span class="sc">$</span>output) <span class="sc">%&gt;%</span></span>
<span id="cb60-33"><a href="r-function-mannual.html#cb60-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-34"><a href="r-function-mannual.html#cb60-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(nOverlap <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-35"><a href="r-function-mannual.html#cb60-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_overlap) <span class="sc">%&gt;%</span></span>
<span id="cb60-36"><a href="r-function-mannual.html#cb60-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb60-37"><a href="r-function-mannual.html#cb60-37" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb60-38"><a href="r-function-mannual.html#cb60-38" tabindex="-1"></a></span>
<span id="cb60-39"><a href="r-function-mannual.html#cb60-39" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-40"><a href="r-function-mannual.html#cb60-40" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-41"><a href="r-function-mannual.html#cb60-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb60-42"><a href="r-function-mannual.html#cb60-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb60-43"><a href="r-function-mannual.html#cb60-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb60-44"><a href="r-function-mannual.html#cb60-44" tabindex="-1"></a></span>
<span id="cb60-45"><a href="r-function-mannual.html#cb60-45" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> result_meta<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-46"><a href="r-function-mannual.html#cb60-46" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-47"><a href="r-function-mannual.html#cb60-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb60-48"><a href="r-function-mannual.html#cb60-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb60-49"><a href="r-function-mannual.html#cb60-49" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb60-50"><a href="r-function-mannual.html#cb60-50" tabindex="-1"></a></span>
<span id="cb60-51"><a href="r-function-mannual.html#cb60-51" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-52"><a href="r-function-mannual.html#cb60-52" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-53"><a href="r-function-mannual.html#cb60-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb60-54"><a href="r-function-mannual.html#cb60-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb60-55"><a href="r-function-mannual.html#cb60-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb60-56"><a href="r-function-mannual.html#cb60-56" tabindex="-1"></a></span>
<span id="cb60-57"><a href="r-function-mannual.html#cb60-57" tabindex="-1"></a>pathway_type <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb60-58"><a href="r-function-mannual.html#cb60-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb60-59"><a href="r-function-mannual.html#cb60-59" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb60-60"><a href="r-function-mannual.html#cb60-60" tabindex="-1"></a></span>
<span id="cb60-61"><a href="r-function-mannual.html#cb60-61" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene_filter,result_meta_filter,result_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb60-62"><a href="r-function-mannual.html#cb60-62" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb60-63"><a href="r-function-mannual.html#cb60-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(pathway_type,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-64"><a href="r-function-mannual.html#cb60-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb60-65"><a href="r-function-mannual.html#cb60-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name,<span class="at">levels=</span><span class="fu">unique</span>(name)))</span>
<span id="cb60-66"><a href="r-function-mannual.html#cb60-66" tabindex="-1"></a></span>
<span id="cb60-67"><a href="r-function-mannual.html#cb60-67" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb60-68"><a href="r-function-mannual.html#cb60-68" tabindex="-1"></a><span class="co">#  Step 2: Dotplot</span></span>
<span id="cb60-69"><a href="r-function-mannual.html#cb60-69" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb60-70"><a href="r-function-mannual.html#cb60-70" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all,<span class="fu">aes</span>(type,name))<span class="sc">+</span></span>
<span id="cb60-71"><a href="r-function-mannual.html#cb60-71" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="fu">log2</span>(nOverlap),<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb60-72"><a href="r-function-mannual.html#cb60-72" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-73"><a href="r-function-mannual.html#cb60-73" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-74"><a href="r-function-mannual.html#cb60-74" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb60-75"><a href="r-function-mannual.html#cb60-75" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-76"><a href="r-function-mannual.html#cb60-76" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb60-77"><a href="r-function-mannual.html#cb60-77" tabindex="-1"></a></span>
<span id="cb60-78"><a href="r-function-mannual.html#cb60-78" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-ePEA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb60-79"><a href="r-function-mannual.html#cb60-79" tabindex="-1"></a></span>
<span id="cb60-80"><a href="r-function-mannual.html#cb60-80" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb60-81"><a href="r-function-mannual.html#cb60-81" tabindex="-1"></a>pathway_gene_filter <span class="ot">&lt;-</span> result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-82"><a href="r-function-mannual.html#cb60-82" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-83"><a href="r-function-mannual.html#cb60-83" tabindex="-1"></a>pathway_meta_filter <span class="ot">&lt;-</span> result_meta<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-84"><a href="r-function-mannual.html#cb60-84" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-85"><a href="r-function-mannual.html#cb60-85" tabindex="-1"></a>pathway_all_filter <span class="ot">&lt;-</span> result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb60-86"><a href="r-function-mannual.html#cb60-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-87"><a href="r-function-mannual.html#cb60-87" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;VennDiagram&quot;</span>)</span>
<span id="cb60-88"><a href="r-function-mannual.html#cb60-88" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">gene=</span>pathway_gene_filter<span class="sc">$</span>name,</span>
<span id="cb60-89"><a href="r-function-mannual.html#cb60-89" tabindex="-1"></a>                     <span class="at">metabolite=</span>pathway_meta_filter<span class="sc">$</span>name,</span>
<span id="cb60-90"><a href="r-function-mannual.html#cb60-90" tabindex="-1"></a>                     <span class="at">all=</span>pathway_all_filter<span class="sc">$</span>name),<span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#2b6a99&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#005B1D&quot;</span>),<span class="at">alpha =</span><span class="dv">1</span>)</span>
<span id="cb60-91"><a href="r-function-mannual.html#cb60-91" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/AML-PE-ven.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb60-92"><a href="r-function-mannual.html#cb60-92" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb60-93"><a href="r-function-mannual.html#cb60-93" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb60-94"><a href="r-function-mannual.html#cb60-94" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figure/AML-PE_dotplot.png" width="70%" style="display: block; margin: auto;" /></p>
<center>
<strong>Dot plot illustrating enriched pathways. </strong>
<center>
</div>
<div id="epdalyser-1" class="section level4 hasAnchor" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> ePDAlyser<a href="r-function-mannual.html#epdalyser-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The extended pathway differential abundance (ePDA) method revealed a greater number of pathways compared to gene-based or metabolite-based approaches, demonstrating higher stringency.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="r-function-mannual.html#cb61-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb61-2"><a href="r-function-mannual.html#cb61-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb61-3"><a href="r-function-mannual.html#cb61-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb61-4"><a href="r-function-mannual.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="r-function-mannual.html#cb61-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-6"><a href="r-function-mannual.html#cb61-6" tabindex="-1"></a><span class="co">#  Step 1: Load mlimma analysis data and conduct DAscore analysis</span></span>
<span id="cb61-7"><a href="r-function-mannual.html#cb61-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-8"><a href="r-function-mannual.html#cb61-8" tabindex="-1"></a></span>
<span id="cb61-9"><a href="r-function-mannual.html#cb61-9" tabindex="-1"></a><span class="do">## Metabolite</span></span>
<span id="cb61-10"><a href="r-function-mannual.html#cb61-10" tabindex="-1"></a>metabolite_kid <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="r-function-mannual.html#cb61-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb61-12"><a href="r-function-mannual.html#cb61-12" tabindex="-1"></a></span>
<span id="cb61-13"><a href="r-function-mannual.html#cb61-13" tabindex="-1"></a>meta_all <span class="ot">&lt;-</span> metabolite_kid <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="r-function-mannual.html#cb61-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb61-15"><a href="r-function-mannual.html#cb61-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-16"><a href="r-function-mannual.html#cb61-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb61-17"><a href="r-function-mannual.html#cb61-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb61-18"><a href="r-function-mannual.html#cb61-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb61-19"><a href="r-function-mannual.html#cb61-19" tabindex="-1"></a></span>
<span id="cb61-20"><a href="r-function-mannual.html#cb61-20" tabindex="-1"></a>meta_diff <span class="ot">&lt;-</span> meta_all <span class="sc">%&gt;%</span></span>
<span id="cb61-21"><a href="r-function-mannual.html#cb61-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-22"><a href="r-function-mannual.html#cb61-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb61-23"><a href="r-function-mannual.html#cb61-23" tabindex="-1"></a></span>
<span id="cb61-24"><a href="r-function-mannual.html#cb61-24" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> meta_all <span class="sc">%&gt;%</span></span>
<span id="cb61-25"><a href="r-function-mannual.html#cb61-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-26"><a href="r-function-mannual.html#cb61-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb61-27"><a href="r-function-mannual.html#cb61-27" tabindex="-1"></a></span>
<span id="cb61-28"><a href="r-function-mannual.html#cb61-28" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> meta_all <span class="sc">%&gt;%</span></span>
<span id="cb61-29"><a href="r-function-mannual.html#cb61-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-30"><a href="r-function-mannual.html#cb61-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb61-31"><a href="r-function-mannual.html#cb61-31" tabindex="-1"></a></span>
<span id="cb61-32"><a href="r-function-mannual.html#cb61-32" tabindex="-1"></a>DAscore_meta <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(diff_meta_increase<span class="sc">$</span>name,diff_meta_decrease<span class="sc">$</span>name,meta_all<span class="sc">$</span>name,</span>
<span id="cb61-33"><a href="r-function-mannual.html#cb61-33" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">3</span>,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb61-34"><a href="r-function-mannual.html#cb61-34" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-metabolite_DA.pdf&quot;</span>,DAscore_meta<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb61-35"><a href="r-function-mannual.html#cb61-35" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_meta<span class="sc">$</span>result,<span class="st">&quot;result/AML-metabolite_DA.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb61-36"><a href="r-function-mannual.html#cb61-36" tabindex="-1"></a></span>
<span id="cb61-37"><a href="r-function-mannual.html#cb61-37" tabindex="-1"></a><span class="do">## Gene</span></span>
<span id="cb61-38"><a href="r-function-mannual.html#cb61-38" tabindex="-1"></a>gene_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-39"><a href="r-function-mannual.html#cb61-39" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb61-40"><a href="r-function-mannual.html#cb61-40" tabindex="-1"></a></span>
<span id="cb61-41"><a href="r-function-mannual.html#cb61-41" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> gene_all <span class="sc">%&gt;%</span></span>
<span id="cb61-42"><a href="r-function-mannual.html#cb61-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-43"><a href="r-function-mannual.html#cb61-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb61-44"><a href="r-function-mannual.html#cb61-44" tabindex="-1"></a></span>
<span id="cb61-45"><a href="r-function-mannual.html#cb61-45" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> gene_all <span class="sc">%&gt;%</span></span>
<span id="cb61-46"><a href="r-function-mannual.html#cb61-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-47"><a href="r-function-mannual.html#cb61-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb61-48"><a href="r-function-mannual.html#cb61-48" tabindex="-1"></a></span>
<span id="cb61-49"><a href="r-function-mannual.html#cb61-49" tabindex="-1"></a>DAscore_gene <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(diff_gene_increase<span class="sc">$</span>name,diff_gene_decrease<span class="sc">$</span>name,gene_all<span class="sc">$</span>name,</span>
<span id="cb61-50"><a href="r-function-mannual.html#cb61-50" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">10</span>,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb61-51"><a href="r-function-mannual.html#cb61-51" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-gene_DA.pdf&quot;</span>,DAscore_gene<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb61-52"><a href="r-function-mannual.html#cb61-52" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_gene<span class="sc">$</span>result,<span class="st">&quot;result/AML-gene_DA.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb61-53"><a href="r-function-mannual.html#cb61-53" tabindex="-1"></a></span>
<span id="cb61-54"><a href="r-function-mannual.html#cb61-54" tabindex="-1"></a><span class="do">## Met-Gene</span></span>
<span id="cb61-55"><a href="r-function-mannual.html#cb61-55" tabindex="-1"></a>gene_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-56"><a href="r-function-mannual.html#cb61-56" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb61-57"><a href="r-function-mannual.html#cb61-57" tabindex="-1"></a>metabolite_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-58"><a href="r-function-mannual.html#cb61-58" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-59"><a href="r-function-mannual.html#cb61-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb61-60"><a href="r-function-mannual.html#cb61-60" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-61"><a href="r-function-mannual.html#cb61-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb61-62"><a href="r-function-mannual.html#cb61-62" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb61-63"><a href="r-function-mannual.html#cb61-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb61-64"><a href="r-function-mannual.html#cb61-64" tabindex="-1"></a></span>
<span id="cb61-65"><a href="r-function-mannual.html#cb61-65" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gene_all,metabolite_all)</span>
<span id="cb61-66"><a href="r-function-mannual.html#cb61-66" tabindex="-1"></a></span>
<span id="cb61-67"><a href="r-function-mannual.html#cb61-67" tabindex="-1"></a>dat_diff <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gene_all <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>),</span>
<span id="cb61-68"><a href="r-function-mannual.html#cb61-68" tabindex="-1"></a>                  metabolite_all <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.1</span>))</span>
<span id="cb61-69"><a href="r-function-mannual.html#cb61-69" tabindex="-1"></a></span>
<span id="cb61-70"><a href="r-function-mannual.html#cb61-70" tabindex="-1"></a>diff_dat_increase <span class="ot">&lt;-</span> dat_diff <span class="sc">%&gt;%</span></span>
<span id="cb61-71"><a href="r-function-mannual.html#cb61-71" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb61-72"><a href="r-function-mannual.html#cb61-72" tabindex="-1"></a></span>
<span id="cb61-73"><a href="r-function-mannual.html#cb61-73" tabindex="-1"></a>diff_dat_decrease <span class="ot">&lt;-</span> dat_diff <span class="sc">%&gt;%</span></span>
<span id="cb61-74"><a href="r-function-mannual.html#cb61-74" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb61-75"><a href="r-function-mannual.html#cb61-75" tabindex="-1"></a></span>
<span id="cb61-76"><a href="r-function-mannual.html#cb61-76" tabindex="-1"></a>DAscore_GM <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(diff_dat_increase<span class="sc">$</span>name,diff_dat_decrease<span class="sc">$</span>name,dat_all<span class="sc">$</span>name,</span>
<span id="cb61-77"><a href="r-function-mannual.html#cb61-77" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">10</span>,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb61-78"><a href="r-function-mannual.html#cb61-78" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-GM_DA.pdf&quot;</span>,DAscore_GM<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb61-79"><a href="r-function-mannual.html#cb61-79" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_GM<span class="sc">$</span>result,<span class="st">&quot;result/AML-GM_DA.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb61-80"><a href="r-function-mannual.html#cb61-80" tabindex="-1"></a></span>
<span id="cb61-81"><a href="r-function-mannual.html#cb61-81" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-82"><a href="r-function-mannual.html#cb61-82" tabindex="-1"></a><span class="co">#  Step 2: Barplot</span></span>
<span id="cb61-83"><a href="r-function-mannual.html#cb61-83" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-84"><a href="r-function-mannual.html#cb61-84" tabindex="-1"></a>da_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML-metabolite_DA.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-85"><a href="r-function-mannual.html#cb61-85" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-86"><a href="r-function-mannual.html#cb61-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pathway,DA_score,<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>,Measured_members_num) <span class="sc">%&gt;%</span></span>
<span id="cb61-87"><a href="r-function-mannual.html#cb61-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-88"><a href="r-function-mannual.html#cb61-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">da_type_meta=</span><span class="fu">ifelse</span>(DA_score <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="st">&quot;big&quot;</span>,</span>
<span id="cb61-89"><a href="r-function-mannual.html#cb61-89" tabindex="-1"></a>                               <span class="fu">ifelse</span>(DA_score <span class="sc">&lt;</span> <span class="dv">0</span>,<span class="st">&quot;little&quot;</span>,<span class="st">&quot;middle&quot;</span>)))</span>
<span id="cb61-90"><a href="r-function-mannual.html#cb61-90" tabindex="-1"></a>da_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML-gene_DA.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-91"><a href="r-function-mannual.html#cb61-91" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-92"><a href="r-function-mannual.html#cb61-92" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pathway,DA_score,<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>,Measured_members_num) <span class="sc">%&gt;%</span></span>
<span id="cb61-93"><a href="r-function-mannual.html#cb61-93" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-94"><a href="r-function-mannual.html#cb61-94" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">da_type_gene=</span><span class="fu">ifelse</span>(DA_score <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="st">&quot;big&quot;</span>,</span>
<span id="cb61-95"><a href="r-function-mannual.html#cb61-95" tabindex="-1"></a>                               <span class="fu">ifelse</span>(DA_score <span class="sc">&lt;</span> <span class="dv">0</span>,<span class="st">&quot;little&quot;</span>,<span class="st">&quot;middle&quot;</span>)))</span>
<span id="cb61-96"><a href="r-function-mannual.html#cb61-96" tabindex="-1"></a>da_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML-GM_DA.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-97"><a href="r-function-mannual.html#cb61-97" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-98"><a href="r-function-mannual.html#cb61-98" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pathway,DA_score,<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>,Measured_members_num) <span class="sc">%&gt;%</span></span>
<span id="cb61-99"><a href="r-function-mannual.html#cb61-99" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-100"><a href="r-function-mannual.html#cb61-100" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">da_type_all =</span><span class="fu">ifelse</span>(DA_score <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="st">&quot;big&quot;</span>,</span>
<span id="cb61-101"><a href="r-function-mannual.html#cb61-101" tabindex="-1"></a>                               <span class="fu">ifelse</span>(DA_score <span class="sc">&lt;</span> <span class="dv">0</span>,<span class="st">&quot;little&quot;</span>,<span class="st">&quot;middle&quot;</span>)))</span>
<span id="cb61-102"><a href="r-function-mannual.html#cb61-102" tabindex="-1"></a></span>
<span id="cb61-103"><a href="r-function-mannual.html#cb61-103" tabindex="-1"></a>pathway_overlap <span class="ot">&lt;-</span> da_meta <span class="sc">%&gt;%</span></span>
<span id="cb61-104"><a href="r-function-mannual.html#cb61-104" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(da_gene,<span class="at">by=</span><span class="st">&quot;Pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-105"><a href="r-function-mannual.html#cb61-105" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(da_all,<span class="at">by=</span><span class="st">&quot;Pathway&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-106"><a href="r-function-mannual.html#cb61-106" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DA_score.x)) <span class="sc">%&gt;%</span></span>
<span id="cb61-107"><a href="r-function-mannual.html#cb61-107" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DA_score.y)) <span class="sc">%&gt;%</span></span>
<span id="cb61-108"><a href="r-function-mannual.html#cb61-108" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(da_type_meta <span class="sc">==</span> da_type_gene <span class="sc">|</span> da_type_meta<span class="sc">==</span><span class="st">&quot;middle&quot;</span><span class="sc">|</span>da_type_gene<span class="sc">==</span><span class="st">&quot;middle&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-109"><a href="r-function-mannual.html#cb61-109" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(Pathway)</span>
<span id="cb61-110"><a href="r-function-mannual.html#cb61-110" tabindex="-1"></a></span>
<span id="cb61-111"><a href="r-function-mannual.html#cb61-111" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(da_meta <span class="sc">%&gt;%</span></span>
<span id="cb61-112"><a href="r-function-mannual.html#cb61-112" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>da_type_meta),</span>
<span id="cb61-113"><a href="r-function-mannual.html#cb61-113" tabindex="-1"></a>                da_gene <span class="sc">%&gt;%</span></span>
<span id="cb61-114"><a href="r-function-mannual.html#cb61-114" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>da_type_gene),</span>
<span id="cb61-115"><a href="r-function-mannual.html#cb61-115" tabindex="-1"></a>                da_all <span class="sc">%&gt;%</span></span>
<span id="cb61-116"><a href="r-function-mannual.html#cb61-116" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>da_type_all)) <span class="sc">%&gt;%</span></span>
<span id="cb61-117"><a href="r-function-mannual.html#cb61-117" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_overlap) <span class="sc">%&gt;%</span></span>
<span id="cb61-118"><a href="r-function-mannual.html#cb61-118" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(DA_score) <span class="sc">%&gt;%</span></span>
<span id="cb61-119"><a href="r-function-mannual.html#cb61-119" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-120"><a href="r-function-mannual.html#cb61-120" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-121"><a href="r-function-mannual.html#cb61-121" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>(Measured_members_num <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">&amp;</span> Type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-122"><a href="r-function-mannual.html#cb61-122" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Pathway=</span><span class="fu">factor</span>(Pathway,<span class="at">levels =</span> <span class="fu">unique</span>(Pathway))) <span class="sc">%&gt;%</span></span>
<span id="cb61-123"><a href="r-function-mannual.html#cb61-123" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">factor</span>(Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb61-124"><a href="r-function-mannual.html#cb61-124" tabindex="-1"></a></span>
<span id="cb61-125"><a href="r-function-mannual.html#cb61-125" tabindex="-1"></a>colp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acid metabolism&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb61-126"><a href="r-function-mannual.html#cb61-126" tabindex="-1"></a>          <span class="st">&quot;Carbohydrate metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,<span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#1F78B4&quot;</span>,</span>
<span id="cb61-127"><a href="r-function-mannual.html#cb61-127" tabindex="-1"></a>          <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span><span class="ot">=</span><span class="st">&quot;#BC80BD&quot;</span>,</span>
<span id="cb61-128"><a href="r-function-mannual.html#cb61-128" tabindex="-1"></a>          <span class="st">&quot;Metabolism of other amino acids&quot;</span><span class="ot">=</span><span class="st">&quot;#8DD3C7&quot;</span>,</span>
<span id="cb61-129"><a href="r-function-mannual.html#cb61-129" tabindex="-1"></a>          <span class="st">&quot;Energy metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,<span class="st">&quot;Lipid metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,<span class="st">&quot;Nucleotide metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb61-130"><a href="r-function-mannual.html#cb61-130" tabindex="-1"></a>          <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,</span>
<span id="cb61-131"><a href="r-function-mannual.html#cb61-131" tabindex="-1"></a>          <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb61-132"><a href="r-function-mannual.html#cb61-132" tabindex="-1"></a></span>
<span id="cb61-133"><a href="r-function-mannual.html#cb61-133" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(result_filter)<span class="sc">+</span></span>
<span id="cb61-134"><a href="r-function-mannual.html#cb61-134" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">size=</span><span class="fu">log2</span>(Measured_members_num),<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb61-135"><a href="r-function-mannual.html#cb61-135" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span>DA_score,<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb61-136"><a href="r-function-mannual.html#cb61-136" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>colp)<span class="sc">+</span></span>
<span id="cb61-137"><a href="r-function-mannual.html#cb61-137" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb61-138"><a href="r-function-mannual.html#cb61-138" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-139"><a href="r-function-mannual.html#cb61-139" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb61-140"><a href="r-function-mannual.html#cb61-140" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb61-141"><a href="r-function-mannual.html#cb61-141" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb61-142"><a href="r-function-mannual.html#cb61-142" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb61-143"><a href="r-function-mannual.html#cb61-143" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type)</span>
<span id="cb61-144"><a href="r-function-mannual.html#cb61-144" tabindex="-1"></a></span>
<span id="cb61-145"><a href="r-function-mannual.html#cb61-145" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-ePDA.pdf&quot;</span>,p,<span class="at">width=</span><span class="fl">12.5</span>,<span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb61-146"><a href="r-function-mannual.html#cb61-146" tabindex="-1"></a></span>
<span id="cb61-147"><a href="r-function-mannual.html#cb61-147" tabindex="-1"></a><span class="do">### venn</span></span>
<span id="cb61-148"><a href="r-function-mannual.html#cb61-148" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb61-149"><a href="r-function-mannual.html#cb61-149" tabindex="-1"></a>num_meta <span class="ot">&lt;-</span> da_meta<span class="sc">$</span>Pathway</span>
<span id="cb61-150"><a href="r-function-mannual.html#cb61-150" tabindex="-1"></a>num_gene <span class="ot">&lt;-</span> da_gene<span class="sc">$</span>Pathway</span>
<span id="cb61-151"><a href="r-function-mannual.html#cb61-151" tabindex="-1"></a>num_all <span class="ot">&lt;-</span> da_all<span class="sc">$</span>Pathway</span>
<span id="cb61-152"><a href="r-function-mannual.html#cb61-152" tabindex="-1"></a></span>
<span id="cb61-153"><a href="r-function-mannual.html#cb61-153" tabindex="-1"></a>dat_num <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>),</span>
<span id="cb61-154"><a href="r-function-mannual.html#cb61-154" tabindex="-1"></a>                      <span class="at">num=</span><span class="fu">c</span>(<span class="fu">length</span>(num_meta),<span class="fu">length</span>(num_gene),<span class="fu">length</span>(num_all))) <span class="sc">%&gt;%</span></span>
<span id="cb61-155"><a href="r-function-mannual.html#cb61-155" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb61-156"><a href="r-function-mannual.html#cb61-156" tabindex="-1"></a></span>
<span id="cb61-157"><a href="r-function-mannual.html#cb61-157" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_num,<span class="fu">aes</span>(type,num,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb61-158"><a href="r-function-mannual.html#cb61-158" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb61-159"><a href="r-function-mannual.html#cb61-159" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;gene&quot;</span><span class="ot">=</span><span class="st">&quot;#2b6a99&quot;</span>,<span class="st">&quot;all&quot;</span><span class="ot">=</span><span class="st">&quot;#005B1D&quot;</span>))<span class="sc">+</span></span>
<span id="cb61-160"><a href="r-function-mannual.html#cb61-160" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb61-161"><a href="r-function-mannual.html#cb61-161" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-DA_num.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb61-162"><a href="r-function-mannual.html#cb61-162" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figure/AML-DA_score.png" width="1875" style="display: block; margin: auto;" /></p>
<center>
<strong>Dot plot illustrating the DA pathway results.</strong>
<center>
</div>
<div id="esealyser-1" class="section level4 hasAnchor" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> eSEAlyser<a href="r-function-mannual.html#esealyser-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Gene set enrichment analysis (GSEA) and metabolite set enrichment analysis (MSEA) exhibited minimal pathway overlap, indicating a limitation of this method. This limitation was effectively addressed through extended pathway set enrichment analysis (eSEA), considering both genes and metabolites, thereby enhancing and complementing the insights provided by GSEA and MSEA.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="r-function-mannual.html#cb62-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb62-2"><a href="r-function-mannual.html#cb62-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-3"><a href="r-function-mannual.html#cb62-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-4"><a href="r-function-mannual.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="r-function-mannual.html#cb62-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-6"><a href="r-function-mannual.html#cb62-6" tabindex="-1"></a><span class="co">#  Step 1: Load mlimma analysis data and conduct ESEA analysis</span></span>
<span id="cb62-7"><a href="r-function-mannual.html#cb62-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-8"><a href="r-function-mannual.html#cb62-8" tabindex="-1"></a></span>
<span id="cb62-9"><a href="r-function-mannual.html#cb62-9" tabindex="-1"></a>gene_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_gene_all_M5vsOther.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="r-function-mannual.html#cb62-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="r-function-mannual.html#cb62-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb62-12"><a href="r-function-mannual.html#cb62-12" tabindex="-1"></a>metabolite_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/AML_metabolite_all_M5vsOther_KEGGID.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="r-function-mannual.html#cb62-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="r-function-mannual.html#cb62-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb62-15"><a href="r-function-mannual.html#cb62-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="r-function-mannual.html#cb62-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="r-function-mannual.html#cb62-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="r-function-mannual.html#cb62-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="r-function-mannual.html#cb62-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb62-20"><a href="r-function-mannual.html#cb62-20" tabindex="-1"></a>all_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(metabolite_all,gene_all) <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="r-function-mannual.html#cb62-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(logFC))</span>
<span id="cb62-22"><a href="r-function-mannual.html#cb62-22" tabindex="-1"></a></span>
<span id="cb62-23"><a href="r-function-mannual.html#cb62-23" tabindex="-1"></a>all <span class="ot">&lt;-</span> all_result<span class="sc">$</span>logFC</span>
<span id="cb62-24"><a href="r-function-mannual.html#cb62-24" tabindex="-1"></a><span class="fu">names</span>(all) <span class="ot">&lt;-</span> all_result<span class="sc">$</span>name</span>
<span id="cb62-25"><a href="r-function-mannual.html#cb62-25" tabindex="-1"></a></span>
<span id="cb62-26"><a href="r-function-mannual.html#cb62-26" tabindex="-1"></a>gene <span class="ot">&lt;-</span> gene_all<span class="sc">$</span>logFC</span>
<span id="cb62-27"><a href="r-function-mannual.html#cb62-27" tabindex="-1"></a><span class="fu">names</span>(gene) <span class="ot">&lt;-</span> gene_all<span class="sc">$</span>name</span>
<span id="cb62-28"><a href="r-function-mannual.html#cb62-28" tabindex="-1"></a></span>
<span id="cb62-29"><a href="r-function-mannual.html#cb62-29" tabindex="-1"></a>meta <span class="ot">&lt;-</span> metabolite_all<span class="sc">$</span>logFC</span>
<span id="cb62-30"><a href="r-function-mannual.html#cb62-30" tabindex="-1"></a><span class="fu">names</span>(meta) <span class="ot">&lt;-</span> metabolite_all<span class="sc">$</span>name</span>
<span id="cb62-31"><a href="r-function-mannual.html#cb62-31" tabindex="-1"></a></span>
<span id="cb62-32"><a href="r-function-mannual.html#cb62-32" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(meta,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">2</span>)</span>
<span id="cb62-33"><a href="r-function-mannual.html#cb62-33" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(gene,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">5</span>)</span>
<span id="cb62-34"><a href="r-function-mannual.html#cb62-34" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(all,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">7</span>)</span>
<span id="cb62-35"><a href="r-function-mannual.html#cb62-35" tabindex="-1"></a></span>
<span id="cb62-36"><a href="r-function-mannual.html#cb62-36" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> result_meta <span class="sc">%&gt;%</span></span>
<span id="cb62-37"><a href="r-function-mannual.html#cb62-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-38"><a href="r-function-mannual.html#cb62-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb62-39"><a href="r-function-mannual.html#cb62-39" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> result_gene <span class="sc">%&gt;%</span></span>
<span id="cb62-40"><a href="r-function-mannual.html#cb62-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-41"><a href="r-function-mannual.html#cb62-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb62-42"><a href="r-function-mannual.html#cb62-42" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> result_all <span class="sc">%&gt;%</span></span>
<span id="cb62-43"><a href="r-function-mannual.html#cb62-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-44"><a href="r-function-mannual.html#cb62-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb62-45"><a href="r-function-mannual.html#cb62-45" tabindex="-1"></a></span>
<span id="cb62-46"><a href="r-function-mannual.html#cb62-46" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb62-47"><a href="r-function-mannual.html#cb62-47" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;VennDiagram&quot;</span>)</span>
<span id="cb62-48"><a href="r-function-mannual.html#cb62-48" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">gene=</span>result_gene_filter<span class="sc">$</span>pathway,</span>
<span id="cb62-49"><a href="r-function-mannual.html#cb62-49" tabindex="-1"></a>                     <span class="at">metabolite=</span>result_meta_filter<span class="sc">$</span>pathway,</span>
<span id="cb62-50"><a href="r-function-mannual.html#cb62-50" tabindex="-1"></a>                     <span class="at">all=</span>result_all_filter<span class="sc">$</span>pathway),<span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#2b6a99&quot;</span>,<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#005B1D&quot;</span>),<span class="at">alpha =</span><span class="dv">1</span>)</span>
<span id="cb62-51"><a href="r-function-mannual.html#cb62-51" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/AML-eSEA-ven.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb62-52"><a href="r-function-mannual.html#cb62-52" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb62-53"><a href="r-function-mannual.html#cb62-53" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb62-54"><a href="r-function-mannual.html#cb62-54" tabindex="-1"></a>}</span>
<span id="cb62-55"><a href="r-function-mannual.html#cb62-55" tabindex="-1"></a></span>
<span id="cb62-56"><a href="r-function-mannual.html#cb62-56" tabindex="-1"></a>pathway_overlap <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(result_meta_filter<span class="sc">$</span>pathway,result_gene_filter<span class="sc">$</span>pathway,result_all_filter<span class="sc">$</span>pathway))</span>
<span id="cb62-57"><a href="r-function-mannual.html#cb62-57" tabindex="-1"></a></span>
<span id="cb62-58"><a href="r-function-mannual.html#cb62-58" tabindex="-1"></a><span class="do">## Only one omics</span></span>
<span id="cb62-59"><a href="r-function-mannual.html#cb62-59" tabindex="-1"></a>only_one <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">setdiff</span>(result_meta<span class="sc">$</span>pathway,result_gene<span class="sc">$</span>pathway),<span class="fu">setdiff</span>(result_gene<span class="sc">$</span>pathway,result_meta<span class="sc">$</span>pathway))</span>
<span id="cb62-60"><a href="r-function-mannual.html#cb62-60" tabindex="-1"></a></span>
<span id="cb62-61"><a href="r-function-mannual.html#cb62-61" tabindex="-1"></a>result_temp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>),</span>
<span id="cb62-62"><a href="r-function-mannual.html#cb62-62" tabindex="-1"></a>                result_gene <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>),</span>
<span id="cb62-63"><a href="r-function-mannual.html#cb62-63" tabindex="-1"></a>                result_all <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-64"><a href="r-function-mannual.html#cb62-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_overlap) <span class="sc">%&gt;%</span></span>
<span id="cb62-65"><a href="r-function-mannual.html#cb62-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway <span class="sc">%in%</span> only_one) <span class="sc">%&gt;%</span></span>
<span id="cb62-66"><a href="r-function-mannual.html#cb62-66" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Tryptophan metabolism&quot;</span>,<span class="st">&quot;Porphyrin metabolism&quot;</span>,<span class="st">&quot;Pentose phosphate pathway&quot;</span>,</span>
<span id="cb62-67"><a href="r-function-mannual.html#cb62-67" tabindex="-1"></a>                                <span class="st">&quot;Galactose metabolism&quot;</span>,<span class="st">&quot;D-Amino acid metabolism&quot;</span>,<span class="st">&quot;Glycolysis / Gluconeogenesis&quot;</span>,</span>
<span id="cb62-68"><a href="r-function-mannual.html#cb62-68" tabindex="-1"></a>                                <span class="st">&quot;Glycerolipid metabolism&quot;</span>,<span class="st">&quot;Citrate cycle (TCA cycle)&quot;</span>))</span>
<span id="cb62-69"><a href="r-function-mannual.html#cb62-69" tabindex="-1"></a></span>
<span id="cb62-70"><a href="r-function-mannual.html#cb62-70" tabindex="-1"></a>result_1 <span class="ot">&lt;-</span> result_temp <span class="sc">%&gt;%</span></span>
<span id="cb62-71"><a href="r-function-mannual.html#cb62-71" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-72"><a href="r-function-mannual.html#cb62-72" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(NES)</span>
<span id="cb62-73"><a href="r-function-mannual.html#cb62-73" tabindex="-1"></a>result <span class="ot">&lt;-</span> result_temp <span class="sc">%&gt;%</span></span>
<span id="cb62-74"><a href="r-function-mannual.html#cb62-74" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway,result_1<span class="sc">$</span>pathway)) <span class="sc">%&gt;%</span></span>
<span id="cb62-75"><a href="r-function-mannual.html#cb62-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(type,<span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb62-76"><a href="r-function-mannual.html#cb62-76" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb62-77"><a href="r-function-mannual.html#cb62-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">factor</span>(pathway,<span class="at">levels=</span>result_1<span class="sc">$</span>pathway))</span>
<span id="cb62-78"><a href="r-function-mannual.html#cb62-78" tabindex="-1"></a></span>
<span id="cb62-79"><a href="r-function-mannual.html#cb62-79" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-80"><a href="r-function-mannual.html#cb62-80" tabindex="-1"></a><span class="co">#  Step 2: Barplot</span></span>
<span id="cb62-81"><a href="r-function-mannual.html#cb62-81" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-82"><a href="r-function-mannual.html#cb62-82" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(pathway,NES,<span class="at">fill=</span><span class="sc">-</span><span class="fu">log10</span>(pval)))<span class="sc">+</span></span>
<span id="cb62-83"><a href="r-function-mannual.html#cb62-83" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-84"><a href="r-function-mannual.html#cb62-84" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb62-85"><a href="r-function-mannual.html#cb62-85" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb62-86"><a href="r-function-mannual.html#cb62-86" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb62-87"><a href="r-function-mannual.html#cb62-87" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb62-88"><a href="r-function-mannual.html#cb62-88" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;pink&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-89"><a href="r-function-mannual.html#cb62-89" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb62-90"><a href="r-function-mannual.html#cb62-90" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-91"><a href="r-function-mannual.html#cb62-91" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb62-92"><a href="r-function-mannual.html#cb62-92" tabindex="-1"></a></span>
<span id="cb62-93"><a href="r-function-mannual.html#cb62-93" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/AML-eSEA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="figure/AML-ESEA_barplot.png" width="1503" style="display: block; margin: auto;" /></p>
<center>
<strong>Bar plot illustrating NES of enriched pathways.</strong>
<center>
</div>
</div>
</div>
<div id="apply-to-triple-negative-breast-cancer" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Apply to triple-negative breast cancer<a href="r-function-mannual.html#apply-to-triple-negative-breast-cancer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The case study involves an integrated analysis of metabolomic and transcriptomic data, with the aim of understanding rapidly proliferating breast cancers <a href="https://aacrjournals.org/cancerres/article/82/4/665/678072/Integrated-Metabolic-Profiling-and-Transcriptional">Cancer Research</a>.</p>
<p>The study characterizes the metabolomic profile of two types of 31 breast tumors in human, revealing elevated pyrimidine metabolism and glutaminolysis pathways in triple-negative breast cancer (TNBC).</p>
<p>As an example of mixed metabolites and genes analyses, we use both dataset of metabolite intensity and gene expression data as reported in the paper. The metabolomics data was accessed from the paper, and the gene expression data was obtained from <strong>GEO (GSE173991)</strong>.</p>
<div id="snetlyser-2" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> sNETlyser<a href="r-function-mannual.html#snetlyser-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The authors’ results demonstrate the essential role of glutamine catabolism-based pyrimidine metabolism in TNBC. MNet not only corroborates this finding but also highlights the significance of oxidative phosphorylation in cluster 2.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="r-function-mannual.html#cb63-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-2"><a href="r-function-mannual.html#cb63-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb63-3"><a href="r-function-mannual.html#cb63-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-4"><a href="r-function-mannual.html#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="r-function-mannual.html#cb63-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb63-6"><a href="r-function-mannual.html#cb63-6" tabindex="-1"></a><span class="co">#  Step 1: Input metabolome and transcriptome data for mllima analysis</span></span>
<span id="cb63-7"><a href="r-function-mannual.html#cb63-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb63-8"><a href="r-function-mannual.html#cb63-8" tabindex="-1"></a></span>
<span id="cb63-9"><a href="r-function-mannual.html#cb63-9" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb63-10"><a href="r-function-mannual.html#cb63-10" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb63-11"><a href="r-function-mannual.html#cb63-11" tabindex="-1"></a><span class="fu">names</span>(diff_meta)[<span class="dv">4</span>]  <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb63-12"><a href="r-function-mannual.html#cb63-12" tabindex="-1"></a><span class="fu">names</span>(diff_gene)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb63-13"><a href="r-function-mannual.html#cb63-13" tabindex="-1"></a></span>
<span id="cb63-14"><a href="r-function-mannual.html#cb63-14" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb63-15"><a href="r-function-mannual.html#cb63-15" tabindex="-1"></a><span class="co">#  Step 2: Conducted metabolism-related subnetwork analysis</span></span>
<span id="cb63-16"><a href="r-function-mannual.html#cb63-16" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb63-17"><a href="r-function-mannual.html#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="r-function-mannual.html#cb63-18" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/TNBC_pdent.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb63-19"><a href="r-function-mannual.html#cb63-19" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sNETlyser</span>(diff_meta,diff_gene,<span class="at">nsize=</span><span class="dv">100</span>)</span>
<span id="cb63-20"><a href="r-function-mannual.html#cb63-20" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb63-21"><a href="r-function-mannual.html#cb63-21" tabindex="-1"></a></span>
<span id="cb63-22"><a href="r-function-mannual.html#cb63-22" tabindex="-1"></a>node <span class="ot">&lt;-</span> a<span class="sc">$</span>node_result</span>
<span id="cb63-23"><a href="r-function-mannual.html#cb63-23" tabindex="-1"></a><span class="fu">write.table</span>(node,<span class="st">&quot;result/TNBC_pdnet_node.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb63-24"><a href="r-function-mannual.html#cb63-24" tabindex="-1"></a></span>
<span id="cb63-25"><a href="r-function-mannual.html#cb63-25" tabindex="-1"></a>edge <span class="ot">&lt;-</span> a<span class="sc">$</span>edge_result</span>
<span id="cb63-26"><a href="r-function-mannual.html#cb63-26" tabindex="-1"></a><span class="fu">write.table</span>(edge,<span class="st">&quot;result/TNBC_pdnet_edge.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb63-27"><a href="r-function-mannual.html#cb63-27" tabindex="-1"></a></span>
<span id="cb63-28"><a href="r-function-mannual.html#cb63-28" tabindex="-1"></a>metabolite <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="r-function-mannual.html#cb63-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb63-30"><a href="r-function-mannual.html#cb63-30" tabindex="-1"></a></span>
<span id="cb63-31"><a href="r-function-mannual.html#cb63-31" tabindex="-1"></a>gene <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb63-32"><a href="r-function-mannual.html#cb63-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb63-33"><a href="r-function-mannual.html#cb63-33" tabindex="-1"></a></span>
<span id="cb63-34"><a href="r-function-mannual.html#cb63-34" tabindex="-1"></a>result_metabolite <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(metabolite<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb63-35"><a href="r-function-mannual.html#cb63-35" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(gene<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb63-36"><a href="r-function-mannual.html#cb63-36" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(<span class="fu">c</span>(gene<span class="sc">$</span>name,metabolite<span class="sc">$</span>name),<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb63-37"><a href="r-function-mannual.html#cb63-37" tabindex="-1"></a></span>
<span id="cb63-38"><a href="r-function-mannual.html#cb63-38" tabindex="-1"></a><span class="fu">write.table</span>(result_metabolite<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_pdnet_metabolite_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb63-39"><a href="r-function-mannual.html#cb63-39" tabindex="-1"></a><span class="fu">write.table</span>(result_gene<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_pdnet_gene_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb63-40"><a href="r-function-mannual.html#cb63-40" tabindex="-1"></a><span class="fu">write.table</span>(result_all<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_pdnet_all_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb63-41"><a href="r-function-mannual.html#cb63-41" tabindex="-1"></a></span>
<span id="cb63-42"><a href="r-function-mannual.html#cb63-42" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb63-43"><a href="r-function-mannual.html#cb63-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb63-44"><a href="r-function-mannual.html#cb63-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-45"><a href="r-function-mannual.html#cb63-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-46"><a href="r-function-mannual.html#cb63-46" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb63-47"><a href="r-function-mannual.html#cb63-47" tabindex="-1"></a></span>
<span id="cb63-48"><a href="r-function-mannual.html#cb63-48" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_metabolite<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>),</span>
<span id="cb63-49"><a href="r-function-mannual.html#cb63-49" tabindex="-1"></a>                    result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>),</span>
<span id="cb63-50"><a href="r-function-mannual.html#cb63-50" tabindex="-1"></a>                    result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-51"><a href="r-function-mannual.html#cb63-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-52"><a href="r-function-mannual.html#cb63-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway_type <span class="sc">!=</span> <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-53"><a href="r-function-mannual.html#cb63-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Fructose and mannose metabolism&quot;</span>,</span>
<span id="cb63-54"><a href="r-function-mannual.html#cb63-54" tabindex="-1"></a>                             <span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb63-55"><a href="r-function-mannual.html#cb63-55" tabindex="-1"></a>                            <span class="st">&quot;Galactose metabolism&quot;</span>,</span>
<span id="cb63-56"><a href="r-function-mannual.html#cb63-56" tabindex="-1"></a>                            <span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,</span>
<span id="cb63-57"><a href="r-function-mannual.html#cb63-57" tabindex="-1"></a>                            <span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-58"><a href="r-function-mannual.html#cb63-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue)</span>
<span id="cb63-59"><a href="r-function-mannual.html#cb63-59" tabindex="-1"></a></span>
<span id="cb63-60"><a href="r-function-mannual.html#cb63-60" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result<span class="sc">$</span>pathway_type)</span>
<span id="cb63-61"><a href="r-function-mannual.html#cb63-61" tabindex="-1"></a></span>
<span id="cb63-62"><a href="r-function-mannual.html#cb63-62" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb63-63"><a href="r-function-mannual.html#cb63-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,</span>
<span id="cb63-64"><a href="r-function-mannual.html#cb63-64" tabindex="-1"></a>                                     <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb63-65"><a href="r-function-mannual.html#cb63-65" tabindex="-1"></a>                                     <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,</span>
<span id="cb63-66"><a href="r-function-mannual.html#cb63-66" tabindex="-1"></a>                                     <span class="st">&quot;Metabolism of other amino acids&quot;</span>,</span>
<span id="cb63-67"><a href="r-function-mannual.html#cb63-67" tabindex="-1"></a>                                     <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-68"><a href="r-function-mannual.html#cb63-68" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb63-69"><a href="r-function-mannual.html#cb63-69" tabindex="-1"></a></span>
<span id="cb63-70"><a href="r-function-mannual.html#cb63-70" tabindex="-1"></a>result<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result<span class="sc">$</span>name)))</span>
<span id="cb63-71"><a href="r-function-mannual.html#cb63-71" tabindex="-1"></a>result<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb63-72"><a href="r-function-mannual.html#cb63-72" tabindex="-1"></a>result<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))</span>
<span id="cb63-73"><a href="r-function-mannual.html#cb63-73" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb63-74"><a href="r-function-mannual.html#cb63-74" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb63-75"><a href="r-function-mannual.html#cb63-75" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb63-76"><a href="r-function-mannual.html#cb63-76" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb63-77"><a href="r-function-mannual.html#cb63-77" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb63-78"><a href="r-function-mannual.html#cb63-78" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb63-79"><a href="r-function-mannual.html#cb63-79" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-80"><a href="r-function-mannual.html#cb63-80" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb63-81"><a href="r-function-mannual.html#cb63-81" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb63-82"><a href="r-function-mannual.html#cb63-82" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_pdnet_epe.pdf&quot;</span>,p1,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/TNBC-net.png" width="70%" style="display: block; margin: auto;" /></p>
<center>
<strong>sNETlyser analysis of TNBC:</strong> Leveraging the input data including the significance level (such as P-values) for metabolites and genes, MNet extracts the optimal subnetwork that best explains the biological processes underlying the input data. The colors represent the logFC (logarithm of fold change) of genes (red and green indicating different expression levels), while yellow and blue represent the logFC of metabolites, indicating varying levels.
<center>
</div>
<div id="extended-pathway-analyses-1" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Extended Pathway Analyses<a href="r-function-mannual.html#extended-pathway-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The authors found that pyrimidine and purine metabolism, carbon metabolism, and the energy production related pathways were highly enriched in cluster 2 while many lipid/fatty acid metabolism related pathways were enriched in cluster 1, which aligns with similar result obtained from MNet.</p>
<div id="epealyser-2" class="section level4 hasAnchor" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> ePEAlyser<a href="r-function-mannual.html#epealyser-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Extended pathway enrichment analysis.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="r-function-mannual.html#cb64-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-2"><a href="r-function-mannual.html#cb64-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb64-3"><a href="r-function-mannual.html#cb64-3" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb64-4"><a href="r-function-mannual.html#cb64-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-5"><a href="r-function-mannual.html#cb64-5" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb64-6"><a href="r-function-mannual.html#cb64-6" tabindex="-1"></a></span>
<span id="cb64-7"><a href="r-function-mannual.html#cb64-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-8"><a href="r-function-mannual.html#cb64-8" tabindex="-1"></a><span class="co">#  Step 1: Input metabolome and transcriptome data for mllima analysis</span></span>
<span id="cb64-9"><a href="r-function-mannual.html#cb64-9" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-10"><a href="r-function-mannual.html#cb64-10" tabindex="-1"></a></span>
<span id="cb64-11"><a href="r-function-mannual.html#cb64-11" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb64-12"><a href="r-function-mannual.html#cb64-12" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb64-13"><a href="r-function-mannual.html#cb64-13" tabindex="-1"></a></span>
<span id="cb64-14"><a href="r-function-mannual.html#cb64-14" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-15"><a href="r-function-mannual.html#cb64-15" tabindex="-1"></a><span class="co">#  Step 2: PathwayAnalysis</span></span>
<span id="cb64-16"><a href="r-function-mannual.html#cb64-16" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-17"><a href="r-function-mannual.html#cb64-17" tabindex="-1"></a></span>
<span id="cb64-18"><a href="r-function-mannual.html#cb64-18" tabindex="-1"></a><span class="do">## Gene</span></span>
<span id="cb64-19"><a href="r-function-mannual.html#cb64-19" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb64-20"><a href="r-function-mannual.html#cb64-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-21"><a href="r-function-mannual.html#cb64-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-22"><a href="r-function-mannual.html#cb64-22" tabindex="-1"></a></span>
<span id="cb64-23"><a href="r-function-mannual.html#cb64-23" tabindex="-1"></a>result_gene_increase <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-24"><a href="r-function-mannual.html#cb64-24" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_gene_increase.pdf&quot;</span>,result_gene_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-25"><a href="r-function-mannual.html#cb64-25" tabindex="-1"></a><span class="fu">write.table</span>(result_gene_increase<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_gene_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-26"><a href="r-function-mannual.html#cb64-26" tabindex="-1"></a></span>
<span id="cb64-27"><a href="r-function-mannual.html#cb64-27" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb64-28"><a href="r-function-mannual.html#cb64-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-29"><a href="r-function-mannual.html#cb64-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-30"><a href="r-function-mannual.html#cb64-30" tabindex="-1"></a></span>
<span id="cb64-31"><a href="r-function-mannual.html#cb64-31" tabindex="-1"></a>result_gene_decrease <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_gene_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-32"><a href="r-function-mannual.html#cb64-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_gene_decrease.pdf&quot;</span>,result_gene_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-33"><a href="r-function-mannual.html#cb64-33" tabindex="-1"></a><span class="fu">write.table</span>(result_gene_decrease<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_gene_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-34"><a href="r-function-mannual.html#cb64-34" tabindex="-1"></a></span>
<span id="cb64-35"><a href="r-function-mannual.html#cb64-35" tabindex="-1"></a><span class="do">## Metabolite</span></span>
<span id="cb64-36"><a href="r-function-mannual.html#cb64-36" tabindex="-1"></a><span class="do">## Filter the increase differential genes and metabolites</span></span>
<span id="cb64-37"><a href="r-function-mannual.html#cb64-37" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb64-38"><a href="r-function-mannual.html#cb64-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-39"><a href="r-function-mannual.html#cb64-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-40"><a href="r-function-mannual.html#cb64-40" tabindex="-1"></a></span>
<span id="cb64-41"><a href="r-function-mannual.html#cb64-41" tabindex="-1"></a>result_meta_increase <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-42"><a href="r-function-mannual.html#cb64-42" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_meta_increase.pdf&quot;</span>,result_meta_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-43"><a href="r-function-mannual.html#cb64-43" tabindex="-1"></a><span class="fu">write.table</span>(result_meta_increase<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_meta_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-44"><a href="r-function-mannual.html#cb64-44" tabindex="-1"></a></span>
<span id="cb64-45"><a href="r-function-mannual.html#cb64-45" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb64-46"><a href="r-function-mannual.html#cb64-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-47"><a href="r-function-mannual.html#cb64-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-48"><a href="r-function-mannual.html#cb64-48" tabindex="-1"></a></span>
<span id="cb64-49"><a href="r-function-mannual.html#cb64-49" tabindex="-1"></a>result_meta_decrease <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_meta_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-50"><a href="r-function-mannual.html#cb64-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_meta_decrease.pdf&quot;</span>,result_meta_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-51"><a href="r-function-mannual.html#cb64-51" tabindex="-1"></a><span class="fu">write.table</span>(result_meta_decrease<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_meta_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-52"><a href="r-function-mannual.html#cb64-52" tabindex="-1"></a></span>
<span id="cb64-53"><a href="r-function-mannual.html#cb64-53" tabindex="-1"></a><span class="do">## Met-Gene</span></span>
<span id="cb64-54"><a href="r-function-mannual.html#cb64-54" tabindex="-1"></a>diff_increase <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene_increase,diff_meta_increase)</span>
<span id="cb64-55"><a href="r-function-mannual.html#cb64-55" tabindex="-1"></a>result_all_increase <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-56"><a href="r-function-mannual.html#cb64-56" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_all_increase.pdf&quot;</span>,result_all_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-57"><a href="r-function-mannual.html#cb64-57" tabindex="-1"></a><span class="fu">write.table</span>(result_all_increase<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_all_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-58"><a href="r-function-mannual.html#cb64-58" tabindex="-1"></a></span>
<span id="cb64-59"><a href="r-function-mannual.html#cb64-59" tabindex="-1"></a>diff_decrease <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene_decrease,diff_meta_decrease)</span>
<span id="cb64-60"><a href="r-function-mannual.html#cb64-60" tabindex="-1"></a>result_all_decrease <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(diff_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb64-61"><a href="r-function-mannual.html#cb64-61" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_all_decrease.pdf&quot;</span>,result_all_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb64-62"><a href="r-function-mannual.html#cb64-62" tabindex="-1"></a><span class="fu">write.table</span>(result_all_decrease<span class="sc">$</span>output,<span class="st">&quot;result/TNBC_all_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb64-63"><a href="r-function-mannual.html#cb64-63" tabindex="-1"></a></span>
<span id="cb64-64"><a href="r-function-mannual.html#cb64-64" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-65"><a href="r-function-mannual.html#cb64-65" tabindex="-1"></a><span class="co">#  Step 3: Dotplot</span></span>
<span id="cb64-66"><a href="r-function-mannual.html#cb64-66" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb64-67"><a href="r-function-mannual.html#cb64-67" tabindex="-1"></a></span>
<span id="cb64-68"><a href="r-function-mannual.html#cb64-68" tabindex="-1"></a>meta_increase <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_meta_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-69"><a href="r-function-mannual.html#cb64-69" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-70"><a href="r-function-mannual.html#cb64-70" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-71"><a href="r-function-mannual.html#cb64-71" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1 =</span><span class="st">&quot;meta_Cluster1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-72"><a href="r-function-mannual.html#cb64-72" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb64-73"><a href="r-function-mannual.html#cb64-73" tabindex="-1"></a>meta_decrease <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_meta_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-74"><a href="r-function-mannual.html#cb64-74" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-75"><a href="r-function-mannual.html#cb64-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-76"><a href="r-function-mannual.html#cb64-76" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1=</span><span class="st">&quot;meta_Cluster2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-77"><a href="r-function-mannual.html#cb64-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb64-78"><a href="r-function-mannual.html#cb64-78" tabindex="-1"></a></span>
<span id="cb64-79"><a href="r-function-mannual.html#cb64-79" tabindex="-1"></a>gene_increase <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_gene_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-80"><a href="r-function-mannual.html#cb64-80" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-81"><a href="r-function-mannual.html#cb64-81" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-82"><a href="r-function-mannual.html#cb64-82" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1 =</span><span class="st">&quot;gene_Cluster1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-83"><a href="r-function-mannual.html#cb64-83" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb64-84"><a href="r-function-mannual.html#cb64-84" tabindex="-1"></a>gene_decrease <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_gene_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-85"><a href="r-function-mannual.html#cb64-85" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-86"><a href="r-function-mannual.html#cb64-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-87"><a href="r-function-mannual.html#cb64-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1=</span><span class="st">&quot;gene_Cluster2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-88"><a href="r-function-mannual.html#cb64-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb64-89"><a href="r-function-mannual.html#cb64-89" tabindex="-1"></a></span>
<span id="cb64-90"><a href="r-function-mannual.html#cb64-90" tabindex="-1"></a>all_increase <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_all_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-91"><a href="r-function-mannual.html#cb64-91" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-92"><a href="r-function-mannual.html#cb64-92" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-93"><a href="r-function-mannual.html#cb64-93" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1 =</span><span class="st">&quot;all_Cluster1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-94"><a href="r-function-mannual.html#cb64-94" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb64-95"><a href="r-function-mannual.html#cb64-95" tabindex="-1"></a>all_decrease <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_all_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-96"><a href="r-function-mannual.html#cb64-96" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-97"><a href="r-function-mannual.html#cb64-97" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb64-98"><a href="r-function-mannual.html#cb64-98" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type1=</span><span class="st">&quot;all_Cluster2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-99"><a href="r-function-mannual.html#cb64-99" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type2 =</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb64-100"><a href="r-function-mannual.html#cb64-100" tabindex="-1"></a></span>
<span id="cb64-101"><a href="r-function-mannual.html#cb64-101" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb64-102"><a href="r-function-mannual.html#cb64-102" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb64-103"><a href="r-function-mannual.html#cb64-103" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-104"><a href="r-function-mannual.html#cb64-104" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-105"><a href="r-function-mannual.html#cb64-105" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb64-106"><a href="r-function-mannual.html#cb64-106" tabindex="-1"></a></span>
<span id="cb64-107"><a href="r-function-mannual.html#cb64-107" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">rbind</span>(meta_increase,meta_decrease) <span class="sc">%&gt;%</span></span>
<span id="cb64-108"><a href="r-function-mannual.html#cb64-108" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb64-109"><a href="r-function-mannual.html#cb64-109" tabindex="-1"></a></span>
<span id="cb64-110"><a href="r-function-mannual.html#cb64-110" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gene_increase,gene_decrease) <span class="sc">%&gt;%</span></span>
<span id="cb64-111"><a href="r-function-mannual.html#cb64-111" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-112"><a href="r-function-mannual.html#cb64-112" tabindex="-1"></a></span>
<span id="cb64-113"><a href="r-function-mannual.html#cb64-113" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_increase,all_decrease) <span class="sc">%&gt;%</span></span>
<span id="cb64-114"><a href="r-function-mannual.html#cb64-114" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb64-115"><a href="r-function-mannual.html#cb64-115" tabindex="-1"></a></span>
<span id="cb64-116"><a href="r-function-mannual.html#cb64-116" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_meta,result_gene,result_all) <span class="sc">%&gt;%</span></span>
<span id="cb64-117"><a href="r-function-mannual.html#cb64-117" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sulfur metabolism&quot;</span>,</span>
<span id="cb64-118"><a href="r-function-mannual.html#cb64-118" tabindex="-1"></a>                             <span class="st">&quot;Fructose and mannose metabolism&quot;</span>,</span>
<span id="cb64-119"><a href="r-function-mannual.html#cb64-119" tabindex="-1"></a>                             <span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,</span>
<span id="cb64-120"><a href="r-function-mannual.html#cb64-120" tabindex="-1"></a>                             <span class="st">&quot;Galactose metabolism&quot;</span>,</span>
<span id="cb64-121"><a href="r-function-mannual.html#cb64-121" tabindex="-1"></a>                             <span class="st">&quot;Butanoate metabolism&quot;</span>,</span>
<span id="cb64-122"><a href="r-function-mannual.html#cb64-122" tabindex="-1"></a>                             <span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>,</span>
<span id="cb64-123"><a href="r-function-mannual.html#cb64-123" tabindex="-1"></a>                             <span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb64-124"><a href="r-function-mannual.html#cb64-124" tabindex="-1"></a>                             <span class="st">&quot;Propanoate metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-125"><a href="r-function-mannual.html#cb64-125" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-126"><a href="r-function-mannual.html#cb64-126" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway_type <span class="sc">!=</span> <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-127"><a href="r-function-mannual.html#cb64-127" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue)</span>
<span id="cb64-128"><a href="r-function-mannual.html#cb64-128" tabindex="-1"></a></span>
<span id="cb64-129"><a href="r-function-mannual.html#cb64-129" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result<span class="sc">$</span>pathway_type)</span>
<span id="cb64-130"><a href="r-function-mannual.html#cb64-130" tabindex="-1"></a></span>
<span id="cb64-131"><a href="r-function-mannual.html#cb64-131" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb64-132"><a href="r-function-mannual.html#cb64-132" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,<span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,<span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,<span class="st">&quot;Metabolism of other amino acids&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-133"><a href="r-function-mannual.html#cb64-133" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb64-134"><a href="r-function-mannual.html#cb64-134" tabindex="-1"></a></span>
<span id="cb64-135"><a href="r-function-mannual.html#cb64-135" tabindex="-1"></a>result<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result<span class="sc">$</span>name)))</span>
<span id="cb64-136"><a href="r-function-mannual.html#cb64-136" tabindex="-1"></a>result<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb64-137"><a href="r-function-mannual.html#cb64-137" tabindex="-1"></a>result<span class="sc">$</span>type1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type1,</span>
<span id="cb64-138"><a href="r-function-mannual.html#cb64-138" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;meta_Cluster1&quot;</span>,<span class="st">&quot;meta_Cluster2&quot;</span>,</span>
<span id="cb64-139"><a href="r-function-mannual.html#cb64-139" tabindex="-1"></a>                                <span class="st">&quot;gene_Cluster1&quot;</span>,<span class="st">&quot;gene_Cluster2&quot;</span>,</span>
<span id="cb64-140"><a href="r-function-mannual.html#cb64-140" tabindex="-1"></a>                                <span class="st">&quot;all_Cluster1&quot;</span>,<span class="st">&quot;all_Cluster2&quot;</span>))</span>
<span id="cb64-141"><a href="r-function-mannual.html#cb64-141" tabindex="-1"></a></span>
<span id="cb64-142"><a href="r-function-mannual.html#cb64-142" tabindex="-1"></a>colp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acid metabolism&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb64-143"><a href="r-function-mannual.html#cb64-143" tabindex="-1"></a>          <span class="st">&quot;Carbohydrate metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,</span>
<span id="cb64-144"><a href="r-function-mannual.html#cb64-144" tabindex="-1"></a>          <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#1F78B4&quot;</span>,</span>
<span id="cb64-145"><a href="r-function-mannual.html#cb64-145" tabindex="-1"></a>          <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb64-146"><a href="r-function-mannual.html#cb64-146" tabindex="-1"></a>          <span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span><span class="ot">=</span><span class="st">&quot;#BC80BD&quot;</span>,</span>
<span id="cb64-147"><a href="r-function-mannual.html#cb64-147" tabindex="-1"></a>          <span class="st">&quot;Metabolism of other amino acids&quot;</span><span class="ot">=</span><span class="st">&quot;#8DD3C7&quot;</span>,</span>
<span id="cb64-148"><a href="r-function-mannual.html#cb64-148" tabindex="-1"></a>          <span class="st">&quot;Energy metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,</span>
<span id="cb64-149"><a href="r-function-mannual.html#cb64-149" tabindex="-1"></a>          <span class="st">&quot;Lipid metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,</span>
<span id="cb64-150"><a href="r-function-mannual.html#cb64-150" tabindex="-1"></a>          <span class="st">&quot;Nucleotide metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb64-151"><a href="r-function-mannual.html#cb64-151" tabindex="-1"></a>          <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,</span>
<span id="cb64-152"><a href="r-function-mannual.html#cb64-152" tabindex="-1"></a>          <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb64-153"><a href="r-function-mannual.html#cb64-153" tabindex="-1"></a></span>
<span id="cb64-154"><a href="r-function-mannual.html#cb64-154" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb64-155"><a href="r-function-mannual.html#cb64-155" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb64-156"><a href="r-function-mannual.html#cb64-156" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colp)<span class="sc">+</span></span>
<span id="cb64-157"><a href="r-function-mannual.html#cb64-157" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb64-158"><a href="r-function-mannual.html#cb64-158" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb64-159"><a href="r-function-mannual.html#cb64-159" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type1,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-160"><a href="r-function-mannual.html#cb64-160" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb64-161"><a href="r-function-mannual.html#cb64-161" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb64-162"><a href="r-function-mannual.html#cb64-162" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_ePEA.pdf&quot;</span>,p1,<span class="at">width=</span><span class="dv">15</span>,<span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="figure/TNBC-ePEA.png" width="664" style="display: block; margin: auto;" /></p>
<center>
<strong>Pathway enrichment analysis of metabolites and genes.</strong>
<center>
</div>
<div id="epdalyser-2" class="section level4 hasAnchor" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> ePDAlyser<a href="r-function-mannual.html#epdalyser-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Extended pathway differential abundance score.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="r-function-mannual.html#cb65-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb65-2"><a href="r-function-mannual.html#cb65-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb65-3"><a href="r-function-mannual.html#cb65-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb65-4"><a href="r-function-mannual.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="r-function-mannual.html#cb65-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-6"><a href="r-function-mannual.html#cb65-6" tabindex="-1"></a><span class="co">#  Step 1: Input metabolome and transcriptome data for mllima analysis</span></span>
<span id="cb65-7"><a href="r-function-mannual.html#cb65-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-8"><a href="r-function-mannual.html#cb65-8" tabindex="-1"></a></span>
<span id="cb65-9"><a href="r-function-mannual.html#cb65-9" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;normal&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;a&quot;</span></span>
<span id="cb65-10"><a href="r-function-mannual.html#cb65-10" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;tumor&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb65-11"><a href="r-function-mannual.html#cb65-11" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;a&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb65-12"><a href="r-function-mannual.html#cb65-12" tabindex="-1"></a></span>
<span id="cb65-13"><a href="r-function-mannual.html#cb65-13" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb65-14"><a href="r-function-mannual.html#cb65-14" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb65-15"><a href="r-function-mannual.html#cb65-15" tabindex="-1"></a></span>
<span id="cb65-16"><a href="r-function-mannual.html#cb65-16" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-17"><a href="r-function-mannual.html#cb65-17" tabindex="-1"></a><span class="co">#  Step 2: ePDAlyser</span></span>
<span id="cb65-18"><a href="r-function-mannual.html#cb65-18" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-19"><a href="r-function-mannual.html#cb65-19" tabindex="-1"></a></span>
<span id="cb65-20"><a href="r-function-mannual.html#cb65-20" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb65-21"><a href="r-function-mannual.html#cb65-21" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb65-22"><a href="r-function-mannual.html#cb65-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-23"><a href="r-function-mannual.html#cb65-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb65-24"><a href="r-function-mannual.html#cb65-24" tabindex="-1"></a></span>
<span id="cb65-25"><a href="r-function-mannual.html#cb65-25" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb65-26"><a href="r-function-mannual.html#cb65-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-27"><a href="r-function-mannual.html#cb65-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb65-28"><a href="r-function-mannual.html#cb65-28" tabindex="-1"></a></span>
<span id="cb65-29"><a href="r-function-mannual.html#cb65-29" tabindex="-1"></a>DAscore_gene <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(diff_gene_increase<span class="sc">$</span>name,</span>
<span id="cb65-30"><a href="r-function-mannual.html#cb65-30" tabindex="-1"></a>                        diff_gene_decrease<span class="sc">$</span>name,all_gene<span class="sc">$</span>name,</span>
<span id="cb65-31"><a href="r-function-mannual.html#cb65-31" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">10</span>,</span>
<span id="cb65-32"><a href="r-function-mannual.html#cb65-32" tabindex="-1"></a>                        <span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb65-33"><a href="r-function-mannual.html#cb65-33" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_DA_gene.pdf&quot;</span>,DAscore_gene<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb65-34"><a href="r-function-mannual.html#cb65-34" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_gene<span class="sc">$</span>result,<span class="st">&quot;result/TNBC_DA_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb65-35"><a href="r-function-mannual.html#cb65-35" tabindex="-1"></a></span>
<span id="cb65-36"><a href="r-function-mannual.html#cb65-36" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb65-37"><a href="r-function-mannual.html#cb65-37" tabindex="-1"></a><span class="do">## filter the increase differential genes and metabolites</span></span>
<span id="cb65-38"><a href="r-function-mannual.html#cb65-38" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb65-39"><a href="r-function-mannual.html#cb65-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-40"><a href="r-function-mannual.html#cb65-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb65-41"><a href="r-function-mannual.html#cb65-41" tabindex="-1"></a></span>
<span id="cb65-42"><a href="r-function-mannual.html#cb65-42" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb65-43"><a href="r-function-mannual.html#cb65-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-44"><a href="r-function-mannual.html#cb65-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb65-45"><a href="r-function-mannual.html#cb65-45" tabindex="-1"></a></span>
<span id="cb65-46"><a href="r-function-mannual.html#cb65-46" tabindex="-1"></a>DAscore_meta <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(diff_meta_increase<span class="sc">$</span>name,</span>
<span id="cb65-47"><a href="r-function-mannual.html#cb65-47" tabindex="-1"></a>                        diff_meta_decrease<span class="sc">$</span>name,all_meta<span class="sc">$</span>name,</span>
<span id="cb65-48"><a href="r-function-mannual.html#cb65-48" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">3</span>,</span>
<span id="cb65-49"><a href="r-function-mannual.html#cb65-49" tabindex="-1"></a>                        <span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb65-50"><a href="r-function-mannual.html#cb65-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_DA_meta.pdf&quot;</span>,DAscore_meta<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb65-51"><a href="r-function-mannual.html#cb65-51" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_meta<span class="sc">$</span>result,<span class="st">&quot;result/TNBC_DA_meta.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb65-52"><a href="r-function-mannual.html#cb65-52" tabindex="-1"></a></span>
<span id="cb65-53"><a href="r-function-mannual.html#cb65-53" tabindex="-1"></a><span class="do">## gene and metabolite</span></span>
<span id="cb65-54"><a href="r-function-mannual.html#cb65-54" tabindex="-1"></a>DAscore_all <span class="ot">&lt;-</span> <span class="fu">ePDAlyser</span>(<span class="fu">c</span>(diff_gene_increase<span class="sc">$</span>name,diff_meta_increase<span class="sc">$</span>name),</span>
<span id="cb65-55"><a href="r-function-mannual.html#cb65-55" tabindex="-1"></a>                        <span class="fu">c</span>(diff_gene_decrease<span class="sc">$</span>name,diff_meta_decrease<span class="sc">$</span>name),</span>
<span id="cb65-56"><a href="r-function-mannual.html#cb65-56" tabindex="-1"></a>                        <span class="fu">c</span>(all_gene<span class="sc">$</span>name,all_meta<span class="sc">$</span>name),<span class="at">min_measured_num =</span> <span class="dv">13</span>,</span>
<span id="cb65-57"><a href="r-function-mannual.html#cb65-57" tabindex="-1"></a>                        <span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb65-58"><a href="r-function-mannual.html#cb65-58" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_DA_all.pdf&quot;</span>,DAscore_all<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb65-59"><a href="r-function-mannual.html#cb65-59" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_all<span class="sc">$</span>result,<span class="st">&quot;result/TNBC_DA_all.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb65-60"><a href="r-function-mannual.html#cb65-60" tabindex="-1"></a></span>
<span id="cb65-61"><a href="r-function-mannual.html#cb65-61" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-62"><a href="r-function-mannual.html#cb65-62" tabindex="-1"></a><span class="co">#  Step 3: Barplot</span></span>
<span id="cb65-63"><a href="r-function-mannual.html#cb65-63" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb65-64"><a href="r-function-mannual.html#cb65-64" tabindex="-1"></a></span>
<span id="cb65-65"><a href="r-function-mannual.html#cb65-65" tabindex="-1"></a>meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_DA_meta.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-66"><a href="r-function-mannual.html#cb65-66" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-67"><a href="r-function-mannual.html#cb65-67" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-68"><a href="r-function-mannual.html#cb65-68" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb65-69"><a href="r-function-mannual.html#cb65-69" tabindex="-1"></a></span>
<span id="cb65-70"><a href="r-function-mannual.html#cb65-70" tabindex="-1"></a>gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_DA_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-71"><a href="r-function-mannual.html#cb65-71" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-72"><a href="r-function-mannual.html#cb65-72" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-73"><a href="r-function-mannual.html#cb65-73" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb65-74"><a href="r-function-mannual.html#cb65-74" tabindex="-1"></a></span>
<span id="cb65-75"><a href="r-function-mannual.html#cb65-75" tabindex="-1"></a>all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/TNBC_DA_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-76"><a href="r-function-mannual.html#cb65-76" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-77"><a href="r-function-mannual.html#cb65-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-78"><a href="r-function-mannual.html#cb65-78" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb65-79"><a href="r-function-mannual.html#cb65-79" tabindex="-1"></a></span>
<span id="cb65-80"><a href="r-function-mannual.html#cb65-80" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(meta,gene,all) <span class="sc">%&gt;%</span></span>
<span id="cb65-81"><a href="r-function-mannual.html#cb65-81" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>Pathway <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sulfur metabolism&quot;</span>,</span>
<span id="cb65-82"><a href="r-function-mannual.html#cb65-82" tabindex="-1"></a>                                <span class="st">&quot;Fructose and mannose metabolism&quot;</span>,</span>
<span id="cb65-83"><a href="r-function-mannual.html#cb65-83" tabindex="-1"></a>                                <span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,</span>
<span id="cb65-84"><a href="r-function-mannual.html#cb65-84" tabindex="-1"></a>                                <span class="st">&quot;Galactose metabolism&quot;</span>,</span>
<span id="cb65-85"><a href="r-function-mannual.html#cb65-85" tabindex="-1"></a>                                <span class="st">&quot;Butanoate metabolism&quot;</span>,</span>
<span id="cb65-86"><a href="r-function-mannual.html#cb65-86" tabindex="-1"></a>                                <span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>,</span>
<span id="cb65-87"><a href="r-function-mannual.html#cb65-87" tabindex="-1"></a>                                <span class="st">&quot;Starch and sucrose metabolism&quot;</span>,</span>
<span id="cb65-88"><a href="r-function-mannual.html#cb65-88" tabindex="-1"></a>                                <span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb65-89"><a href="r-function-mannual.html#cb65-89" tabindex="-1"></a>                                <span class="st">&quot;Propanoate metabolism&quot;</span>,</span>
<span id="cb65-90"><a href="r-function-mannual.html#cb65-90" tabindex="-1"></a>                                <span class="st">&quot;Inositol phosphate metabolism&quot;</span>,</span>
<span id="cb65-91"><a href="r-function-mannual.html#cb65-91" tabindex="-1"></a>                                <span class="st">&quot;Tryptophan metabolism&quot;</span>,</span>
<span id="cb65-92"><a href="r-function-mannual.html#cb65-92" tabindex="-1"></a>                                <span class="st">&quot;Selenocompound metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-93"><a href="r-function-mannual.html#cb65-93" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span> <span class="sc">%in%</span> </span>
<span id="cb65-94"><a href="r-function-mannual.html#cb65-94" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,</span>
<span id="cb65-95"><a href="r-function-mannual.html#cb65-95" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb65-96"><a href="r-function-mannual.html#cb65-96" tabindex="-1"></a>                    <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,</span>
<span id="cb65-97"><a href="r-function-mannual.html#cb65-97" tabindex="-1"></a>                    <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>,</span>
<span id="cb65-98"><a href="r-function-mannual.html#cb65-98" tabindex="-1"></a>                    <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>,</span>
<span id="cb65-99"><a href="r-function-mannual.html#cb65-99" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of other amino acids&quot;</span>))</span>
<span id="cb65-100"><a href="r-function-mannual.html#cb65-100" tabindex="-1"></a></span>
<span id="cb65-101"><a href="r-function-mannual.html#cb65-101" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb65-102"><a href="r-function-mannual.html#cb65-102" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(DA_score) <span class="sc">%&gt;%</span></span>
<span id="cb65-103"><a href="r-function-mannual.html#cb65-103" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>)</span>
<span id="cb65-104"><a href="r-function-mannual.html#cb65-104" tabindex="-1"></a>  </span>
<span id="cb65-105"><a href="r-function-mannual.html#cb65-105" tabindex="-1"></a>result_filter<span class="sc">$</span>Pathway <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Pathway,<span class="at">levels=</span><span class="fu">unique</span>(result_filter<span class="sc">$</span>Pathway))</span>
<span id="cb65-106"><a href="r-function-mannual.html#cb65-106" tabindex="-1"></a></span>
<span id="cb65-107"><a href="r-function-mannual.html#cb65-107" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb65-108"><a href="r-function-mannual.html#cb65-108" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb65-109"><a href="r-function-mannual.html#cb65-109" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-110"><a href="r-function-mannual.html#cb65-110" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-111"><a href="r-function-mannual.html#cb65-111" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb65-112"><a href="r-function-mannual.html#cb65-112" tabindex="-1"></a></span>
<span id="cb65-113"><a href="r-function-mannual.html#cb65-113" tabindex="-1"></a>result_filter<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb65-114"><a href="r-function-mannual.html#cb65-114" tabindex="-1"></a>                                                         <span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))</span>
<span id="cb65-115"><a href="r-function-mannual.html#cb65-115" tabindex="-1"></a></span>
<span id="cb65-116"><a href="r-function-mannual.html#cb65-116" tabindex="-1"></a>colp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acid metabolism&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb65-117"><a href="r-function-mannual.html#cb65-117" tabindex="-1"></a>          <span class="st">&quot;Carbohydrate metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,</span>
<span id="cb65-118"><a href="r-function-mannual.html#cb65-118" tabindex="-1"></a>          <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#1F78B4&quot;</span>,</span>
<span id="cb65-119"><a href="r-function-mannual.html#cb65-119" tabindex="-1"></a>          <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb65-120"><a href="r-function-mannual.html#cb65-120" tabindex="-1"></a>          <span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span><span class="ot">=</span><span class="st">&quot;#BC80BD&quot;</span>,</span>
<span id="cb65-121"><a href="r-function-mannual.html#cb65-121" tabindex="-1"></a>          <span class="st">&quot;Metabolism of other amino acids&quot;</span><span class="ot">=</span><span class="st">&quot;#8DD3C7&quot;</span>,</span>
<span id="cb65-122"><a href="r-function-mannual.html#cb65-122" tabindex="-1"></a>          <span class="st">&quot;Energy metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,</span>
<span id="cb65-123"><a href="r-function-mannual.html#cb65-123" tabindex="-1"></a>          <span class="st">&quot;Lipid metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,</span>
<span id="cb65-124"><a href="r-function-mannual.html#cb65-124" tabindex="-1"></a>          <span class="st">&quot;Nucleotide metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb65-125"><a href="r-function-mannual.html#cb65-125" tabindex="-1"></a>          <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,</span>
<span id="cb65-126"><a href="r-function-mannual.html#cb65-126" tabindex="-1"></a>          <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb65-127"><a href="r-function-mannual.html#cb65-127" tabindex="-1"></a></span>
<span id="cb65-128"><a href="r-function-mannual.html#cb65-128" tabindex="-1"></a></span>
<span id="cb65-129"><a href="r-function-mannual.html#cb65-129" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(result_filter)<span class="sc">+</span></span>
<span id="cb65-130"><a href="r-function-mannual.html#cb65-130" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">size=</span><span class="fu">log2</span>(Measured_members_num),<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb65-131"><a href="r-function-mannual.html#cb65-131" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span>DA_score,<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb65-132"><a href="r-function-mannual.html#cb65-132" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>colp)<span class="sc">+</span></span>
<span id="cb65-133"><a href="r-function-mannual.html#cb65-133" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb65-134"><a href="r-function-mannual.html#cb65-134" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb65-135"><a href="r-function-mannual.html#cb65-135" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb65-136"><a href="r-function-mannual.html#cb65-136" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)</span>
<span id="cb65-137"><a href="r-function-mannual.html#cb65-137" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_ePDA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">18</span>,<span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="figure/TNBC-ePDA.png" width="715" style="display: block; margin: auto;" /></p>
<center>
The <strong>ePDA score</strong> captures the tendency for a pathway to exhibit increased or decreased levels of genes and metabolites that are statistically significant differences between the cluster 1 and cluster 2.
<center>
</div>
<div id="esealyser-2" class="section level4 hasAnchor" number="3.5.2.3">
<h4><span class="header-section-number">3.5.2.3</span> eSEAlyser<a href="r-function-mannual.html#esealyser-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Extended pathway set enrichment analysis.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="r-function-mannual.html#cb66-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb66-2"><a href="r-function-mannual.html#cb66-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb66-3"><a href="r-function-mannual.html#cb66-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb66-4"><a href="r-function-mannual.html#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="r-function-mannual.html#cb66-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-6"><a href="r-function-mannual.html#cb66-6" tabindex="-1"></a><span class="co">#  Step 1: Input metabolome and transcriptome data for mllima analysis</span></span>
<span id="cb66-7"><a href="r-function-mannual.html#cb66-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-8"><a href="r-function-mannual.html#cb66-8" tabindex="-1"></a></span>
<span id="cb66-9"><a href="r-function-mannual.html#cb66-9" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb66-10"><a href="r-function-mannual.html#cb66-10" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb66-11"><a href="r-function-mannual.html#cb66-11" tabindex="-1"></a></span>
<span id="cb66-12"><a href="r-function-mannual.html#cb66-12" tabindex="-1"></a>all_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_meta,all_gene)</span>
<span id="cb66-13"><a href="r-function-mannual.html#cb66-13" tabindex="-1"></a></span>
<span id="cb66-14"><a href="r-function-mannual.html#cb66-14" tabindex="-1"></a>all <span class="ot">&lt;-</span> all_result<span class="sc">$</span>logFC</span>
<span id="cb66-15"><a href="r-function-mannual.html#cb66-15" tabindex="-1"></a><span class="fu">names</span>(all) <span class="ot">&lt;-</span> all_result<span class="sc">$</span>name</span>
<span id="cb66-16"><a href="r-function-mannual.html#cb66-16" tabindex="-1"></a></span>
<span id="cb66-17"><a href="r-function-mannual.html#cb66-17" tabindex="-1"></a>gene <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>logFC</span>
<span id="cb66-18"><a href="r-function-mannual.html#cb66-18" tabindex="-1"></a><span class="fu">names</span>(gene) <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>name</span>
<span id="cb66-19"><a href="r-function-mannual.html#cb66-19" tabindex="-1"></a></span>
<span id="cb66-20"><a href="r-function-mannual.html#cb66-20" tabindex="-1"></a>meta <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>logFC</span>
<span id="cb66-21"><a href="r-function-mannual.html#cb66-21" tabindex="-1"></a><span class="fu">names</span>(meta) <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>name</span>
<span id="cb66-22"><a href="r-function-mannual.html#cb66-22" tabindex="-1"></a></span>
<span id="cb66-23"><a href="r-function-mannual.html#cb66-23" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-24"><a href="r-function-mannual.html#cb66-24" tabindex="-1"></a><span class="co">#  Step 2: eSEA</span></span>
<span id="cb66-25"><a href="r-function-mannual.html#cb66-25" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-26"><a href="r-function-mannual.html#cb66-26" tabindex="-1"></a></span>
<span id="cb66-27"><a href="r-function-mannual.html#cb66-27" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(meta,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">3</span>)</span>
<span id="cb66-28"><a href="r-function-mannual.html#cb66-28" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(gene,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">10</span>)</span>
<span id="cb66-29"><a href="r-function-mannual.html#cb66-29" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">eSEAlyser</span>(all,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">13</span>)</span>
<span id="cb66-30"><a href="r-function-mannual.html#cb66-30" tabindex="-1"></a></span>
<span id="cb66-31"><a href="r-function-mannual.html#cb66-31" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb66-32"><a href="r-function-mannual.html#cb66-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb66-33"><a href="r-function-mannual.html#cb66-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-34"><a href="r-function-mannual.html#cb66-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-35"><a href="r-function-mannual.html#cb66-35" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb66-36"><a href="r-function-mannual.html#cb66-36" tabindex="-1"></a></span>
<span id="cb66-37"><a href="r-function-mannual.html#cb66-37" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-38"><a href="r-function-mannual.html#cb66-38" tabindex="-1"></a><span class="co">#  Step 3: Barplot</span></span>
<span id="cb66-39"><a href="r-function-mannual.html#cb66-39" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb66-40"><a href="r-function-mannual.html#cb66-40" tabindex="-1"></a></span>
<span id="cb66-41"><a href="r-function-mannual.html#cb66-41" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> result_meta <span class="sc">%&gt;%</span></span>
<span id="cb66-42"><a href="r-function-mannual.html#cb66-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-43"><a href="r-function-mannual.html#cb66-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;meta_Cluster1&quot;</span>,<span class="st">&quot;meta_Cluster2&quot;</span>))</span>
<span id="cb66-44"><a href="r-function-mannual.html#cb66-44" tabindex="-1"></a></span>
<span id="cb66-45"><a href="r-function-mannual.html#cb66-45" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> result_gene <span class="sc">%&gt;%</span></span>
<span id="cb66-46"><a href="r-function-mannual.html#cb66-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-47"><a href="r-function-mannual.html#cb66-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;gene_Cluster1&quot;</span>,<span class="st">&quot;gene_Cluster2&quot;</span>))</span>
<span id="cb66-48"><a href="r-function-mannual.html#cb66-48" tabindex="-1"></a></span>
<span id="cb66-49"><a href="r-function-mannual.html#cb66-49" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> result_all <span class="sc">%&gt;%</span></span>
<span id="cb66-50"><a href="r-function-mannual.html#cb66-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-51"><a href="r-function-mannual.html#cb66-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;all_Cluster1&quot;</span>,<span class="st">&quot;all_Cluster2&quot;</span>))</span>
<span id="cb66-52"><a href="r-function-mannual.html#cb66-52" tabindex="-1"></a></span>
<span id="cb66-53"><a href="r-function-mannual.html#cb66-53" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_meta_filter,result_gene_filter,result_all_filter)</span>
<span id="cb66-54"><a href="r-function-mannual.html#cb66-54" tabindex="-1"></a></span>
<span id="cb66-55"><a href="r-function-mannual.html#cb66-55" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb66-56"><a href="r-function-mannual.html#cb66-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;pathway&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-57"><a href="r-function-mannual.html#cb66-57" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway_type <span class="sc">!=</span> <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-58"><a href="r-function-mannual.html#cb66-58" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway_type <span class="sc">%in%</span> </span>
<span id="cb66-59"><a href="r-function-mannual.html#cb66-59" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,</span>
<span id="cb66-60"><a href="r-function-mannual.html#cb66-60" tabindex="-1"></a>                  <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb66-61"><a href="r-function-mannual.html#cb66-61" tabindex="-1"></a>                  <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,</span>
<span id="cb66-62"><a href="r-function-mannual.html#cb66-62" tabindex="-1"></a>                  <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>,</span>
<span id="cb66-63"><a href="r-function-mannual.html#cb66-63" tabindex="-1"></a>                  <span class="st">&quot;Metabolism of other amino acids&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-64"><a href="r-function-mannual.html#cb66-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pval)</span>
<span id="cb66-65"><a href="r-function-mannual.html#cb66-65" tabindex="-1"></a></span>
<span id="cb66-66"><a href="r-function-mannual.html#cb66-66" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result_filter<span class="sc">$</span>pathway_type)</span>
<span id="cb66-67"><a href="r-function-mannual.html#cb66-67" tabindex="-1"></a></span>
<span id="cb66-68"><a href="r-function-mannual.html#cb66-68" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result_filter <span class="sc">%&gt;%</span></span>
<span id="cb66-69"><a href="r-function-mannual.html#cb66-69" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb66-70"><a href="r-function-mannual.html#cb66-70" tabindex="-1"></a></span>
<span id="cb66-71"><a href="r-function-mannual.html#cb66-71" tabindex="-1"></a>result_filter<span class="sc">$</span>pathway <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>pathway,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result_filter<span class="sc">$</span>pathway)))</span>
<span id="cb66-72"><a href="r-function-mannual.html#cb66-72" tabindex="-1"></a>result_filter<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb66-73"><a href="r-function-mannual.html#cb66-73" tabindex="-1"></a>result_filter<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Type,</span>
<span id="cb66-74"><a href="r-function-mannual.html#cb66-74" tabindex="-1"></a>                             <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;meta_Cluster1&quot;</span>,<span class="st">&quot;meta_Cluster2&quot;</span>,</span>
<span id="cb66-75"><a href="r-function-mannual.html#cb66-75" tabindex="-1"></a>                                      <span class="st">&quot;gene_Cluster1&quot;</span>,<span class="st">&quot;gene_Cluster2&quot;</span>,</span>
<span id="cb66-76"><a href="r-function-mannual.html#cb66-76" tabindex="-1"></a>                                      <span class="st">&quot;all_Cluster1&quot;</span>,<span class="st">&quot;all_Cluster2&quot;</span>))</span>
<span id="cb66-77"><a href="r-function-mannual.html#cb66-77" tabindex="-1"></a></span>
<span id="cb66-78"><a href="r-function-mannual.html#cb66-78" tabindex="-1"></a>colp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acid metabolism&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb66-79"><a href="r-function-mannual.html#cb66-79" tabindex="-1"></a>          <span class="st">&quot;Carbohydrate metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,</span>
<span id="cb66-80"><a href="r-function-mannual.html#cb66-80" tabindex="-1"></a>          <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#1F78B4&quot;</span>,</span>
<span id="cb66-81"><a href="r-function-mannual.html#cb66-81" tabindex="-1"></a>          <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb66-82"><a href="r-function-mannual.html#cb66-82" tabindex="-1"></a>          <span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span><span class="ot">=</span><span class="st">&quot;#BC80BD&quot;</span>,</span>
<span id="cb66-83"><a href="r-function-mannual.html#cb66-83" tabindex="-1"></a>          <span class="st">&quot;Metabolism of other amino acids&quot;</span><span class="ot">=</span><span class="st">&quot;#8DD3C7&quot;</span>,</span>
<span id="cb66-84"><a href="r-function-mannual.html#cb66-84" tabindex="-1"></a>          <span class="st">&quot;Energy metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,</span>
<span id="cb66-85"><a href="r-function-mannual.html#cb66-85" tabindex="-1"></a>          <span class="st">&quot;Lipid metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,</span>
<span id="cb66-86"><a href="r-function-mannual.html#cb66-86" tabindex="-1"></a>          <span class="st">&quot;Nucleotide metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb66-87"><a href="r-function-mannual.html#cb66-87" tabindex="-1"></a>          <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,</span>
<span id="cb66-88"><a href="r-function-mannual.html#cb66-88" tabindex="-1"></a>          <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb66-89"><a href="r-function-mannual.html#cb66-89" tabindex="-1"></a></span>
<span id="cb66-90"><a href="r-function-mannual.html#cb66-90" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_filter,<span class="fu">aes</span>(pathway,<span class="sc">-</span><span class="fu">log10</span>(pval))) <span class="sc">+</span></span>
<span id="cb66-91"><a href="r-function-mannual.html#cb66-91" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb66-92"><a href="r-function-mannual.html#cb66-92" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colp)<span class="sc">+</span></span>
<span id="cb66-93"><a href="r-function-mannual.html#cb66-93" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb66-94"><a href="r-function-mannual.html#cb66-94" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb66-95"><a href="r-function-mannual.html#cb66-95" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb66-96"><a href="r-function-mannual.html#cb66-96" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb66-97"><a href="r-function-mannual.html#cb66-97" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb66-98"><a href="r-function-mannual.html#cb66-98" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/TNBC_eSEA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">15</span>,<span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="figure/TNBC-eSEA.png" width="709" style="display: block; margin: auto;" /></p>
<center>
<strong>Extended gene and metabolite set enrichment analysis. </strong>
<center>
</div>
</div>
</div>
<div id="apply-to-spatial-metabolomics" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Apply to spatial metabolomics<a href="r-function-mannual.html#apply-to-spatial-metabolomics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MSI-based spatially resolved metabolomics (SM) allow in situ screening of tumor initiation-, progression-, and metastasis-related metabolic biomarkers, thus allowing for the characterization of metabolic architecture of tumor and its surrounding microenvironment. Spatially resolved transcriptomics (ST) in cancer tissue transcriptome-wide profiling has greatly revealed tumor metabolic mechanisms. Gastric cancer ranks as one of the most prevalent malignant diseases, with an annual incidence of over 1,080,000 new cases and a mortality rate exceeding 760,000 deaths per year. Researchers found an integrated SM approach to explore the cell-specific metabolic remodeling.</p>
<div id="pea" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> PEA<a href="r-function-mannual.html#pea" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We conducted a reanalysis of both region-specific metabolite markers and gene markers provided by the author. Beyond the arginine and proline metabolism, our findings revealed dysregulation in glycine, serine, and threonine metabolism as well. Furthermore, our study demonstrated that glutathione metabolism is enriched not only at the metabolite level but also at the gene level, with a combined enrichment observed when considering both metabolites and genes.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="r-function-mannual.html#cb67-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb67-2"><a href="r-function-mannual.html#cb67-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb67-3"><a href="r-function-mannual.html#cb67-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb67-4"><a href="r-function-mannual.html#cb67-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb67-5"><a href="r-function-mannual.html#cb67-5" tabindex="-1"></a><span class="co">#  Step 1: Input metabolome and transcriptome data for pathway analysis</span></span>
<span id="cb67-6"><a href="r-function-mannual.html#cb67-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb67-7"><a href="r-function-mannual.html#cb67-7" tabindex="-1"></a></span>
<span id="cb67-8"><a href="r-function-mannual.html#cb67-8" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb67-9"><a href="r-function-mannual.html#cb67-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb67-10"><a href="r-function-mannual.html#cb67-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-11"><a href="r-function-mannual.html#cb67-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-12"><a href="r-function-mannual.html#cb67-12" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb67-13"><a href="r-function-mannual.html#cb67-13" tabindex="-1"></a></span>
<span id="cb67-14"><a href="r-function-mannual.html#cb67-14" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/special-gene-pathway.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-15"><a href="r-function-mannual.html#cb67-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-16"><a href="r-function-mannual.html#cb67-16" tabindex="-1"></a>  <span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb67-17"><a href="r-function-mannual.html#cb67-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb67-18"><a href="r-function-mannual.html#cb67-18" tabindex="-1"></a>dat_metabolite <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/special-metabolite-pathway.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-19"><a href="r-function-mannual.html#cb67-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-20"><a href="r-function-mannual.html#cb67-20" tabindex="-1"></a>  <span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb67-21"><a href="r-function-mannual.html#cb67-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb67-22"><a href="r-function-mannual.html#cb67-22" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;input/special-all-pathway.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-23"><a href="r-function-mannual.html#cb67-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-24"><a href="r-function-mannual.html#cb67-24" tabindex="-1"></a>  <span class="fu">select</span>(name,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb67-25"><a href="r-function-mannual.html#cb67-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb67-26"><a href="r-function-mannual.html#cb67-26" tabindex="-1"></a></span>
<span id="cb67-27"><a href="r-function-mannual.html#cb67-27" tabindex="-1"></a>result_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_gene,dat_metabolite,dat_all) <span class="sc">%&gt;%</span></span>
<span id="cb67-28"><a href="r-function-mannual.html#cb67-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-29"><a href="r-function-mannual.html#cb67-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue)</span>
<span id="cb67-30"><a href="r-function-mannual.html#cb67-30" tabindex="-1"></a></span>
<span id="cb67-31"><a href="r-function-mannual.html#cb67-31" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result_1<span class="sc">$</span>pathway_type)</span>
<span id="cb67-32"><a href="r-function-mannual.html#cb67-32" tabindex="-1"></a></span>
<span id="cb67-33"><a href="r-function-mannual.html#cb67-33" tabindex="-1"></a>result_1 <span class="ot">&lt;-</span> result_1 <span class="sc">%&gt;%</span></span>
<span id="cb67-34"><a href="r-function-mannual.html#cb67-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb67-35"><a href="r-function-mannual.html#cb67-35" tabindex="-1"></a></span>
<span id="cb67-36"><a href="r-function-mannual.html#cb67-36" tabindex="-1"></a>result_1<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_1<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result_1<span class="sc">$</span>name)))</span>
<span id="cb67-37"><a href="r-function-mannual.html#cb67-37" tabindex="-1"></a>result_1<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_1<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb67-38"><a href="r-function-mannual.html#cb67-38" tabindex="-1"></a>result_1<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_1<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))</span>
<span id="cb67-39"><a href="r-function-mannual.html#cb67-39" tabindex="-1"></a></span>
<span id="cb67-40"><a href="r-function-mannual.html#cb67-40" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb67-41"><a href="r-function-mannual.html#cb67-41" tabindex="-1"></a><span class="co">#  Step 2: Barplot</span></span>
<span id="cb67-42"><a href="r-function-mannual.html#cb67-42" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb67-43"><a href="r-function-mannual.html#cb67-43" tabindex="-1"></a></span>
<span id="cb67-44"><a href="r-function-mannual.html#cb67-44" tabindex="-1"></a>colp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acid metabolism&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb67-45"><a href="r-function-mannual.html#cb67-45" tabindex="-1"></a>          <span class="st">&quot;Carbohydrate metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,<span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#1F78B4&quot;</span>,</span>
<span id="cb67-46"><a href="r-function-mannual.html#cb67-46" tabindex="-1"></a>          <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span><span class="ot">=</span><span class="st">&quot;#BC80BD&quot;</span>,</span>
<span id="cb67-47"><a href="r-function-mannual.html#cb67-47" tabindex="-1"></a>          <span class="st">&quot;Metabolism of other amino acids&quot;</span><span class="ot">=</span><span class="st">&quot;#8DD3C7&quot;</span>,</span>
<span id="cb67-48"><a href="r-function-mannual.html#cb67-48" tabindex="-1"></a>          <span class="st">&quot;Energy metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,<span class="st">&quot;Lipid metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,<span class="st">&quot;Nucleotide metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb67-49"><a href="r-function-mannual.html#cb67-49" tabindex="-1"></a>          <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,</span>
<span id="cb67-50"><a href="r-function-mannual.html#cb67-50" tabindex="-1"></a>          <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb67-51"><a href="r-function-mannual.html#cb67-51" tabindex="-1"></a></span>
<span id="cb67-52"><a href="r-function-mannual.html#cb67-52" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_1,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb67-53"><a href="r-function-mannual.html#cb67-53" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb67-54"><a href="r-function-mannual.html#cb67-54" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colp,<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-55"><a href="r-function-mannual.html#cb67-55" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb67-56"><a href="r-function-mannual.html#cb67-56" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb67-57"><a href="r-function-mannual.html#cb67-57" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(type),<span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb67-58"><a href="r-function-mannual.html#cb67-58" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb67-59"><a href="r-function-mannual.html#cb67-59" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/special-ePEA.pdf&quot;</span>,p1,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="fl">5.5</span>)</span></code></pre></div>
<p><img src="figure/Spatial.png" width="1448" style="display: block; margin: auto;" /></p>
<center>
<strong>Metabolite pathway enrichment analysis, genes pathway enrichment and extend pathway enrichment analysis.</strong>
<center>
</div>
</div>
<div id="need-help" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Need help?<a href="r-function-mannual.html#need-help" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>If you have any questions about MNet, please don’t hesitate to email me (<a href="mailto:guituant2009@163.com" class="email">guituant2009@163.com</a>).</strong></p>
<div id="frequently-asked-questions" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Frequently Asked Questions<a href="r-function-mannual.html#frequently-asked-questions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>
<p>Can not install dependent packages dnet</p>
<p>If the ERROR is “Error: Failed to install ‘dnet’ from GitHub: Could not resolve host: api.github.com”, please try it again.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="r-function-mannual.html#cb68-1" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;hfang-bristol/dnet&quot;</span>, <span class="at">dependencies=</span>T)</span></code></pre></div>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="web-server-manual.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Application.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
