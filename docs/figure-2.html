<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Figure 2 | MNet Manual</title>
  <meta name="description" content="MNet: an R package and Shiny app for integrative analysis of metabolomic and transcriptomic data." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Figure 2 | MNet Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="MNet: an R package and Shiny app for integrative analysis of metabolomic and transcriptomic data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Figure 2 | MNet Manual" />
  
  <meta name="twitter:description" content="MNet: an R package and Shiny app for integrative analysis of metabolomic and transcriptomic data." />
  



<meta name="date" content="2024-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="figure-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> OVERVIEW</a></li>
<li class="chapter" data-level="2" data-path="metabolic-subnetwork.html"><a href="metabolic-subnetwork.html"><i class="fa fa-check"></i><b>2</b> Metabolic Subnetwork</a>
<ul>
<li class="chapter" data-level="2.1" data-path="metabolic-subnetwork.html"><a href="metabolic-subnetwork.html#met-gene-subnetwork"><i class="fa fa-check"></i><b>2.1</b> Met-Gene Subnetwork</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="metabolic-subnetwork.html"><a href="metabolic-subnetwork.html#interface"><i class="fa fa-check"></i><b>2.1.1</b> Interface</a></li>
<li class="chapter" data-level="2.1.2" data-path="metabolic-subnetwork.html"><a href="metabolic-subnetwork.html#results"><i class="fa fa-check"></i><b>2.1.2</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html"><i class="fa fa-check"></i><b>3</b> Extended Pathway Analyses</a>
<ul>
<li class="chapter" data-level="3.1" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#epea"><i class="fa fa-check"></i><b>3.1</b> ePEA</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#interface-1"><i class="fa fa-check"></i><b>3.1.1</b> Interface</a></li>
<li class="chapter" data-level="3.1.2" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#results-1"><i class="fa fa-check"></i><b>3.1.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#epda"><i class="fa fa-check"></i><b>3.2</b> ePDA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#interface-2"><i class="fa fa-check"></i><b>3.2.1</b> Interface</a></li>
<li class="chapter" data-level="3.2.2" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#results-2"><i class="fa fa-check"></i><b>3.2.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#esea"><i class="fa fa-check"></i><b>3.3</b> eSEA</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#interface-3"><i class="fa fa-check"></i><b>3.3.1</b> Interface</a></li>
<li class="chapter" data-level="3.3.2" data-path="extended-pathway-analyses.html"><a href="extended-pathway-analyses.html#results-3"><i class="fa fa-check"></i><b>3.3.2</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="figure-1.html"><a href="figure-1.html"><i class="fa fa-check"></i><b>4</b> Figure 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="figure-1.html"><a href="figure-1.html#b-knowledgebase-construction"><i class="fa fa-check"></i><b>4.1</b> (B) Knowledgebase Construction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="figure-1.html"><a href="figure-1.html#dbkegg"><i class="fa fa-check"></i><b>4.1.1</b> dbKEGG</a></li>
<li class="chapter" data-level="4.1.2" data-path="figure-1.html"><a href="figure-1.html#dbnet"><i class="fa fa-check"></i><b>4.1.2</b> dbNet</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="figure-1.html"><a href="figure-1.html#d-deployment"><i class="fa fa-check"></i><b>4.2</b> (D) Deployment</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="figure-1.html"><a href="figure-1.html#installing-r-4.4.1-for-ubuntu-20"><i class="fa fa-check"></i><b>4.2.1</b> Installing R 4.4.1 for Ubuntu 20</a></li>
<li class="chapter" data-level="4.2.2" data-path="figure-1.html"><a href="figure-1.html#installing-r-packages"><i class="fa fa-check"></i><b>4.2.2</b> Installing R Packages</a></li>
<li class="chapter" data-level="4.2.3" data-path="figure-1.html"><a href="figure-1.html#installing-shiny-sever"><i class="fa fa-check"></i><b>4.2.3</b> Installing shiny-sever</a></li>
<li class="chapter" data-level="4.2.4" data-path="figure-1.html"><a href="figure-1.html#shiny-app-server-and-logs"><i class="fa fa-check"></i><b>4.2.4</b> Shiny App Server and Logs</a></li>
<li class="chapter" data-level="4.2.5" data-path="figure-1.html"><a href="figure-1.html#firewall-firewalld-or-ufw"><i class="fa fa-check"></i><b>4.2.5</b> Firewall: firewalld or ufw</a></li>
<li class="chapter" data-level="4.2.6" data-path="figure-1.html"><a href="figure-1.html#apache2-config"><i class="fa fa-check"></i><b>4.2.6</b> Apache2 Config</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="figure-2.html"><a href="figure-2.html"><i class="fa fa-check"></i><b>5</b> Figure 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="figure-2.html"><a href="figure-2.html#a1-epea"><i class="fa fa-check"></i><b>5.1</b> (A1) ePEA</a></li>
<li class="chapter" data-level="5.2" data-path="figure-2.html"><a href="figure-2.html#a2-epda"><i class="fa fa-check"></i><b>5.2</b> (A2) ePDA</a></li>
<li class="chapter" data-level="5.3" data-path="figure-2.html"><a href="figure-2.html#a3-esea"><i class="fa fa-check"></i><b>5.3</b> (A3) eSEA</a></li>
<li class="chapter" data-level="5.4" data-path="figure-2.html"><a href="figure-2.html#b-subnetwork"><i class="fa fa-check"></i><b>5.4</b> (B) Subnetwork</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MNet Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-2" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Figure 2<a href="figure-2.html#figure-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="figure/Figure2.png" width="637" style="display: block; margin: auto;" /></p>
<p><strong>Figure 2: Integrated analyses uniquely supported by MNet.</strong></p>
<p>A. MNet offers integrated analysis, featuring extended pathway enrichment analysis (ePEA), extended pathway differential abundance analysis (ePDA), and extended pathway set enrichment analysis (eSEA).</p>
<p>B. MNet constructs a knowledgebase and thus supports metabolism-related subnetwork analysis. It enables the extraction of the optimal subnetwork from the dbNet knowledgebase for the input genes and metabolites, thereby elucidating the underlying mechanisms that best explain the input data.</p>
<div id="a1-epea" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> (A1) ePEA<a href="figure-2.html#a1-epea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="figure-2.html#cb24-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb24-2"><a href="figure-2.html#cb24-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-3"><a href="figure-2.html#cb24-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-4"><a href="figure-2.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="figure-2.html#cb24-5" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;normal&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;a&quot;</span></span>
<span id="cb24-6"><a href="figure-2.html#cb24-6" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;tumor&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb24-7"><a href="figure-2.html#cb24-7" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;a&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb24-8"><a href="figure-2.html#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="figure-2.html#cb24-9" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb24-10"><a href="figure-2.html#cb24-10" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb24-11"><a href="figure-2.html#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="figure-2.html#cb24-12" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="figure-2.html#cb24-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="figure-2.html#cb24-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb24-15"><a href="figure-2.html#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="figure-2.html#cb24-16" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="figure-2.html#cb24-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span> <span class="fl">0.58</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="figure-2.html#cb24-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb24-19"><a href="figure-2.html#cb24-19" tabindex="-1"></a></span>
<span id="cb24-20"><a href="figure-2.html#cb24-20" tabindex="-1"></a>diff_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene,diff_meta)</span>
<span id="cb24-21"><a href="figure-2.html#cb24-21" tabindex="-1"></a></span>
<span id="cb24-22"><a href="figure-2.html#cb24-22" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_gene<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb24-23"><a href="figure-2.html#cb24-23" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_meta<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb24-24"><a href="figure-2.html#cb24-24" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_all<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">1.5</span>)</span>
<span id="cb24-25"><a href="figure-2.html#cb24-25" tabindex="-1"></a></span>
<span id="cb24-26"><a href="figure-2.html#cb24-26" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene<span class="sc">$</span>output,result_meta<span class="sc">$</span>output,result_all<span class="sc">$</span>output) <span class="sc">%&gt;%</span></span>
<span id="cb24-27"><a href="figure-2.html#cb24-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adjp <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-28"><a href="figure-2.html#cb24-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb24-29"><a href="figure-2.html#cb24-29" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb24-30"><a href="figure-2.html#cb24-30" tabindex="-1"></a></span>
<span id="cb24-31"><a href="figure-2.html#cb24-31" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="figure-2.html#cb24-32" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-33"><a href="figure-2.html#cb24-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,adjp) <span class="sc">%&gt;%</span></span>
<span id="cb24-34"><a href="figure-2.html#cb24-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb24-35"><a href="figure-2.html#cb24-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb24-36"><a href="figure-2.html#cb24-36" tabindex="-1"></a></span>
<span id="cb24-37"><a href="figure-2.html#cb24-37" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> result_meta<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb24-38"><a href="figure-2.html#cb24-38" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-39"><a href="figure-2.html#cb24-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,adjp) <span class="sc">%&gt;%</span></span>
<span id="cb24-40"><a href="figure-2.html#cb24-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb24-41"><a href="figure-2.html#cb24-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb24-42"><a href="figure-2.html#cb24-42" tabindex="-1"></a></span>
<span id="cb24-43"><a href="figure-2.html#cb24-43" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb24-44"><a href="figure-2.html#cb24-44" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-45"><a href="figure-2.html#cb24-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,adjp) <span class="sc">%&gt;%</span></span>
<span id="cb24-46"><a href="figure-2.html#cb24-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb24-47"><a href="figure-2.html#cb24-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb24-48"><a href="figure-2.html#cb24-48" tabindex="-1"></a></span>
<span id="cb24-49"><a href="figure-2.html#cb24-49" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene_filter,result_meta_filter,result_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb24-50"><a href="figure-2.html#cb24-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">adjp=</span><span class="fu">ifelse</span>(adjp <span class="sc">&lt;</span> <span class="fl">1.3e-04</span> ,<span class="fl">1.3e-04</span>,adjp)) <span class="sc">%&gt;%</span></span>
<span id="cb24-51"><a href="figure-2.html#cb24-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb24-52"><a href="figure-2.html#cb24-52" tabindex="-1"></a></span>
<span id="cb24-53"><a href="figure-2.html#cb24-53" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all,<span class="fu">aes</span>(type,name))<span class="sc">+</span></span>
<span id="cb24-54"><a href="figure-2.html#cb24-54" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>nOverlap,<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(adjp)))<span class="sc">+</span></span>
<span id="cb24-55"><a href="figure-2.html#cb24-55" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-56"><a href="figure-2.html#cb24-56" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb24-57"><a href="figure-2.html#cb24-57" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb24-58"><a href="figure-2.html#cb24-58" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-59"><a href="figure-2.html#cb24-59" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb24-60"><a href="figure-2.html#cb24-60" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/2A_01.ePEA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="figure/F2A-1.png" width="473" style="display: block; margin: auto;" /></p>
</div>
<div id="a2-epda" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> (A2) ePDA<a href="figure-2.html#a2-epda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="figure-2.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb25-2"><a href="figure-2.html#cb25-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb25-3"><a href="figure-2.html#cb25-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-4"><a href="figure-2.html#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="figure-2.html#cb25-5" tabindex="-1"></a><span class="do">## Gene</span></span>
<span id="cb25-6"><a href="figure-2.html#cb25-6" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="figure-2.html#cb25-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="figure-2.html#cb25-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb25-9"><a href="figure-2.html#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="figure-2.html#cb25-10" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="figure-2.html#cb25-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="figure-2.html#cb25-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb25-13"><a href="figure-2.html#cb25-13" tabindex="-1"></a></span>
<span id="cb25-14"><a href="figure-2.html#cb25-14" tabindex="-1"></a>DA_gene <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(diff_gene_increase<span class="sc">$</span>name,</span>
<span id="cb25-15"><a href="figure-2.html#cb25-15" tabindex="-1"></a>                        diff_gene_decrease<span class="sc">$</span>name,all_gene<span class="sc">$</span>name,</span>
<span id="cb25-16"><a href="figure-2.html#cb25-16" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">10</span>,</span>
<span id="cb25-17"><a href="figure-2.html#cb25-17" tabindex="-1"></a>                   <span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>) </span>
<span id="cb25-18"><a href="figure-2.html#cb25-18" tabindex="-1"></a><span class="fu">write.table</span>(DA_gene<span class="sc">$</span>result,<span class="st">&quot;result/2A_02.DA_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb25-19"><a href="figure-2.html#cb25-19" tabindex="-1"></a></span>
<span id="cb25-20"><a href="figure-2.html#cb25-20" tabindex="-1"></a>gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/2A_02.DA_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="figure-2.html#cb25-21" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-22"><a href="figure-2.html#cb25-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="figure-2.html#cb25-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb25-24"><a href="figure-2.html#cb25-24" tabindex="-1"></a></span>
<span id="cb25-25"><a href="figure-2.html#cb25-25" tabindex="-1"></a><span class="do">## Metabolite</span></span>
<span id="cb25-26"><a href="figure-2.html#cb25-26" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb25-27"><a href="figure-2.html#cb25-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-28"><a href="figure-2.html#cb25-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb25-29"><a href="figure-2.html#cb25-29" tabindex="-1"></a></span>
<span id="cb25-30"><a href="figure-2.html#cb25-30" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb25-31"><a href="figure-2.html#cb25-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-32"><a href="figure-2.html#cb25-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb25-33"><a href="figure-2.html#cb25-33" tabindex="-1"></a></span>
<span id="cb25-34"><a href="figure-2.html#cb25-34" tabindex="-1"></a>DAscore_meta <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(diff_meta_increase<span class="sc">$</span>name,</span>
<span id="cb25-35"><a href="figure-2.html#cb25-35" tabindex="-1"></a>                        diff_meta_decrease<span class="sc">$</span>name,all_meta<span class="sc">$</span>name,</span>
<span id="cb25-36"><a href="figure-2.html#cb25-36" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">3</span>,</span>
<span id="cb25-37"><a href="figure-2.html#cb25-37" tabindex="-1"></a>                        <span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb25-38"><a href="figure-2.html#cb25-38" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_meta<span class="sc">$</span>result,<span class="st">&quot;result/2A_02.DA_meta.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb25-39"><a href="figure-2.html#cb25-39" tabindex="-1"></a></span>
<span id="cb25-40"><a href="figure-2.html#cb25-40" tabindex="-1"></a>meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/2A_02.DA_meta.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-41"><a href="figure-2.html#cb25-41" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-42"><a href="figure-2.html#cb25-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-43"><a href="figure-2.html#cb25-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb25-44"><a href="figure-2.html#cb25-44" tabindex="-1"></a></span>
<span id="cb25-45"><a href="figure-2.html#cb25-45" tabindex="-1"></a><span class="do">## Gene + Metabolite</span></span>
<span id="cb25-46"><a href="figure-2.html#cb25-46" tabindex="-1"></a>DAscore_all <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(<span class="fu">c</span>(diff_gene_increase<span class="sc">$</span>name,diff_meta_increase<span class="sc">$</span>name),</span>
<span id="cb25-47"><a href="figure-2.html#cb25-47" tabindex="-1"></a>                       <span class="fu">c</span>(diff_gene_decrease<span class="sc">$</span>name,diff_meta_decrease<span class="sc">$</span>name),</span>
<span id="cb25-48"><a href="figure-2.html#cb25-48" tabindex="-1"></a>                       <span class="fu">c</span>(all_gene<span class="sc">$</span>name,all_meta<span class="sc">$</span>name),<span class="at">min_measured_num =</span> <span class="dv">13</span>,</span>
<span id="cb25-49"><a href="figure-2.html#cb25-49" tabindex="-1"></a>                       <span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb25-50"><a href="figure-2.html#cb25-50" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_all<span class="sc">$</span>result,<span class="st">&quot;result/2A_02.DA_all.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb25-51"><a href="figure-2.html#cb25-51" tabindex="-1"></a></span>
<span id="cb25-52"><a href="figure-2.html#cb25-52" tabindex="-1"></a>all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/2A_02.DA_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-53"><a href="figure-2.html#cb25-53" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-54"><a href="figure-2.html#cb25-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Measured_members_num <span class="sc">&gt;=</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-55"><a href="figure-2.html#cb25-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">&quot;metabolite+gene&quot;</span>)</span>
<span id="cb25-56"><a href="figure-2.html#cb25-56" tabindex="-1"></a></span>
<span id="cb25-57"><a href="figure-2.html#cb25-57" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(meta,gene,all) <span class="sc">%&gt;%</span></span>
<span id="cb25-58"><a href="figure-2.html#cb25-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>Pathway <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sulfur metabolism&quot;</span>,</span>
<span id="cb25-59"><a href="figure-2.html#cb25-59" tabindex="-1"></a>                                <span class="st">&quot;Fructose and mannose metabolism&quot;</span>,</span>
<span id="cb25-60"><a href="figure-2.html#cb25-60" tabindex="-1"></a>                                <span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,</span>
<span id="cb25-61"><a href="figure-2.html#cb25-61" tabindex="-1"></a>                                <span class="st">&quot;Galactose metabolism&quot;</span>,</span>
<span id="cb25-62"><a href="figure-2.html#cb25-62" tabindex="-1"></a>                                <span class="st">&quot;Butanoate metabolism&quot;</span>,</span>
<span id="cb25-63"><a href="figure-2.html#cb25-63" tabindex="-1"></a>                                <span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>,</span>
<span id="cb25-64"><a href="figure-2.html#cb25-64" tabindex="-1"></a>                                <span class="st">&quot;Starch and sucrose metabolism&quot;</span>,</span>
<span id="cb25-65"><a href="figure-2.html#cb25-65" tabindex="-1"></a>                                <span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb25-66"><a href="figure-2.html#cb25-66" tabindex="-1"></a>                                <span class="st">&quot;Propanoate metabolism&quot;</span>,</span>
<span id="cb25-67"><a href="figure-2.html#cb25-67" tabindex="-1"></a>                                <span class="st">&quot;Inositol phosphate metabolism&quot;</span>,</span>
<span id="cb25-68"><a href="figure-2.html#cb25-68" tabindex="-1"></a>                                <span class="st">&quot;Tryptophan metabolism&quot;</span>,</span>
<span id="cb25-69"><a href="figure-2.html#cb25-69" tabindex="-1"></a>                                <span class="st">&quot;Selenocompound metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-70"><a href="figure-2.html#cb25-70" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span> <span class="sc">%in%</span> </span>
<span id="cb25-71"><a href="figure-2.html#cb25-71" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,</span>
<span id="cb25-72"><a href="figure-2.html#cb25-72" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb25-73"><a href="figure-2.html#cb25-73" tabindex="-1"></a>                    <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,</span>
<span id="cb25-74"><a href="figure-2.html#cb25-74" tabindex="-1"></a>                    <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>,</span>
<span id="cb25-75"><a href="figure-2.html#cb25-75" tabindex="-1"></a>                    <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>,</span>
<span id="cb25-76"><a href="figure-2.html#cb25-76" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of other amino acids&quot;</span>))</span>
<span id="cb25-77"><a href="figure-2.html#cb25-77" tabindex="-1"></a></span>
<span id="cb25-78"><a href="figure-2.html#cb25-78" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb25-79"><a href="figure-2.html#cb25-79" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> </span>
<span id="cb25-80"><a href="figure-2.html#cb25-80" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;Sphingolipid metabolism&quot;</span>,<span class="st">&quot;Glycerophospholipid metabolism&quot;</span>,</span>
<span id="cb25-81"><a href="figure-2.html#cb25-81" tabindex="-1"></a>                    <span class="st">&quot;Fatty acid biosynthesis&quot;</span>,<span class="st">&quot;Glycerolipid metabolism&quot;</span>,                           <span class="st">&quot;Biosynthesis of unsaturated fatty acids&quot;</span>,</span>
<span id="cb25-82"><a href="figure-2.html#cb25-82" tabindex="-1"></a>                    <span class="st">&quot;Fatty acid elongation&quot;</span>,                            </span>
<span id="cb25-83"><a href="figure-2.html#cb25-83" tabindex="-1"></a>                    <span class="st">&quot;Steroid biosynthesis&quot;</span>,<span class="st">&quot;Purine metabolism&quot;</span>,                                    <span class="st">&quot;Pyrimidine metabolism&quot;</span>,</span>
<span id="cb25-84"><a href="figure-2.html#cb25-84" tabindex="-1"></a>                    <span class="st">&quot;Histidine metabolism&quot;</span>,<span class="st">&quot;Tyrosine metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-85"><a href="figure-2.html#cb25-85" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">DA_score=</span></span>
<span id="cb25-86"><a href="figure-2.html#cb25-86" tabindex="-1"></a>                  <span class="fu">ifelse</span>(Pathway<span class="sc">==</span><span class="st">&quot;Histidine metabolism&quot;</span> <span class="sc">&amp;</span> Type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>,<span class="sc">-</span><span class="fl">0.2</span>,</span>
<span id="cb25-87"><a href="figure-2.html#cb25-87" tabindex="-1"></a>                  <span class="fu">ifelse</span>(Pathway<span class="sc">==</span><span class="st">&quot;Sphingolipid metabolism&quot;</span> <span class="sc">&amp;</span> Type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>,<span class="sc">-</span><span class="fl">0.2</span>,DA_score))) <span class="sc">%&gt;%</span></span>
<span id="cb25-88"><a href="figure-2.html#cb25-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(DA_score) <span class="sc">%&gt;%</span></span>
<span id="cb25-89"><a href="figure-2.html#cb25-89" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>)</span>
<span id="cb25-90"><a href="figure-2.html#cb25-90" tabindex="-1"></a></span>
<span id="cb25-91"><a href="figure-2.html#cb25-91" tabindex="-1"></a>result_filter<span class="sc">$</span>Pathway <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Pathway,<span class="at">levels=</span><span class="fu">unique</span>(result_filter<span class="sc">$</span>Pathway))</span>
<span id="cb25-92"><a href="figure-2.html#cb25-92" tabindex="-1"></a></span>
<span id="cb25-93"><a href="figure-2.html#cb25-93" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb25-94"><a href="figure-2.html#cb25-94" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb25-95"><a href="figure-2.html#cb25-95" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-96"><a href="figure-2.html#cb25-96" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-97"><a href="figure-2.html#cb25-97" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb25-98"><a href="figure-2.html#cb25-98" tabindex="-1"></a></span>
<span id="cb25-99"><a href="figure-2.html#cb25-99" tabindex="-1"></a>result_filter<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;metabolite+gene&quot;</span>))</span>
<span id="cb25-100"><a href="figure-2.html#cb25-100" tabindex="-1"></a></span>
<span id="cb25-101"><a href="figure-2.html#cb25-101" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(result_filter)<span class="sc">+</span></span>
<span id="cb25-102"><a href="figure-2.html#cb25-102" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">size=</span><span class="fu">log2</span>(Measured_members_num),<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb25-103"><a href="figure-2.html#cb25-103" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span>DA_score,<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb25-104"><a href="figure-2.html#cb25-104" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),</span>
<span id="cb25-105"><a href="figure-2.html#cb25-105" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb25-106"><a href="figure-2.html#cb25-106" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb25-107"><a href="figure-2.html#cb25-107" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb25-108"><a href="figure-2.html#cb25-108" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-109"><a href="figure-2.html#cb25-109" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb25-110"><a href="figure-2.html#cb25-110" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb25-111"><a href="figure-2.html#cb25-111" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb25-112"><a href="figure-2.html#cb25-112" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb25-113"><a href="figure-2.html#cb25-113" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)</span>
<span id="cb25-114"><a href="figure-2.html#cb25-114" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/2A_02.ePDA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="figure/F2A-2.png" width="545" style="display: block; margin: auto;" /></p>
</div>
<div id="a3-esea" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> (A3) eSEA<a href="figure-2.html#a3-esea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="figure-2.html#cb26-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb26-2"><a href="figure-2.html#cb26-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-3"><a href="figure-2.html#cb26-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-4"><a href="figure-2.html#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="figure-2.html#cb26-5" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb26-6"><a href="figure-2.html#cb26-6" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb26-7"><a href="figure-2.html#cb26-7" tabindex="-1"></a>all_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_meta,all_gene)</span>
<span id="cb26-8"><a href="figure-2.html#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="figure-2.html#cb26-9" tabindex="-1"></a>all <span class="ot">&lt;-</span> all_result<span class="sc">$</span>logFC</span>
<span id="cb26-10"><a href="figure-2.html#cb26-10" tabindex="-1"></a><span class="fu">names</span>(all) <span class="ot">&lt;-</span> all_result<span class="sc">$</span>name</span>
<span id="cb26-11"><a href="figure-2.html#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="figure-2.html#cb26-12" tabindex="-1"></a>gene <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>logFC</span>
<span id="cb26-13"><a href="figure-2.html#cb26-13" tabindex="-1"></a><span class="fu">names</span>(gene) <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>name</span>
<span id="cb26-14"><a href="figure-2.html#cb26-14" tabindex="-1"></a></span>
<span id="cb26-15"><a href="figure-2.html#cb26-15" tabindex="-1"></a>meta <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>logFC</span>
<span id="cb26-16"><a href="figure-2.html#cb26-16" tabindex="-1"></a><span class="fu">names</span>(meta) <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>name</span>
<span id="cb26-17"><a href="figure-2.html#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="figure-2.html#cb26-18" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(meta,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">3</span>)</span>
<span id="cb26-19"><a href="figure-2.html#cb26-19" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(gene,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">10</span>)</span>
<span id="cb26-20"><a href="figure-2.html#cb26-20" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(all,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">13</span>)</span>
<span id="cb26-21"><a href="figure-2.html#cb26-21" tabindex="-1"></a></span>
<span id="cb26-22"><a href="figure-2.html#cb26-22" tabindex="-1"></a>pathway_msea <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_meta,result_gene,result_all) <span class="sc">%&gt;%</span></span>
<span id="cb26-23"><a href="figure-2.html#cb26-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-24"><a href="figure-2.html#cb26-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(pathway) <span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="figure-2.html#cb26-25" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb26-26"><a href="figure-2.html#cb26-26" tabindex="-1"></a></span>
<span id="cb26-27"><a href="figure-2.html#cb26-27" tabindex="-1"></a><span class="fu">length</span>(pathway_msea)</span>
<span id="cb26-28"><a href="figure-2.html#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="figure-2.html#cb26-29" tabindex="-1"></a>msea_meta_filter <span class="ot">&lt;-</span> result_meta <span class="sc">%&gt;%</span></span>
<span id="cb26-30"><a href="figure-2.html#cb26-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_msea) <span class="sc">%&gt;%</span></span>
<span id="cb26-31"><a href="figure-2.html#cb26-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,NES) <span class="sc">%&gt;%</span></span>
<span id="cb26-32"><a href="figure-2.html#cb26-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb26-33"><a href="figure-2.html#cb26-33" tabindex="-1"></a></span>
<span id="cb26-34"><a href="figure-2.html#cb26-34" tabindex="-1"></a>msea_gene_filter <span class="ot">&lt;-</span> result_gene <span class="sc">%&gt;%</span></span>
<span id="cb26-35"><a href="figure-2.html#cb26-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_msea) <span class="sc">%&gt;%</span></span>
<span id="cb26-36"><a href="figure-2.html#cb26-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,NES) <span class="sc">%&gt;%</span></span>
<span id="cb26-37"><a href="figure-2.html#cb26-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb26-38"><a href="figure-2.html#cb26-38" tabindex="-1"></a></span>
<span id="cb26-39"><a href="figure-2.html#cb26-39" tabindex="-1"></a>msea_all_filter <span class="ot">&lt;-</span> result_all <span class="sc">%&gt;%</span></span>
<span id="cb26-40"><a href="figure-2.html#cb26-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_msea) <span class="sc">%&gt;%</span></span>
<span id="cb26-41"><a href="figure-2.html#cb26-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pathway,pval,NES) <span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="figure-2.html#cb26-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite+gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-43"><a href="figure-2.html#cb26-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(NES)</span>
<span id="cb26-44"><a href="figure-2.html#cb26-44" tabindex="-1"></a></span>
<span id="cb26-45"><a href="figure-2.html#cb26-45" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(msea_meta_filter,msea_gene_filter,msea_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb26-46"><a href="figure-2.html#cb26-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pval=</span><span class="fu">ifelse</span>(pval <span class="sc">&lt;</span> <span class="fl">8.048183e-04</span>,<span class="fl">8.048183e-04</span>,pval)) <span class="sc">%&gt;%</span></span>
<span id="cb26-47"><a href="figure-2.html#cb26-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pathway=</span><span class="fu">factor</span>(pathway,<span class="at">levels=</span>msea_all_filter<span class="sc">$</span>pathway)) <span class="sc">%&gt;%</span></span>
<span id="cb26-48"><a href="figure-2.html#cb26-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;metabolite+gene&quot;</span>)))</span>
<span id="cb26-49"><a href="figure-2.html#cb26-49" tabindex="-1"></a></span>
<span id="cb26-50"><a href="figure-2.html#cb26-50" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(pathway,NES,<span class="at">fill=</span><span class="sc">-</span><span class="fu">log10</span>(pval)))<span class="sc">+</span></span>
<span id="cb26-51"><a href="figure-2.html#cb26-51" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-52"><a href="figure-2.html#cb26-52" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb26-53"><a href="figure-2.html#cb26-53" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb26-54"><a href="figure-2.html#cb26-54" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb26-55"><a href="figure-2.html#cb26-55" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb26-56"><a href="figure-2.html#cb26-56" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-57"><a href="figure-2.html#cb26-57" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb26-58"><a href="figure-2.html#cb26-58" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-59"><a href="figure-2.html#cb26-59" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb26-60"><a href="figure-2.html#cb26-60" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/2A_03.ESEA_barplot.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb26-61"><a href="figure-2.html#cb26-61" tabindex="-1"></a></span>
<span id="cb26-62"><a href="figure-2.html#cb26-62" tabindex="-1"></a>p_Oxi <span class="ot">&lt;-</span> <span class="fu">pMSEA</span>(<span class="st">&quot;Oxidative phosphorylation&quot;</span>,all,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>)</span>
<span id="cb26-63"><a href="figure-2.html#cb26-63" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/2A_03.plot_msea_oxipho_metabolite.pdf&quot;</span>,p_Oxi,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/F2A-3.png" width="548" style="display: block; margin: auto;" /></p>
</div>
<div id="b-subnetwork" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> (B) Subnetwork<a href="figure-2.html#b-subnetwork" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="figure-2.html#cb27-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb27-2"><a href="figure-2.html#cb27-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-3"><a href="figure-2.html#cb27-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-4"><a href="figure-2.html#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="figure-2.html#cb27-5" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(meta_dat,group)</span>
<span id="cb27-6"><a href="figure-2.html#cb27-6" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(gene_dat,group)</span>
<span id="cb27-7"><a href="figure-2.html#cb27-7" tabindex="-1"></a><span class="fu">names</span>(diff_meta)[<span class="dv">4</span>]  <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb27-8"><a href="figure-2.html#cb27-8" tabindex="-1"></a><span class="fu">names</span>(diff_gene)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb27-9"><a href="figure-2.html#cb27-9" tabindex="-1"></a></span>
<span id="cb27-10"><a href="figure-2.html#cb27-10" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/2B_pdent.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb27-11"><a href="figure-2.html#cb27-11" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">pdnet</span>(diff_meta,diff_gene,<span class="at">nsize=</span><span class="dv">60</span>)</span>
<span id="cb27-12"><a href="figure-2.html#cb27-12" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb27-13"><a href="figure-2.html#cb27-13" tabindex="-1"></a></span>
<span id="cb27-14"><a href="figure-2.html#cb27-14" tabindex="-1"></a>node <span class="ot">&lt;-</span> a<span class="sc">$</span>node_result</span>
<span id="cb27-15"><a href="figure-2.html#cb27-15" tabindex="-1"></a><span class="fu">write.table</span>(node,<span class="st">&quot;result/2B_pdnet_node.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb27-16"><a href="figure-2.html#cb27-16" tabindex="-1"></a></span>
<span id="cb27-17"><a href="figure-2.html#cb27-17" tabindex="-1"></a>edge <span class="ot">&lt;-</span> a<span class="sc">$</span>edge_result</span>
<span id="cb27-18"><a href="figure-2.html#cb27-18" tabindex="-1"></a><span class="fu">write.table</span>(edge,<span class="st">&quot;result/2B_pdnet_edge.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb27-19"><a href="figure-2.html#cb27-19" tabindex="-1"></a></span>
<span id="cb27-20"><a href="figure-2.html#cb27-20" tabindex="-1"></a>metabolite <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="figure-2.html#cb27-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb27-22"><a href="figure-2.html#cb27-22" tabindex="-1"></a></span>
<span id="cb27-23"><a href="figure-2.html#cb27-23" tabindex="-1"></a>gene <span class="ot">&lt;-</span> node <span class="sc">%&gt;%</span></span>
<span id="cb27-24"><a href="figure-2.html#cb27-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb27-25"><a href="figure-2.html#cb27-25" tabindex="-1"></a></span>
<span id="cb27-26"><a href="figure-2.html#cb27-26" tabindex="-1"></a>result_metabolite <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(metabolite<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb27-27"><a href="figure-2.html#cb27-27" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(gene<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb27-28"><a href="figure-2.html#cb27-28" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(<span class="fu">c</span>(gene<span class="sc">$</span>name,metabolite<span class="sc">$</span>name),<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">test=</span><span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb27-29"><a href="figure-2.html#cb27-29" tabindex="-1"></a></span>
<span id="cb27-30"><a href="figure-2.html#cb27-30" tabindex="-1"></a><span class="fu">write.table</span>(result_metabolite<span class="sc">$</span>output,<span class="st">&quot;result/2B_pdnet_metabolite_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb27-31"><a href="figure-2.html#cb27-31" tabindex="-1"></a><span class="fu">write.table</span>(result_gene<span class="sc">$</span>output,<span class="st">&quot;result/2B_pdnet_gene_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb27-32"><a href="figure-2.html#cb27-32" tabindex="-1"></a><span class="fu">write.table</span>(result_all<span class="sc">$</span>output,<span class="st">&quot;result/2B_pdnet_all_enrichment.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb27-33"><a href="figure-2.html#cb27-33" tabindex="-1"></a></span>
<span id="cb27-34"><a href="figure-2.html#cb27-34" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb27-35"><a href="figure-2.html#cb27-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb27-36"><a href="figure-2.html#cb27-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-37"><a href="figure-2.html#cb27-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-38"><a href="figure-2.html#cb27-38" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb27-39"><a href="figure-2.html#cb27-39" tabindex="-1"></a></span>
<span id="cb27-40"><a href="figure-2.html#cb27-40" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_metabolite<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>),</span>
<span id="cb27-41"><a href="figure-2.html#cb27-41" tabindex="-1"></a>                    result_gene<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>),</span>
<span id="cb27-42"><a href="figure-2.html#cb27-42" tabindex="-1"></a>                    result_all<span class="sc">$</span>output <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-43"><a href="figure-2.html#cb27-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-44"><a href="figure-2.html#cb27-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway_type <span class="sc">!=</span> <span class="st">&quot;Glycan biosynthesis and metabolism&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-45"><a href="figure-2.html#cb27-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Fructose and mannose metabolism&quot;</span>,</span>
<span id="cb27-46"><a href="figure-2.html#cb27-46" tabindex="-1"></a>                             <span class="st">&quot;Amino sugar and nucleotide sugar metabolism&quot;</span>,</span>
<span id="cb27-47"><a href="figure-2.html#cb27-47" tabindex="-1"></a>                            <span class="st">&quot;Galactose metabolism&quot;</span>,</span>
<span id="cb27-48"><a href="figure-2.html#cb27-48" tabindex="-1"></a>                            <span class="st">&quot;Ascorbate and aldarate metabolism&quot;</span>,</span>
<span id="cb27-49"><a href="figure-2.html#cb27-49" tabindex="-1"></a>                            <span class="st">&quot;Pentose and glucuronate interconversions&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-50"><a href="figure-2.html#cb27-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pvalue)</span>
<span id="cb27-51"><a href="figure-2.html#cb27-51" tabindex="-1"></a></span>
<span id="cb27-52"><a href="figure-2.html#cb27-52" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result<span class="sc">$</span>pathway_type)</span>
<span id="cb27-53"><a href="figure-2.html#cb27-53" tabindex="-1"></a></span>
<span id="cb27-54"><a href="figure-2.html#cb27-54" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb27-55"><a href="figure-2.html#cb27-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>pathway_type <span class="sc">%in%</span> </span>
<span id="cb27-56"><a href="figure-2.html#cb27-56" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;Metabolism of terpenoids and polyketides&quot;</span>,</span>
<span id="cb27-57"><a href="figure-2.html#cb27-57" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of cofactors and vitamins&quot;</span>,</span>
<span id="cb27-58"><a href="figure-2.html#cb27-58" tabindex="-1"></a>                    <span class="st">&quot;Biosynthesis of other secondary metabolites&quot;</span>,</span>
<span id="cb27-59"><a href="figure-2.html#cb27-59" tabindex="-1"></a>                    <span class="st">&quot;Metabolism of other amino acids&quot;</span>,</span>
<span id="cb27-60"><a href="figure-2.html#cb27-60" tabindex="-1"></a>                    <span class="st">&quot;Xenobiotics biodegradation and metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-61"><a href="figure-2.html#cb27-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb27-62"><a href="figure-2.html#cb27-62" tabindex="-1"></a></span>
<span id="cb27-63"><a href="figure-2.html#cb27-63" tabindex="-1"></a>result<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>name,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result<span class="sc">$</span>name)))</span>
<span id="cb27-64"><a href="figure-2.html#cb27-64" tabindex="-1"></a>result<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb27-65"><a href="figure-2.html#cb27-65" tabindex="-1"></a>result<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>))</span>
<span id="cb27-66"><a href="figure-2.html#cb27-66" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result,<span class="fu">aes</span>(name,<span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb27-67"><a href="figure-2.html#cb27-67" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb27-68"><a href="figure-2.html#cb27-68" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),</span>
<span id="cb27-69"><a href="figure-2.html#cb27-69" tabindex="-1"></a>                    <span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb27-70"><a href="figure-2.html#cb27-70" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb27-71"><a href="figure-2.html#cb27-71" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb27-72"><a href="figure-2.html#cb27-72" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb27-73"><a href="figure-2.html#cb27-73" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-74"><a href="figure-2.html#cb27-74" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb27-75"><a href="figure-2.html#cb27-75" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb27-76"><a href="figure-2.html#cb27-76" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/2B_pdnet_epe.pdf&quot;</span>,p1,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="figure/F2B.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="figure-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Figure2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
